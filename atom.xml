<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Kernel]]></title>
  <subtitle><![CDATA[Code First！Code Review！]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://molloc.me/"/>
  <updated>2015-09-26T15:02:38.966Z</updated>
  <id>http://molloc.me/</id>
  
  <author>
    <name><![CDATA[Kernel]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[ZY-2015-08-30]]></title>
    <link href="http://molloc.me/2015/09/26/ZY-2015-08-30/"/>
    <id>http://molloc.me/2015/09/26/ZY-2015-08-30/</id>
    <published>2015-09-26T02:55:52.000Z</published>
    <updated>2015-09-26T15:02:38.966Z</updated>
    <content type="html"><![CDATA[<p>Vim是一个类似于Vi的著名的功能强大、高度可定制的文本编辑器，在Vi的基础上改进和增加了很多特性。VIM是纯粹的自由软件。Vim普遍被推崇为类Vi编辑器中最好的一个，事实上真正的劲敌来自Emacs的不同变体。1999 年Emacs被选为Linuxworld文本编辑分类的优胜者，Vim屈居第二。但在2000年2月Vim赢得了Slashdot Beanie的最佳开放源代码文本编辑器大奖，又将Emacs推至二线， 总的来看， Vim和Emacs同样都是非常优秀的文本编辑器。</p>
<a id="more"></a>
<p><code>vi, vi iMproved</code> --&gt; <code>vim</code></p>
<h2 id="vim的模式"><a class="header-anchor" href="#vim的模式"></a>vim的模式</h2>
<ul>
<li>编辑模式,也叫命令模式</li>
<li>输入模式</li>
<li>末行模式</li>
</ul>
<h2 id="编辑模式到输入模式"><a class="header-anchor" href="#编辑模式到输入模式"></a>编辑模式到输入模式</h2>
<ul>
<li><code>i</code> insert</li>
<li><code>a</code> append</li>
<li><code>o</code> new line, 当前行的下方</li>
<li><code>O</code> new line, 当前行的上方</li>
<li><code>I</code> 行首</li>
<li><code>A</code> 行尾</li>
</ul>
<h2 id="输入模式到编辑模式"><a class="header-anchor" href="#输入模式到编辑模式"></a>输入模式到编辑模式</h2>
<ul>
<li><code>ESC</code></li>
</ul>
<h2 id="编辑模式到末行模式"><a class="header-anchor" href="#编辑模式到末行模式"></a>编辑模式到末行模式</h2>
<ul>
<li><code>:</code></li>
</ul>
<h2 id="末行模式到编辑模式"><a class="header-anchor" href="#末行模式到编辑模式"></a>末行模式到编辑模式</h2>
<ul>
<li><code>ESC</code></li>
</ul>
<p>无法直接从输入模式回到末行模式,必须先按<code>ESC</code>退回到编辑模式,然后在进入末行模式.</p>
<h2 id="打开vim"><a class="header-anchor" href="#打开vim"></a>打开<code>vim</code></h2>
<ul>
<li><code>vim</code></li>
<li><code>vim /PATH/TO/SOMEFILE</code></li>
<li><code>+#</code> <code>#</code>为行号,打开文件的时候,光标直接位于<code>#</code>行</li>
<li><code>+/PATTERN</code> 打开文件的时候,光标位于<code>PATTERN</code>第一次匹配的位置.</li>
</ul>
<h2 id="关闭vim"><a class="header-anchor" href="#关闭vim"></a>关闭vim</h2>
<ul>
<li><code>:q</code>  退出</li>
<li><code>:wq</code> 存盘并退出</li>
<li><code>:q!</code> 不保存退出</li>
<li><code>:x</code>  保存退出</li>
<li><code>:w /PATH/TO/SOMEFILE</code> 另存为SOMEFILE文件</li>
<li>在编辑模式下<code>ZZ</code> 保存退出</li>
</ul>
<h2 id="vim中的跳转"><a class="header-anchor" href="#vim中的跳转"></a>vim中的跳转</h2>
<p>(1) 逐字符跳转<code>h(左),l(右),j(下),k(上)</code>一个字符. <code>#{h|l|j|k}</code>可以跳转#个字符,<code>10h</code>表示向左移动10字符.其他类似.</p>
<p>(2) 单词间跳转<code>w,e,b</code></p>
<p>连字符代表<code>-</code>,不包括上划线和下划线.</p>
<p><code>w</code> 表示跳至下一个单词的词首,此处的单词是由连续的字母加数字,下划线(不包括特殊字符和连字符,特殊字符和连字符算一个单词)组成.</p>
<p><code>e</code> 跳至当前或下一个单词的词尾,此处的单词是由连续的字符,数字,下划线组成(不包括特殊字符,特殊字符算一个单词).</p>
<p><code>b</code> 跳至当前或上一个单词的词首,此处的单词是由连续的字符,数字,下划线组成(不包括特殊字符,特殊字符算一个单词).</p>
<p><code>#{w|e|b}</code> 跳转<code>#</code>个单词位置.</p>
<p>(3) 行内跳转</p>
<p><code>^</code> 跳转至行首的第一个非空白字符</p>
<p><code>0</code> 跳转至行首(绝对行首)</p>
<p><code>$</code> 跳转至行尾(绝对行尾)</p>
<p>(4) 行间移动</p>
<p><code>#G</code> 跳转至<code>#</code>行, <code>1G</code>跳转至第一行,<code>G</code>跳转至最后一行.</p>
<p><code>gg</code> 跳转至第一行</p>
<p>(5) 句间移动(针对写论文之类的比较有意义)</p>
<p><code>)</code> 跳转至下一句</p>
<p><code>(</code> 跳转至上一句</p>
<p>(6) 段落间移动</p>
<p><code>}</code> 跳转至下一段落</p>
<p><code>{</code> 跳转至上一段落</p>
<h2 id="vim的编辑命令"><a class="header-anchor" href="#vim的编辑命令"></a>vim的编辑命令</h2>
<p>(1) 字符编辑操作</p>
<p><code>x</code>  删除光标所在处的字符.</p>
<p><code>#x</code> 删除光标所在处以及向后的指定个数的字符.</p>
<p><code>xp</code> <code>p</code>表示粘贴之意,把光标所在的字符与后一个字符对调.<code>to</code> --&gt; <code>ot</code></p>
<p><code>r</code> 替换光标所在处的字符.</p>
<p>(2) 删除命令</p>
<p><code>d</code>  根光标跳转结合起来使用.</p>
<p><code>d$</code> 删除光标所在处到行尾的所有字符.</p>
<p><code>d^</code> 删除光标所在处到行首的所有字符.</p>
<p><code>d0</code> 删除光标所在处到行首(绝对行首)的所有字符.</p>
<p><code>[#]dw</code> 删除光标所在处到词尾或下一个单词词尾的的字符(注意单词的界定)</p>
<p><code>[#]db</code> 删除光标所在处到词首或前一个单词的词首的字符(注意单词的界定)</p>
<p><code>[#]dd</code> 删除光标所在处的一整行的内容,<code>3dd</code>代表删除3行.</p>
<p>Note: 删除的内容会被vim编辑器保存至缓冲区当中.最近一次的删除操作还可以粘贴到某位置.</p>
<p>(3) 粘贴命令</p>
<p><code>p</code> <code>p</code>(<em>paste,put</em>), 取决于我们之前删除的是什么</p>
<p>3.1 如果此复制或删除的内容不是一个完整行.小写<code>p</code>跟大写<code>P</code>是有区别的.</p>
<p><code>p</code> 小写<code>p</code>表示把内容粘贴至当前光标所在处的后面.</p>
<p><code>P</code> 大写<code>P</code>表示把内容粘贴至当前光标所在处的前面.</p>
<p>3.2 如果此复制或删除的内容是一个完整行(可不止一行)</p>
<p><code>p</code> 小写<code>p</code>表示把内容粘贴至当前光标所在行的下方.</p>
<p><code>P</code> 大写<code>P</code>表示把内容粘贴至当前光标所在行的上方.</p>
<p>(4) 复制命令</p>
<p><code>y</code> <em>yank</em>跟<code>d</code>用法一样<code>y$, y0, y^, 3y, yw, yb, ye, yy</code></p>
<p><code>[#]yy</code> 复制整行, <code>3yy</code>复制3行.</p>
<p>(5) 改变命令</p>
<p><code>c</code> <em>change</em>, 删除一部分内容后并立即从编辑模式切换到输入模式.</p>
<p><code>c$, c^, c0, cw, cb, ce, cc</code></p>
<p><code>[#]cc</code> 删除整行, <code>3cc</code>删除3行并立即从编辑模式切换到输入模式.</p>
<p>(6) 撤销之前的操作</p>
<p><code>u</code> <em>undo</em> 撤销此前的编辑操作</p>
<p><code>#u</code> 撤销此前的<code>#</code>次操作</p>
<p>(7) 恢复此前的撤销操作</p>
<p><code>ctrl+r</code></p>
<p><code>.</code> 重复前一个编辑操作</p>
<p>(8) 翻屏操作</p>
<p><code>ctrl+f</code> 向后翻一屏</p>
<p><code>ctrl+b</code> 向前翻一屏</p>
<p><code>ctrl+d</code> 向后半屏</p>
<p><code>ctrl+d</code> 向前半屏</p>
<p>vim内建教程,<code>vimtutor</code></p>
<h2 id="vim的末行模式"><a class="header-anchor" href="#vim的末行模式"></a>vim的末行模式(<code>:</code>)</h2>
<p>(1) 地址,定界</p>
<p><code>:start_pos, end_pos</code></p>
<p><code>:#</code> 就是第<code>#</code>行</p>
<p><code>.</code> 表示当前行</p>
<p><code>$</code> 表示最后一行</p>
<p><code>%</code> 表示全文,相当于<code>1,$</code></p>
<p><code>/pattern/</code>表示第一次被正则匹配到的行.</p>
<p><code>:#, #</code></p>
<p><code>1,10</code> 表示第一行到第十行(绝对地址定界+绝对地址定界的方式).</p>
<p><code>1,+3</code>表示第一行到第一行再向下三行,一共四行(绝对地址定界+相对地址定界的方式).</p>
<p><code>. $-1</code> 当前行到导出第二行.</p>
<p><code>/patern1/,/pattern2/</code> 从第一次匹配到<em>pattern1</em>的行到第一次匹配到<em>pattern2</em>的行结束.</p>
<p><code>#,/pattern2/</code> 从<code>#</code>行到第一次匹配到<em>pattern1</em>的行结束.</p>
<p><em>NOTE:</em> 上面的命令后面都可以跟一个编辑命令.<code>d, y, w</code></p>
<p><code>:1,100w /tmp/a.txt</code> 把文件的第1到100行保存到<code>/tmp/a.txt</code>文件中.</p>
<p><code>:[#]r /etc/fstab</code> 在<code>#</code>行后面读入<code>/etc/tstab</code>文件中的内容.直接插入到当前文件中.</p>
<p>(2) 查找功能</p>
<p><code>/PATTERN</code> 从当前光标位置向尾部查找</p>
<p><code>?PATTERN</code> 从当前光标位置向首部查找</p>
<p><em>NOTE:</em> 快速找到下一个 <code>n</code>表示与命令同方向, <code>N</code>表示与命令反方向</p>
<p>(3) 查找替换功能</p>
<p><code>s</code> <em>substitute</em> 在末行模式下,在地址定界的范围内完成查找替换操作.</p>
<p><code>s/要查早的内容/替换为的内容/修饰符</code></p>
<p>要查找的内容: 可使用模式</p>
<p>替换为的内容: 不能使用模式,但可以使用后向引用符号,以引用前面模式中的分组括号所匹配到的内容.<code>\1, \2, &amp;</code>.<code>&amp;</code>引用&quot;要查找内容&quot;.</p>
<p>修饰符: <code>i</code> 忽略大小写, <code>g</code> 全局替换(不加<code>g</code>的效果如果一行当中有多个匹配, 只把每一行的第一次匹配替换).</p>
<p><code>/</code> 用于分隔符, 所以,要查找的内容或替换为的内容中出现此符合,需要使用<code>\</code>对其转义.<code>\/</code></p>
<p><em>NOTE:</em> 分隔符可替换为其他字符, <code>@, #</code>, <em>eg</em> <code>%s@/dev/mapper@/etc/fstab@g</code></p>
<h2 id="vim多文件模式"><a class="header-anchor" href="#vim多文件模式"></a>vim多文件模式</h2>
<p>(1) <code>vim file...</code>默认打开第一个文件</p>
<ul>
<li><code>:next</code>  进入下一个文件</li>
<li><code>:prev</code>  进入上一个文件</li>
<li><code>:first</code> 进入第一个文件</li>
<li><code>:last</code>  进入最后一个文件</li>
<li><code>:wqall</code> 保存并退出所有文件</li>
<li><code>:q!all</code> 所有都不保存退出</li>
</ul>
<p>(2) <code>vim -o file...</code> 几个文件就打开几个窗口.横排</p>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-30/vim-multi-window.png" alt="vim-multi-window"></p>
<p>(3) <code>vim -O file...</code> 几个文件就打开几个窗口.竖排</p>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-30/vim-multi-window-v.png" alt="vim-multi-window-v"></p>
<p>(4) <code>ctrl + w, ARROW</code> 先按<code>ctrl+w</code>松开在按<code>s</code>切换窗口.</p>
<h2 id="vim多文件窗口分隔"><a class="header-anchor" href="#vim多文件窗口分隔"></a>vim多文件窗口分隔</h2>
<p><code>vim [-o|O] files...</code>, <code>Ctrl+w, ARROW</code> 切换窗口</p>
<p>单文件窗口分隔</p>
<p><code>Ctrl+w, s</code> <em>split</em> 水平分隔</p>
<p><code>Ctrl+w, v</code> <em>vertical</em> 垂直分隔</p>
<h2 id="定制vim的工作特性"><a class="header-anchor" href="#定制vim的工作特性"></a>定制vim的工作特性</h2>
<ul>
<li><code>set nu|nonu</code> 行号</li>
<li><code>set sm|nosm</code> 括号匹配</li>
<li><code>set ai|noai</code> 自动缩进</li>
<li><code>set hlsearch|nohlsearch</code> 高亮搜索</li>
<li><code>syntax on|off</code> 语法着色</li>
<li><code>set ic|noic</code>  忽略大小写</li>
<li><code>help SUBJECT</code> 获取帮助信息</li>
</ul>
<h2 id="vim的配置文件"><a class="header-anchor" href="#vim的配置文件"></a>vim的配置文件</h2>
<ul>
<li><code>/etc/vimrc</code> 全局配置文件：</li>
<li><code>~/.vimrc</code>   用户个人的配置文件：</li>
</ul>
<h2 id="实践"><a class="header-anchor" href="#实践"></a>实践</h2>
<h3 id="1-复制-etc-grub2-cfg配置文件至-tmp目录-用查找替换命令删除-tmp-grub2-cfg文件中的行首的空白字符"><a class="header-anchor" href="#1-复制-etc-grub2-cfg配置文件至-tmp目录-用查找替换命令删除-tmp-grub2-cfg文件中的行首的空白字符"></a>1. 复制/etc/grub2.cfg配置文件至/tmp目录，用查找替换命令删除/tmp/grub2.cfg文件中的行首的空白字符</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$  cp /etc/grub2.cfg /tmp</span><br><span class="line">$  vim grub2.cfg</span><br><span class="line">$  :%s/^[[:space:]]\+//</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#DO NOT EDIT THIS FILE</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#It is automatically generated by grub2-mkconfig using templates</span></span><br><span class="line"><span class="comment">#from /etc/grub.d and settings from /etc/default/grub</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###BEGIN /etc/grub.d/00_header ###</span></span><br><span class="line">setpager=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>[ <span class="operator">-s</span> <span class="variable">$prefix</span>/grubenv ]; <span class="keyword">then</span></span><br><span class="line">load_env</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span>[ <span class="string">"<span class="variable">$&#123;next_entry&#125;</span>"</span> ] ; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">set</span> default=<span class="string">"<span class="variable">$&#123;next_entry&#125;</span>"</span></span><br><span class="line"><span class="built_in">set</span> next_entry=</span><br><span class="line">save_env next_entry</span><br><span class="line"><span class="built_in">set</span> boot_once=<span class="literal">true</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">set</span> default=<span class="string">"<span class="variable">$&#123;saved_entry&#125;</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>[ x<span class="string">"<span class="variable">$&#123;feature_menuentry_id&#125;</span>"</span> = xy ]; <span class="keyword">then</span></span><br><span class="line">menuentry_id_option=<span class="string">"--id"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">menuentry_id_option=<span class="string">""</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="2-复制-etc-rc-d-init-d-functions文件至-tmp目录-用查找替换命令为-tmp-functions的每行开头为空白字符的行的行首加一个-原有空白字符保留"><a class="header-anchor" href="#2-复制-etc-rc-d-init-d-functions文件至-tmp目录-用查找替换命令为-tmp-functions的每行开头为空白字符的行的行首加一个-原有空白字符保留"></a>2. 复制<code>/etc/rc.d/init.d/functions</code>文件至<code>/tmp</code>目录，用查找替换命令为<code>/tmp/functions</code>的每行开头为空白字符的行的行首加一个#; 原有空白字符保留</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ cp /etc/rc.d/init.d/<span class="built_in">functions</span> /tmp</span><br><span class="line">$ vim <span class="built_in">functions</span></span><br><span class="line">$ :%s/^[[:space:]]\+/<span class="comment">#&amp;/</span></span><br><span class="line"><span class="comment"># -*-Shell-script-*-</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># functions This file contains functions to be used by most or all</span></span><br><span class="line"><span class="comment">#       shell scripts in the /etc/init.d directory.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">TEXTDOMAIN=initscripts</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make sure umask is sane</span></span><br><span class="line"><span class="built_in">umask</span> <span class="number">022</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up a default search path.</span></span><br><span class="line">PATH=<span class="string">"/sbin:/usr/sbin:/bin:/usr/bin"</span></span><br><span class="line"><span class="built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">systemctl_redirect</span></span> () &#123;</span><br><span class="line"><span class="comment">#   local s</span></span><br><span class="line"><span class="comment">#   local prog=$&#123;1##*/&#125;</span></span><br><span class="line"><span class="comment">#        local command=$2</span></span><br><span class="line"><span class="comment">#        local options=""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   case "$command" in</span></span><br><span class="line"><span class="comment">#   start)</span></span><br><span class="line"><span class="comment">#       s=$"Starting $pro</span></span><br></pre></td></tr></table></figure>
<h3 id="3-替换-tmp-functions文件中的-etc-sysconfig-init为-var-log"><a class="header-anchor" href="#3-替换-tmp-functions文件中的-etc-sysconfig-init为-var-log"></a>3. 替换/tmp/functions文件中的/etc/sysconfig/init为/var/log</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$ vim <span class="built_in">functions</span></span><br><span class="line">$ /\/etc\/sysconfig\/init</span><br><span class="line"><span class="comment"># Read in our configuration</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;BOOTUP:-&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">if</span> [ <span class="operator">-f</span> /etc/sysconfig/init ]; <span class="keyword">then</span></span><br><span class="line">      . /etc/sysconfig/init</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="comment"># This all seem confusing? Look in /etc/sysconfig/init,</span></span><br><span class="line">    <span class="comment"># or in /usr/share/doc/initscripts-*/sysconfig.txt</span></span><br><span class="line">    BOOTUP=color</span><br><span class="line">    RES_COL=<span class="number">60</span></span><br><span class="line">    MOVE_TO_COL=<span class="string">"echo -en \\033[<span class="variable">$&#123;RES_COL&#125;</span>G"</span></span><br><span class="line">    SETCOLOR_SUCCESS=<span class="string">"echo -en \\033[1;32m"</span></span><br><span class="line">    SETCOLOR_FAILURE=<span class="string">"echo -en \\033[1;31m"</span></span><br><span class="line">    SETCOLOR_WARNING=<span class="string">"echo -en \\033[1;33m"</span></span><br><span class="line">    SETCOLOR_NORMAL=<span class="string">"echo -en \\033[0;39m"</span></span><br><span class="line">    LOGLEVEL=<span class="number">1</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">$ :%s@/etc/sysconfig/init@/var/<span class="built_in">log</span>@g</span><br><span class="line"><span class="comment"># Read in our configuration</span></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$&#123;BOOTUP:-&#125;</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  <span class="keyword">if</span> [ <span class="operator">-f</span> /var/<span class="built_in">log</span> ]; <span class="keyword">then</span></span><br><span class="line">      . /var/<span class="built_in">log</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="comment"># This all seem confusing? Look in /var/log,</span></span><br><span class="line">    <span class="comment"># or in /usr/share/doc/initscripts-*/sysconfig.txt</span></span><br><span class="line">    BOOTUP=color</span><br><span class="line">    RES_COL=<span class="number">60</span></span><br><span class="line">    MOVE_TO_COL=<span class="string">"echo -en \\033[<span class="variable">$&#123;RES_COL&#125;</span>G"</span></span><br><span class="line">    SETCOLOR_SUCCESS=<span class="string">"echo -en \\033[1;32m"</span></span><br><span class="line">    SETCOLOR_FAILURE=<span class="string">"echo -en \\033[1;31m"</span></span><br><span class="line">    SETCOLOR_WARNING=<span class="string">"echo -en \\033[1;33m"</span></span><br><span class="line">    SETCOLOR_NORMAL=<span class="string">"echo -en \\033[0;39m"</span></span><br><span class="line">    LOGLEVEL=<span class="number">1</span></span><br><span class="line">  <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="4-删除-tmp-functions文件中所以-开头-且-后面至少跟了一个空白字符的行的行首-例2的反向操作"><a class="header-anchor" href="#4-删除-tmp-functions文件中所以-开头-且-后面至少跟了一个空白字符的行的行首-例2的反向操作"></a>4. 删除/tmp/functions文件中所以#开头，且#后面至少跟了一个空白字符的行的行首#. 例2的反向操作.</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ vim <span class="built_in">functions</span></span><br><span class="line">$ :%s/^<span class="comment">#\([[:space:]]\+\)/\1/</span></span><br><span class="line">$ cp /etc/rc.d/init.d/<span class="built_in">functions</span> /tmp</span><br><span class="line">$ vim <span class="built_in">functions</span></span><br><span class="line">$ :%s/^[[:space:]]\+/<span class="comment">#&amp;/</span></span><br><span class="line"> -*-Shell-script-*-</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"> <span class="built_in">functions</span> This file contains <span class="built_in">functions</span> to be used by most or all</span><br><span class="line">       shell scripts <span class="keyword">in</span> the /etc/init.d directory.</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">TEXTDOMAIN=initscripts</span><br><span class="line"></span><br><span class="line"> Make sure <span class="built_in">umask</span> is sane</span><br><span class="line"><span class="built_in">umask</span> <span class="number">022</span></span><br><span class="line"></span><br><span class="line"> Set up a default search path.</span><br><span class="line">PATH=<span class="string">"/sbin:/usr/sbin:/bin:/usr/bin"</span></span><br><span class="line"><span class="built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">systemctl_redirect</span></span> () &#123;</span><br><span class="line">   <span class="built_in">local</span> s</span><br><span class="line">   <span class="built_in">local</span> prog=<span class="variable">$&#123;1##*/&#125;</span></span><br><span class="line">        <span class="built_in">local</span> <span class="built_in">command</span>=<span class="variable">$2</span></span><br><span class="line">        <span class="built_in">local</span> options=<span class="string">""</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">case</span> <span class="string">"<span class="variable">$command</span>"</span> <span class="keyword">in</span></span><br><span class="line">   start)</span><br><span class="line">       s=$<span class="string">"Starting <span class="variable">$pro</span></span></span><br></pre></td></tr></table></figure>
<h2 id="文件查找"><a class="header-anchor" href="#文件查找"></a>文件查找</h2>
<p>在文件系统上查找符合条件的文件的过程</p>
<h2 id="文件查找命令locate-find"><a class="header-anchor" href="#文件查找命令locate-find"></a>文件查找命令<code>locate, find</code></h2>
<ul>
<li><code>locate</code> 非实时查找工具；依赖于事先构建的索引；索引的构建是在系统较为空闲时自动进行(周期性任务)；手动更新此数据库(<code>updatedb</code>)；查找速度快；模糊查找；</li>
<li><code>find</code> 实时查找；查找速度略慢；精确查找；</li>
</ul>
<h2 id="文件类型"><a class="header-anchor" href="#文件类型"></a>文件类型</h2>
<ul>
<li><code>f</code> 普通文件</li>
<li><code>d</code> 目录</li>
<li><code>l</code> 符号链接</li>
<li><code>b</code> 块设备</li>
<li><code>c</code> 字符设备</li>
<li><code>p</code> 命名管道</li>
<li><code>s</code> 套接字</li>
</ul>
<h2 id="find"><a class="header-anchor" href="#find"></a>find</h2>
<h3 id="语法"><a class="header-anchor" href="#语法"></a>语法</h3>
<p><code>find [OPTION] [path...] [condition] [action]</code></p>
<p><code>path</code> 不指定默认为当前路径.</p>
<p><code>condition</code> 指定查找的标准,可以根据文件名,大小,属组,属主,类型等进行,默认为指定路径下的所有文件.</p>
<p><code>action</code> 对符合条件的文件做什么操作,默认为输出至屏幕.</p>
<h3 id="查找条件"><a class="header-anchor" href="#查找条件"></a>查找条件</h3>
<ul>
<li><code>-name &quot;filename&quot;</code>    <code>filename</code>支持<code>glob</code>.</li>
<li><code>-iname &quot;filename&quot;</code>   <code>filename</code>,不区分字符大小写,支持<code>glob</code>.</li>
<li><code>-regex &quot;PATTERN&quot;</code>    以<code>PATTERN</code>匹配整个文件路径字符串,而不仅仅是文件名称.</li>
<li><code>-user USERNAME</code>      查找指定用户的文件.</li>
<li><code>-group GROUPNAME</code>    查找指定属组的文件.</li>
<li><code>-uid UID</code>            查找文件的属主指定<code>uid</code>的文件.</li>
<li><code>-uid GroupID</code>        查找文件的属主指定<code>gid</code>的文件.</li>
<li><code>-nouser</code>             查找没有属主的文件.</li>
<li><code>-nogroup</code>            查找没有属组的文件.</li>
<li><code>-type TYPE</code>          查找指定文件类型的文件</li>
<li><code>-size [+|-]#UNIT</code>    根据文件大小来查找</li>
</ul>
<h3 id="根据文件权限查找"><a class="header-anchor" href="#根据文件权限查找"></a>根据文件权限查找</h3>
<ul>
<li><code>-perm [/|-]MODE</code></li>
</ul>
<h3 id="根据时间戳查找"><a class="header-anchor" href="#根据时间戳查找"></a>根据时间戳查找</h3>
<p>(1) 以天为单位</p>
<ul>
<li><code>-atime [+|-]#</code></li>
<li><code>-mtime [+|-]#</code></li>
<li><code>-ctime [+|-]#</code></li>
</ul>
<p>(2) 以分钟为单位</p>
<ul>
<li><code>-amin [+|-]#</code></li>
<li><code>-mmin [+|-]#</code></li>
<li><code>-cmin [+|-]#</code></li>
</ul>
<h3 id="组合查找条件"><a class="header-anchor" href="#组合查找条件"></a>组合查找条件</h3>
<ul>
<li><code>-a</code>      与条件</li>
<li><code>-o</code>      或条件</li>
<li><code>-not,!</code>  取反</li>
<li><code>!A -o !B = !(A -a B)</code></li>
<li><code>!A -a !B = !(A -o B)</code></li>
</ul>
<h3 id="处理动作"><a class="header-anchor" href="#处理动作"></a>处理动作</h3>
<ul>
<li><code>-print</code>  默认处理动作.</li>
<li><code>-ls</code>     类似与对查找到的每个文件做<code>ls -l</code>的操作.</li>
<li><code>-delete</code> 删除查找到的文件.</li>
<li><code>-fls /PATH/TO/SOMEFILE</code> 查找到的文件的详细路径信息保存至指定文件中.</li>
<li><code>-ok COMMAND {} \;</code>    <code>-ok</code>在执行<code>COMMAND</code>是需要确认,<code>\;</code>为固定格式.</li>
<li><code>-exec COMMAND {} \;</code>  <code>-exec</code>在执行<code>COMMAND</code>无需确认,<code>\;</code>为固定格式.</li>
</ul>
<h3 id="理解"><a class="header-anchor" href="#理解"></a>理解</h3>
<p>(1) 不加组合条件标识符,默认是与条件.</p>
<p><code>find /tmp -nouser -user marion</code> &lt;-&gt; <code>find /tmp -nouser -a -user marion</code></p>
<p>(2) 注意<code>-ls</code>针对的是<code>-user marion</code>,下面的命令<code>-ls</code>不会打印符合<code>-nouser</code>的信息.</p>
<p><code>find /tmp -nouser -o -user marion -ls</code> &lt;-&gt; <code>find /tmp -nouser -o -user marion -a -ls</code></p>
<p><code>find /tmp \( -nouser -o -user marion \) -ls</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ ls</span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">1</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">2</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">3</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">4</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">5</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">6</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">7</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">8</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span> marion marion <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> <span class="number">9</span></span><br><span class="line">-rw-r--r-- <span class="number">1</span>   <span class="number">1001</span>   <span class="number">1001</span> <span class="number">0</span> Sep <span class="number">26</span> <span class="number">19</span>:<span class="number">46</span> a.txt</span><br><span class="line"></span><br><span class="line">$ find /tmp -nouser -o -user marion -ls</span><br><span class="line"><span class="number">67151761</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">1</span></span><br><span class="line"><span class="number">69018299</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">2</span></span><br><span class="line"><span class="number">69018300</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">3</span></span><br><span class="line"><span class="number">69018301</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">4</span></span><br><span class="line"><span class="number">69018302</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">5</span></span><br><span class="line"><span class="number">69018303</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">6</span></span><br><span class="line"><span class="number">69018305</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">7</span></span><br><span class="line"><span class="number">69018306</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">8</span></span><br><span class="line"><span class="number">69018310</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">9</span></span><br><span class="line"></span><br><span class="line">$ find /tmp \( -nouser -o -user marion \) -ls <span class="comment"># 注意比较上面命令的输出</span></span><br><span class="line"><span class="number">67151717</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> <span class="number">1001</span>     <span class="number">1001</span>            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">19</span>:<span class="number">46</span> /tmp/<span class="built_in">test</span>/a.txt</span><br><span class="line"><span class="number">67151761</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">1</span></span><br><span class="line"><span class="number">69018299</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">2</span></span><br><span class="line"><span class="number">69018300</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">3</span></span><br><span class="line"><span class="number">69018301</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">4</span></span><br><span class="line"><span class="number">69018302</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">5</span></span><br><span class="line"><span class="number">69018303</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">6</span></span><br><span class="line"><span class="number">69018305</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">7</span></span><br><span class="line"><span class="number">69018306</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">8</span></span><br><span class="line"><span class="number">69018310</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> marion   marion          <span class="number">0</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">08</span> /tmp/<span class="built_in">test</span>/<span class="number">9</span></span><br></pre></td></tr></table></figure>
<p>(3) 查找<code>/etc</code>下不以<code>.conf</code>结尾的文件.</p>
<p><code>find /etc ! -name &quot;*.conf&quot; -ls</code></p>
<p>(4) <code>#UNIT, +#UNIT, -#UNIT</code> 针对<code>-size</code></p>
<ul>
<li><code>#UNIT</code>  --&gt;  <code>(#-1, #]</code></li>
<li><code>+#UNIT</code> --&gt;  <code>(#, oo)</code></li>
<li><code>-#UNIT</code> --&gt;  <code>[0, #-1]</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc -size <span class="number">3</span>k -exec ls -lh &#123;&#125; \;</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.5</span>K Mar <span class="number">10</span>  <span class="number">2015</span> /etc/yum/yum-cron-hourly.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.5</span>K Mar <span class="number">10</span>  <span class="number">2015</span> /etc/yum/yum-cron.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.2</span>K May <span class="number">13</span> <span class="number">03</span>:<span class="number">41</span> /etc/ssh/ssh_config</span><br><span class="line">-rwxr-xr-x. <span class="number">1</span> root root <span class="number">2.2</span>K Jun <span class="number">24</span> <span class="number">07</span>:<span class="number">44</span> /etc/dhcp/dhclient.d/ntp.sh</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.6</span>K Sep <span class="number">19</span>  <span class="number">2014</span> /etc/rsyslog.d/gluster.conf.example</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.8</span>K Oct <span class="number">29</span>  <span class="number">2014</span> /etc/bashrc</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.5</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/dbus-<span class="number">1</span>/system.d/oddjob.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.8</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/dbus-<span class="number">1</span>/session.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.0</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/dbus-<span class="number">1</span>/system.conf</span><br><span class="line">-rw-------. <span class="number">1</span> root root <span class="number">2.1</span>K Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">45</span> /etc/lvm/archive/cent</span><br><span class="line"></span><br><span class="line">$ find /etc/ -size -<span class="number">3</span>k -exec ls -ldh &#123;&#125; \;</span><br><span class="line">-rw-r-----. <span class="number">1</span> root root <span class="number">1.8</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/sudo.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">2.0</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/purple/prefs.xml</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">1.5</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/numbers-dot6.tti</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">1.5</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/numbers-dot8.tti</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">1.5</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/numbers-french.tti</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">1.5</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/numbers-nemeth.tti</span><br><span class="line"></span><br><span class="line">$ find /etc/ -size +<span class="number">3</span>k -exec ls -ldh &#123;&#125; \;</span><br><span class="line">drwxr-xr-x. <span class="number">3</span> root root <span class="number">4.0</span>K Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">40</span> /etc/sane.d</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">4.1</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/artec_eplus48u.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.1</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/canon_dr.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.1</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/umax.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.4</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/xerox_mfp.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">7.7</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/gt68xx.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">3.8</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/mustek_pp.conf</span><br></pre></td></tr></table></figure>
<p>(4) <code>#, +#, -#</code> 针对时间选项</p>
<ul>
<li><code>#</code>  --&gt;  <code>[#, #+1)</code></li>
<li><code>+#</code> --&gt;  <code>[#+1, oo)</code></li>
<li><code>-#</code> --&gt;  <code>[0, #)</code></li>
</ul>
<p>(5) <code>MODE, /MODE, -MODE</code> 针对权限<code>-perm</code>选项</p>
<ul>
<li><code>MODE</code>  精确权限, 必须跟我们指定的权限完全一样.</li>
<li><code>/MODE</code> 任何一类对象(u,g,o)的任何一位权限符合条件即可,隐含或条件.</li>
<li><code>-MODE</code> 为每一类对象指定的每一位权限都必须存在方为符合条件,隐含与条件.</li>
</ul>
<p><em>NOTE</em>  <code>MODE</code> 中为0的为不参与匹配,也就是说,不关心此位.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ ll</span><br><span class="line">-r--r--r-- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> a</span><br><span class="line">-rw-r----- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> b</span><br><span class="line">-rw-rw---- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> c</span><br><span class="line">-rwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> d</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> e</span><br><span class="line"></span><br><span class="line">$ find -perm /<span class="number">222</span> -ls <span class="comment"># 任何一位有写权限就可以</span></span><br><span class="line"><span class="number">69018296</span>    <span class="number">0</span> drwxr-xr-x   <span class="number">2</span> root     root           <span class="number">46</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> .</span><br><span class="line"><span class="number">69018309</span>    <span class="number">0</span> -rw-r-----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./b</span><br><span class="line"><span class="number">69018311</span>    <span class="number">0</span> -rw-rw----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./c</span><br><span class="line"><span class="number">69018315</span>    <span class="number">0</span> -rwxrwxrwx   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./d</span><br><span class="line"><span class="number">69018316</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./e</span><br><span class="line"></span><br><span class="line">$ find -perm /<span class="number">200</span> -ls <span class="comment"># 必须属主能写</span></span><br><span class="line"><span class="number">69018296</span>    <span class="number">0</span> drwxr-xr-x   <span class="number">2</span> root     root           <span class="number">46</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> .</span><br><span class="line"><span class="number">69018309</span>    <span class="number">0</span> -rw-r-----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./b</span><br><span class="line"><span class="number">69018311</span>    <span class="number">0</span> -rw-rw----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./c</span><br><span class="line"><span class="number">69018315</span>    <span class="number">0</span> -rwxrwxrwx   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./d</span><br><span class="line"><span class="number">69018316</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./e</span><br><span class="line"></span><br><span class="line">$ find -perm /<span class="number">020</span> -ls <span class="comment"># 必须属组能写</span></span><br><span class="line"><span class="number">69018311</span>    <span class="number">0</span> -rw-rw----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./c</span><br><span class="line"><span class="number">69018315</span>    <span class="number">0</span> -rwxrwxrwx   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./d</span><br></pre></td></tr></table></figure>
<p>(6) <code>-exec COMMAND {} \;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ find -perm -<span class="number">222</span> -exec ls -lh &#123;&#125; \;</span><br><span class="line">-rwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./d</span><br><span class="line"></span><br><span class="line">$ find -perm -<span class="number">003</span> -exec chmod o-w &#123;&#125; \;</span><br><span class="line">-rwxrwxr-x <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> d</span><br><span class="line"></span><br><span class="line">$ find -not -perm /<span class="number">111</span> -ls <span class="comment"># 所有用户都没有执行权限</span></span><br><span class="line"><span class="number">69018308</span>    <span class="number">0</span> -r--r--r--   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./a</span><br><span class="line"><span class="number">69018309</span>    <span class="number">0</span> -rw-r-----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./b</span><br><span class="line"><span class="number">69018311</span>    <span class="number">0</span> -rw-rw----   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./c</span><br><span class="line"><span class="number">69018316</span>    <span class="number">0</span> -rw-r--r--   <span class="number">1</span> root     root            <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> ./e</span><br><span class="line"></span><br><span class="line">$ find -not -perm /<span class="number">111</span> -exec mv &#123;&#125; &#123;&#125;.old \;</span><br><span class="line">-r--r--r-- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> a.old</span><br><span class="line">-rw-r----- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> b.old</span><br><span class="line">-rw-rw---- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> c.old</span><br><span class="line">-rwxrwxr-x <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> d</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">0</span> Sep <span class="number">26</span> <span class="number">21</span>:<span class="number">15</span> e.old</span><br></pre></td></tr></table></figure>
<h2 id="find实践"><a class="header-anchor" href="#find实践"></a>find实践</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ date <span class="string">"+%F %T"</span></span><br><span class="line"><span class="number">2015</span>-<span class="number">09</span>-<span class="number">26</span> <span class="number">22</span>:<span class="number">27</span>:<span class="number">23</span></span><br></pre></td></tr></table></figure>
<h3 id="1-查找-var目录属主为root-且属组为mail的所有文件；"><a class="header-anchor" href="#1-查找-var目录属主为root-且属组为mail的所有文件；"></a>1. 查找<code>/var</code>目录属主为<code>root</code>，且属组为mail的所有文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find /var -user root <span class="operator">-a</span> -group mail -ls</span><br><span class="line"><span class="number">100664354</span>    <span class="number">0</span> drwxrwxr-x   <span class="number">2</span> root    mail  <span class="number">42</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">10</span> /var/spool/mail</span><br></pre></td></tr></table></figure>
<h3 id="2-查找-usr目录下不属于root-bin或hadoop的所有文件；"><a class="header-anchor" href="#2-查找-usr目录下不属于root-bin或hadoop的所有文件；"></a>2. 查找<code>/usr</code>目录下不属于<code>root、bin</code>或<code>hadoop</code>的所有文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ useradd hadoop</span><br><span class="line">$ find /usr -not \( -user root -o -user bin -o -user hadoop \) -ls</span><br><span class="line"><span class="number">101</span> <span class="number">4</span>  drwx------   <span class="number">2</span> polkitd  root         <span class="number">4096</span> Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">40</span> /usr/share/polkit-<span class="number">1</span></span><br><span class="line"><span class="number">343</span> <span class="number">12</span> -rwsr-sr-x   <span class="number">1</span> abrt     abrt        <span class="number">11240</span> Jun <span class="number">11</span> <span class="number">00</span>:<span class="number">11</span> /usr/libexec/abrt-action</span><br></pre></td></tr></table></figure>
<h3 id="3-查找-etc目录下最近一周内其内容修改过-且属主不为root或hadoop的所有文件；"><a class="header-anchor" href="#3-查找-etc目录下最近一周内其内容修改过-且属主不为root或hadoop的所有文件；"></a>3. 查找<code>/etc</code>目录下最近一周内其内容修改过，且属主不为<code>root</code>或<code>hadoop</code>的所有文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc -mtime -<span class="number">7</span> <span class="operator">-a</span> -not \( -user root -o -user hadoop \) -exec ls -ld --full-time &#123;&#125; \;</span><br><span class="line">-rw-------. <span class="number">1</span> tss tss <span class="number">6411</span> <span class="number">2015</span>-<span class="number">09</span>-<span class="number">26</span> <span class="number">22</span>:<span class="number">20</span>:<span class="number">13.944833926</span> +<span class="number">0800</span> /etc/tcsd.conf</span><br></pre></td></tr></table></figure>
<h3 id="4-查找当前系统上没有属主或属组-且最近一周内曾被访问过的所有文件；"><a class="header-anchor" href="#4-查找当前系统上没有属主或属组-且最近一周内曾被访问过的所有文件；"></a>4. 查找当前系统上没有属主或属组，且最近一周内曾被访问过的所有文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ find / -atime -<span class="number">7</span> <span class="operator">-a</span> \( -nouser -o -nogroup \) -exec ls -ld --full-time &#123;&#125; \;</span><br><span class="line">-rw-r--r-- <span class="number">1</span> <span class="number">1001</span> <span class="number">1001</span> <span class="number">0</span> <span class="number">2015</span>-<span class="number">09</span>-<span class="number">26</span> <span class="number">19</span>:<span class="number">46</span>:<span class="number">29.494863251</span> +<span class="number">0800</span> /tmp/<span class="built_in">test</span>/a.txt</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root <span class="number">1004</span> <span class="number">0</span> <span class="number">2015</span>-<span class="number">09</span>-<span class="number">26</span> <span class="number">22</span>:<span class="number">55</span>:<span class="number">24.298981485</span> +<span class="number">0800</span> /tmp/<span class="built_in">test</span>/b.txt</span><br></pre></td></tr></table></figure>
<h3 id="5-查找-etc目录下大于20k且类型为普通文件的所有文件；"><a class="header-anchor" href="#5-查找-etc目录下大于20k且类型为普通文件的所有文件；"></a>5. 查找<code>/etc</code>目录下大于<code>20k</code>且类型为普通文件的所有文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc -type f <span class="operator">-a</span> -size +<span class="number">20</span>K -exec ls -lhd &#123;&#125; \;</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">392</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/zh-tw-ucb.ctb</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">1.4</span>M Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty/zh-tw.ctb</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">22</span>K Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/brltty.conf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">21</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/postfix/access</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">22</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/postfix/header_checks</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">27</span>K Jun <span class="number">10</span>  <span class="number">2014</span> /etc/postfix/main.cf</span><br><span class="line">-rw-r--r--. <span class="number">1</span> root root <span class="number">51</span>K May <span class="number">15</span>  <span class="number">2013</span> /etc/mime.types</span><br></pre></td></tr></table></figure>
<h3 id="6-查找-etc目录下所有用户都没有写权限的文件；"><a class="header-anchor" href="#6-查找-etc目录下所有用户都没有写权限的文件；"></a>6. 查找/etc目录下所有用户都没有写权限的文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc -not -perm /<span class="number">222</span> -ls</span><br><span class="line"><span class="number">68121580</span>    <span class="number">4</span> -r--r--r--   <span class="number">1</span> root     root           <span class="number">33</span> Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">38</span> /etc/machine-id</span><br><span class="line"><span class="number">68121595</span>    <span class="number">4</span> ----------   <span class="number">1</span> root     root         <span class="number">1248</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">10</span> /etc/shadow-</span><br><span class="line"><span class="number">69018322</span>    <span class="number">4</span> ----------   <span class="number">1</span> root     root         <span class="number">1277</span> Sep <span class="number">26</span> <span class="number">22</span>:<span class="number">04</span> /etc/shadow</span><br><span class="line"><span class="number">68899018</span>    <span class="number">4</span> -r--r--r--   <span class="number">1</span> root     root          <span class="number">146</span> Jun <span class="number">18</span> <span class="number">19</span>:<span class="number">06</span> /etc/pam.d/cups</span><br><span class="line"><span class="number">67929369</span>    <span class="number">4</span> ----------   <span class="number">1</span> root     root          <span class="number">723</span> Sep <span class="number">26</span> <span class="number">20</span>:<span class="number">10</span> /etc/gshadow-</span><br><span class="line"><span class="number">67929742</span>    <span class="number">4</span> -r--------   <span class="number">1</span> root     root           <span class="number">45</span> Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">38</span> /etc/openldap/certs/password</span><br><span class="line"><span class="number">70068545</span>    <span class="number">4</span> -r--r-----   <span class="number">1</span> root     root         <span class="number">4000</span> Mar  <span class="number">6</span>  <span class="number">2015</span> /etc/sudoers</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="7-查找-etc目录下至少有一类用户没有执行权限的文件；"><a class="header-anchor" href="#7-查找-etc目录下至少有一类用户没有执行权限的文件；"></a>7. 查找/etc目录下至少有一类用户没有执行权限的文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc -not -perm -<span class="number">111</span> -ls</span><br><span class="line"><span class="number">1426363</span>     <span class="number">0</span> drwxr-x---   <span class="number">2</span> root     named           <span class="number">6</span> Sep  <span class="number">3</span> <span class="number">18</span>:<span class="number">35</span> /etc/named</span><br><span class="line"><span class="number">34652843</span>    <span class="number">0</span> drwx------   <span class="number">2</span> root     lp              <span class="number">6</span> Jun <span class="number">18</span> <span class="number">19</span>:<span class="number">06</span> /etc/cups/ssl</span><br><span class="line"><span class="number">2385651</span>     <span class="number">4</span> -rw-r--r--   <span class="number">1</span> root     root          <span class="number">984</span> Jun <span class="number">10</span>  <span class="number">2014</span> /etc/sane.d/dc210.conf</span><br></pre></td></tr></table></figure>
<h3 id="8-查找-etc-init-d目录下-所有用户都有执行权限-且其它用户拥有写权限的文件；"><a class="header-anchor" href="#8-查找-etc-init-d目录下-所有用户都有执行权限-且其它用户拥有写权限的文件；"></a>8. 查找/etc/init.d目录下，所有用户都有执行权限，且其它用户拥有写权限的文件；</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find /etc/init.d -perm -<span class="number">111</span> <span class="operator">-a</span> -perm /<span class="number">002</span> -ls</span><br><span class="line"><span class="number">67564774</span>    <span class="number">0</span> lrwxrwxrwx   <span class="number">1</span> root     root           <span class="number">11</span> Sep <span class="number">13</span> <span class="number">05</span>:<span class="number">37</span> /etc/init.d -&gt; rc.d/init.d</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>Vim是一个类似于Vi的著名的功能强大、高度可定制的文本编辑器，在Vi的基础上改进和增加了很多特性。VIM是纯粹的自由软件。Vim普遍被推崇为类Vi编辑器中最好的一个，事实上真正的劲敌来自Emacs的不同变体。1999 年Emacs被选为Linuxworld文本编辑分类的优胜者，Vim屈居第二。但在2000年2月Vim赢得了Slashdot Beanie的最佳开放源代码文本编辑器大奖，又将Emacs推至二线， 总的来看， Vim和Emacs同样都是非常优秀的文本编辑器。</p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-17]]></title>
    <link href="http://molloc.me/2015/09/21/ZY-2015-09-17/"/>
    <id>http://molloc.me/2015/09/21/ZY-2015-09-17/</id>
    <published>2015-09-21T13:59:43.000Z</published>
    <updated>2015-09-26T01:30:43.100Z</updated>
    <content type="html"><![CDATA[<p>Linux进程查看与管理</p>
<p>OS的基本功能：文件系统、网络功能、进程管理、内存管理、驱动程序、安全功能</p>
<p>OS提供虚拟的计算机，进而能够将有限资源借助于“保护”机制分配多个同时运行的程序，即“进程”使用，从而实现了所谓的多任务；</p>
<p>Linux进程查看及管理工具</p>
<p><code>top, pstree, ps, pidof, pgrep, pkill, htop, glances, pmap, vmstat, dstat, iostat, sar, kill, job, bg, fg</code></p>
<p>程序=指令+数据</p>
<a id="more"></a>
<h2 id="进程管理与查看"><a class="header-anchor" href="#进程管理与查看"></a>进程管理与查看</h2>
<h3 id="cpu"><a class="header-anchor" href="#cpu"></a>CPU</h3>
<ul>
<li>特权指令</li>
<li>普通指令</li>
</ul>
<h3 id="程序的执行环境"><a class="header-anchor" href="#程序的执行环境"></a>程序的执行环境</h3>
<ul>
<li>内核模式: 运行内核级命令</li>
<li>用户模式: 运行普通指令</li>
</ul>
<h3 id="应用程序"><a class="header-anchor" href="#应用程序"></a>应用程序</h3>
<ul>
<li>运行普通指令: 直接运行于CPU</li>
<li>运行特权指令: 通过<code>system call</code></li>
</ul>
<p>进程就是运行中的程序,进程需要运行在一个所谓的内存空间中(指令+数据),这个内存空间是由物理内存映射而形成的逻辑地址空间.</p>
<p>对于<code>32bit</code>的主机来讲,他的寻址能力大概是</p>
<p><code>2^32, 0-2^32-1, 2^10*2^10*2^10*2^2 bytes = 2^10*2^10*2^2 kilo bytes = 2^10*2^2 MB = 4GB</code></p>
<p>对于<code>64bit</code>的主机来讲, <code>2^64, 4billions 4G</code></p>
<h3 id="进程的创建"><a class="header-anchor" href="#进程的创建"></a>进程的创建</h3>
<ol>
<li>请求发出者 --&gt; 进程：<code>fork(), clone()</code></li>
<li>COW: Copy On Writing 写时复制</li>
</ol>
<p>在Linux上,每一个进程都是由其父进程<code>fork()</code>而来,属系统调用.</p>
<p><code>parent --&gt; fork() --&gt; child</code></p>
<p>CoW(Copy on Write)机制,当父进程或子进程需要修改数据的时候.</p>
<p>Task Struct(保存了进程自己的元数据), 内核为每一个进程创建一个Task Struct,以实现内核中进程的追踪.</p>
<p>当只有一颗CPU的时候,某一个时刻只能有一个进程在运行,其他进程就处于等待,此时就需要进程间切换.</p>
<p>进程的上下文切换(Context Switch),上下文切换的时候,每个进程退出之前(还没执行完,比如有50个指令只执行了30个,此时处于挂起状态)都会找一个位置把自己的中间状态保存下来.这个位置就存在自己的内核中追踪的Task Struct当中.当再次运行的时候,就会从上次终止的地方开始执行.</p>
<h3 id="进程调度"><a class="header-anchor" href="#进程调度"></a>进程调度</h3>
<p>多任务：多进程同时运行, 抢占式多任务</p>
<h3 id="进程分类"><a class="header-anchor" href="#进程分类"></a>进程分类</h3>
<ul>
<li>CPU bound: CPU密集型(eg: 高清视频播放器)</li>
<li>I/O bound: IO密集型 (eg: 文本编辑器)</li>
</ul>
<h3 id="进程优先级"><a class="header-anchor" href="#进程优先级"></a>进程优先级</h3>
<ul>
<li>1-99：实时优先级，数字越大优先级越高</li>
<li>100-139：数字越小，优先级越高；
<ul>
<li>静态优先级</li>
<li>动态优先级</li>
</ul>
</li>
</ul>
<p>Linux 准备了140个队列,一个队列对应一个优先级</p>
<h3 id="进程的状态"><a class="header-anchor" href="#进程的状态"></a>进程的状态</h3>
<ul>
<li>running           运行态</li>
<li>sleeping          睡眠态</li>
<li>interruptible     可中断睡眠</li>
<li>uninterruptible   不可中断睡眠,被IO阻塞的进程</li>
<li>runnable          就绪态</li>
<li>stopped           停止态,不可被调度为运行状态；</li>
<li>zombie            僵死态(子进程还没有终止而父进程意外终止,成为一个orphan)</li>
</ul>
<p>CPU并行扩展机制(多核),现在程序开发时,为了提升程序运行的性能,都把程序开发为多线程,称为并发编程模型.</p>
<h3 id="进程管理"><a class="header-anchor" href="#进程管理"></a>进程管理</h3>
<ul>
<li>task struct: 用于保存每个进程元数据信息.例如：pid, ppid, memory, thread, files</li>
<li>task list: 用一种称作“链表”的数据结构来保存每个进程的task struct</li>
</ul>
<h3 id="进程切换-context-switch"><a class="header-anchor" href="#进程切换-context-switch"></a>进程切换(context switch)</h3>
<ul>
<li>保存现场</li>
<li>恢复现场</li>
</ul>
<h3 id="线程：tread"><a class="header-anchor" href="#线程：tread"></a>线程：tread</h3>
<ul>
<li>共享进程的资源，如打开文件等；</li>
<li>更轻量的、可被单独调度的运行单元</li>
</ul>
<p>LWP：Light Weight Process</p>
<p>Linux系统上除init以外的所有子进程，都是由其父进程<code>fork()</code>自身而来，遵循COW机制；进程展现为&quot;进程树&quot;</p>
<h3 id="ipc-进程间通信-常见的形式"><a class="header-anchor" href="#ipc-进程间通信-常见的形式"></a>IPC: 进程间通信,常见的形式</h3>
<ul>
<li>message queue 消息队列</li>
<li>semerphore 信号量,它负责协调各个线程, 以保证它们能够正确、合理的使用公共资源。</li>
<li>shared memory 共享内存</li>
<li>signal</li>
</ul>
<h3 id="signal-传递给进程的短小信息"><a class="header-anchor" href="#signal-传递给进程的短小信息"></a>signal: 传递给进程的短小信息</h3>
<p>Linux主机支持的进程间可用到的信息</p>
<ol>
<li>kill -l</li>
<li>man 7 signal</li>
</ol>
<p>信号表示方式</p>
<ul>
<li>完整名称，例如SIGINT</li>
<li>简写名称，例如INT</li>
<li>数据代称，例如2</li>
</ul>
<p>常用信号：</p>
<ul>
<li><code>SIGHUP: 1</code> 通知进程重读其配置文件以让新的配置生效，但不用重新启动进程；</li>
<li><code>SIGINT： 2</code> 打断正在运行中的进程，相当于键盘组合键Ctrl+c</li>
<li><code>SIGKILL： 9</code> 强行中止正在运行中的进程</li>
<li><code>SIGTERM： 15</code> 安全中止正在运行中的进程</li>
<li><code>SIGSTOP： 19</code> 暂停进程</li>
<li><code>SIGCONT： 18</code> 继续运行指定进程</li>
</ul>
<p>命令总结：<code>htop, vmstat, glances, dstat, kill, killall, sar, iostat, ifstat, tsar</code></p>
<h3 id="作业管理："><a class="header-anchor" href="#作业管理："></a>作业管理：</h3>
<ul>
<li>前台作业：通过终端启动，并且在停止之前也会一直占据终端；</li>
<li>后台作业：作业启动之时与终端无关，或者是在前台启动，但启动后转为与终端无关模式运行；</li>
</ul>
<h3 id="如何让作业运行于后台？"><a class="header-anchor" href="#如何让作业运行于后台？"></a>如何让作业运行于后台？</h3>
<ol>
<li>对于已经启动并处于运行中的作业：</li>
</ol>
<p><code>Ctrl+z</code></p>
<p>Note: 作业被送往后台后，默认处于stopped状态；</p>
<ol start="2">
<li>对于尚未启动的作业：</li>
</ol>
<p><code>COMMAND &amp;</code></p>
<p>注意: 此两类方式相关作业，仍然与终端相关；这意味着，终端终止，将会导致与此终端相关的所有作业被终止；</p>
<p>剥离进程与终端的关系：<code># nohup COMMAND &amp;</code>, 意味着跟session leader相分离了.</p>
<h3 id="作业查看："><a class="header-anchor" href="#作业查看："></a>作业查看：</h3>
<p>jobs命令, 作业号、作业状态、启动命令行程序</p>
<h3 id="作业控制命令："><a class="header-anchor" href="#作业控制命令："></a>作业控制命令：</h3>
<ul>
<li>fg [[%]job_num]：把指定的作业调回前台；</li>
<li>bg [[%]job_num]：把调往后台的指定的作业启动起来，让其后台默默运行；但此作业必须支持运行于后台；</li>
<li>kill [%job_num]：终止指定的作业；其中的%不可以省略.</li>
</ul>
<h3 id="进程优先级调整："><a class="header-anchor" href="#进程优先级调整："></a>进程优先级调整：</h3>
<h4 id="实时优先级1-99-数字越大优先级越高"><a class="header-anchor" href="#实时优先级1-99-数字越大优先级越高"></a>实时优先级1-99,数字越大优先级越高.</h4>
<h4 id="静态优先级100-139：通过指定进程的nice值来调整其优先级；用户-空间运行的进程一般都有其nice值；默认启动进程时-其nice值为0-其优先级为120；"><a class="header-anchor" href="#静态优先级100-139：通过指定进程的nice值来调整其优先级；用户-空间运行的进程一般都有其nice值；默认启动进程时-其nice值为0-其优先级为120；"></a>静态优先级100-139：通过指定进程的nice值来调整其优先级；用户 空间运行的进程一般都有其nice值；默认启动进程时，其nice值为0, 其优先级为120；</h4>
<ul>
<li>nice值：  -20, 19</li>
<li>优先级：  100, 139(数字越小优先级越高)</li>
</ul>
<h2 id="command"><a class="header-anchor" href="#command"></a>COMMAND</h2>
<h3 id="pstree"><a class="header-anchor" href="#pstree"></a>pstree</h3>
<p><strong>查看进程树</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ pstree</span><br><span class="line">	-p <span class="comment"># 显示各进程的PID</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># exercise</span></span><br><span class="line">$ pstree</span><br><span class="line">systemd─┬─ModemManager───<span class="number">2</span>*[&#123;ModemManager&#125;]</span><br><span class="line">        ├─NetworkManager───<span class="number">3</span>*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─<span class="number">2</span>*[abrt-watch-log]</span><br><span class="line">        ├─abrtd</span><br><span class="line">        ├─agetty</span><br><span class="line">        ├─alsactl</span><br><span class="line">        ├─atd</span><br><span class="line">        ├─auditd─┬─audispd─┬─sedispatch</span><br><span class="line">        │        │         └─&#123;audispd&#125;</span><br><span class="line">        │        └─&#123;auditd&#125;</span><br><span class="line">        ├─avahi-daemon───avahi-daemon</span><br><span class="line">        ├─chronyd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon</span><br><span class="line">        ├─irqbalance</span><br><span class="line">        ├─ksmtuned───sleep</span><br><span class="line">        ├─libvirtd───<span class="number">10</span>*[&#123;libvirtd&#125;]</span><br><span class="line">        ├─lsmd</span><br><span class="line">        ├─lvmetad</span><br><span class="line">        ├─master─┬─pickup</span><br><span class="line">        │        └─qmgr</span><br><span class="line">        ├─polkitd───<span class="number">5</span>*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rngd</span><br><span class="line">        ├─rsyslogd───<span class="number">2</span>*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─smartd</span><br><span class="line">        ├─sshd─┬─sshd───bash───man───less</span><br><span class="line">        │      └─sshd───bash───pstree</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───<span class="number">4</span>*[&#123;tuned&#125;]</span><br><span class="line">        └─vmtoolsd───&#123;vmtoolsd&#125;</span><br><span class="line"></span><br><span class="line">$ pstree -p</span><br><span class="line">systemd(<span class="number">1</span>)─┬─ModemManager(<span class="number">939</span>)─┬─&#123;ModemManager&#125;(<span class="number">965</span>)</span><br><span class="line">           │                   └─&#123;ModemManager&#125;(<span class="number">973</span>)</span><br><span class="line">           ├─NetworkManager(<span class="number">932</span>)─┬─&#123;NetworkManager&#125;(<span class="number">976</span>)</span><br><span class="line">           │                     ├─&#123;NetworkManager&#125;(<span class="number">991</span>)</span><br><span class="line">           │                     └─&#123;NetworkManager&#125;(<span class="number">992</span>)</span><br><span class="line">           ├─abrt-watch-log(<span class="number">927</span>)</span><br><span class="line">           ├─abrt-watch-log(<span class="number">928</span>)</span><br><span class="line">           ├─abrtd(<span class="number">925</span>)</span><br><span class="line">           ├─agetty(<span class="number">1239</span>)</span><br><span class="line">           ├─alsactl(<span class="number">918</span>)</span><br><span class="line">           ├─atd(<span class="number">1233</span>)</span><br><span class="line">           ├─auditd(<span class="number">894</span>)─┬─audispd(<span class="number">905</span>)─┬─sedispatch(<span class="number">909</span>)</span><br><span class="line">           │             │              └─&#123;audispd&#125;(<span class="number">910</span>)</span><br><span class="line">           │             └─&#123;auditd&#125;(<span class="number">904</span>)</span><br><span class="line">           ├─avahi-daemon(<span class="number">942</span>)───avahi-daemon(<span class="number">962</span>)</span><br><span class="line">           ├─chronyd(<span class="number">936</span>)</span><br><span class="line">           ├─crond(<span class="number">1231</span>)</span><br><span class="line">           ├─dbus-daemon(<span class="number">953</span>)</span><br><span class="line">           ├─irqbalance(<span class="number">943</span>)</span><br><span class="line">           ├─ksmtuned(<span class="number">960</span>)───sleep(<span class="number">3856</span>)</span><br><span class="line">           ├─libvirtd(<span class="number">1219</span>)─┬─&#123;libvirtd&#125;(<span class="number">2081</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2083</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2084</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2085</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2086</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2087</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2089</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2090</span>)</span><br><span class="line">           │                ├─&#123;libvirtd&#125;(<span class="number">2091</span>)</span><br><span class="line">           │                └─&#123;libvirtd&#125;(<span class="number">2092</span>)</span><br><span class="line">           ├─lsmd(<span class="number">920</span>)</span><br><span class="line">           ├─lvmetad(<span class="number">763</span>)</span><br><span class="line">           ├─master(<span class="number">1788</span>)─┬─pickup(<span class="number">3454</span>)</span><br><span class="line">           │              └─qmgr(<span class="number">1814</span>)</span><br><span class="line">           ├─polkitd(<span class="number">1001</span>)─┬─&#123;polkitd&#125;(<span class="number">1006</span>)</span><br><span class="line">           │               ├─&#123;polkitd&#125;(<span class="number">1007</span>)</span><br><span class="line">           │               ├─&#123;polkitd&#125;(<span class="number">1009</span>)</span><br><span class="line">           │               ├─&#123;polkitd&#125;(<span class="number">1017</span>)</span><br><span class="line">           │               └─&#123;polkitd&#125;(<span class="number">1032</span>)</span><br><span class="line">           ├─rngd(<span class="number">946</span>)</span><br><span class="line">           ├─rsyslogd(<span class="number">937</span>)─┬─&#123;rsyslogd&#125;(<span class="number">964</span>)</span><br><span class="line">           │               └─&#123;rsyslogd&#125;(<span class="number">967</span>)</span><br><span class="line">           ├─smartd(<span class="number">950</span>)</span><br><span class="line">           ├─sshd(<span class="number">1222</span>)─┬─sshd(<span class="number">2467</span>)───bash(<span class="number">2469</span>)───man(<span class="number">3700</span>)───less(<span class="number">3711</span>)</span><br><span class="line">           │            └─sshd(<span class="number">3748</span>)───bash(<span class="number">3750</span>)───pstree(<span class="number">3857</span>)</span><br><span class="line">           ├─systemd-journal(<span class="number">760</span>)</span><br><span class="line">           ├─systemd-logind(<span class="number">951</span>)</span><br><span class="line">           ├─systemd-udevd(<span class="number">771</span>)</span><br><span class="line">           ├─tuned(<span class="number">938</span>)─┬─&#123;tuned&#125;(<span class="number">1078</span>)</span><br><span class="line">           │            ├─&#123;tuned&#125;(<span class="number">1079</span>)</span><br><span class="line">           │            ├─&#123;tuned&#125;(<span class="number">1080</span>)</span><br><span class="line">           │            └─&#123;tuned&#125;(<span class="number">1081</span>)</span><br><span class="line">           └─vmtoolsd(<span class="number">923</span>)───&#123;vmtoolsd&#125;(<span class="number">974</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ps"><a class="header-anchor" href="#ps"></a>ps</h3>
<p>Linux运行中的内核的相关信息是通过<code>/proc</code>伪文件系统输出的；各进程都有一个以其PID命名的子目录，每个子目录中有许多文件存储了进程的相关状态信息；显示的是ps命令执行时，系统上当前进程状态信息的快照；所以，为静态结果.</p>
<p>常用的选项组合一 <code>ps aux</code></p>
<p>根据进程启动时是否是通过终端上的用户接口交互式启动的，进程可分为两类</p>
<ul>
<li>与终端相关的进程: a</li>
<li>与终端无关的进程: x</li>
<li>以用户为中心组织进程状态信息显示：u</li>
</ul>
<p>常用的选项组合二 <code>ps ef</code></p>
<ul>
<li><code>-e</code>: 显示所有进程；</li>
<li><code>-f</code>: 显示丰富格式信息</li>
</ul>
<p>常用的选项组合三 <code>ps -eFH</code></p>
<ul>
<li><code>-F</code>: 显示额外信息</li>
<li><code>-H</code>: 以层级形式显示进程间关系</li>
</ul>
<p>自定义需要显示的信息：<code>ps axo</code></p>
<ul>
<li><code>ps axo pid,command,psr,pri,ni</code></li>
<li><code>psr</code>: 当前进程运行的CPU编号；</li>
<li><code>pri</code>: 当前进程的优先级；</li>
<li><code>ni</code>: 当前进程的nice值(-20, 19)；</li>
</ul>
<p>支持众多选项</p>
<ul>
<li>BSD风格(不需要加<code>-</code>)</li>
<li>SysV风格(需要加<code>-</code>)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ ps aux</span><br><span class="line">USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root        <span class="number">542</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [scsi_tmf_1]</span><br><span class="line">root        <span class="number">545</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [mpt_poll_0]</span><br><span class="line">root        <span class="number">546</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [mpt/<span class="number">0</span>]</span><br><span class="line">root        <span class="number">552</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S    <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [scsi_eh_2]</span><br><span class="line">root        <span class="number">553</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [scsi_tmf_2]</span><br><span class="line">root        <span class="number">554</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [ttm_swap]</span><br><span class="line">root        <span class="number">622</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S    <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">05</span> [kworker/<span class="number">1</span>:<span class="number">2</span>]</span><br><span class="line">root        <span class="number">625</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [kdmflush]</span><br><span class="line">root        <span class="number">626</span>  <span class="number">0.0</span>  <span class="number">0.0</span>      <span class="number">0</span>     <span class="number">0</span> ?        S&lt;   <span class="number">21</span>:<span class="number">21</span>   <span class="number">0</span>:<span class="number">00</span> [bioset]</span><br><span class="line"></span><br><span class="line"><span class="comment"># commnet</span></span><br><span class="line"><span class="comment"># USER 		--&gt; 属主, PID --&gt; 进程ID, %CPU --&gt; 占用CPU的使用率</span></span><br><span class="line"><span class="comment"># %MEM 		--&gt; 占用内存的使用率</span></span><br><span class="line"><span class="comment"># VSZ  		--&gt; 线性地址空间占用的空间大小</span></span><br><span class="line"><span class="comment"># RSS  		--&gt; 常驻内存集；指不可以被交换至swap空间的数据占据空间大小</span></span><br><span class="line"><span class="comment"># TTY		--&gt; 使用的终端 ? 标识未知</span></span><br><span class="line"><span class="comment"># START 	--&gt; 启动时间</span></span><br><span class="line"><span class="comment"># TIME 		--&gt; 占据CPU累积时长</span></span><br><span class="line"><span class="comment"># COMMAND 	--&gt; 启动当前进程或线程的命令行程序，[]表示为内核线程</span></span><br><span class="line"><span class="comment"># STAT：进程状态</span></span><br><span class="line">	<span class="comment"># R: running，运行状态；</span></span><br><span class="line">	<span class="comment"># S：interruptible sleeping，可中断睡眠</span></span><br><span class="line">	<span class="comment"># D：uniterruptible sleeping, 不可中断睡眠</span></span><br><span class="line">	<span class="comment"># T: stopped</span></span><br><span class="line">	<span class="comment"># Z: zombie</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># s: session leader 会话领导者</span></span><br><span class="line">	<span class="comment"># +: 前台进程，占据着某终端</span></span><br><span class="line">	<span class="comment"># l: 多线程进程</span></span><br><span class="line">	<span class="comment"># &lt;: 高优先级进程</span></span><br><span class="line">	<span class="comment"># N: 低优先级进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SysV风格</span></span><br><span class="line">$ ps -ef</span><br></pre></td></tr></table></figure>
<h3 id="pgrep"><a class="header-anchor" href="#pgrep"></a>pgrep</h3>
<p>用来过滤进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ pgrep [OPTIONS] <span class="string">"PATTERN"</span></span><br><span class="line">	-U UID  <span class="comment">#仅显示制定用户身份运行的进程</span></span><br><span class="line">	-G GID</span><br><span class="line">	<span class="operator">-l</span> 		<span class="comment"># 显示PID和进程名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># demo</span></span><br><span class="line">$ pgrep -U postfix</span><br><span class="line"><span class="number">1804</span></span><br><span class="line"><span class="number">1805</span></span><br><span class="line"></span><br><span class="line">$ pgrep -U postfix <span class="operator">-l</span></span><br><span class="line"><span class="number">1804</span> pickup</span><br><span class="line"><span class="number">1805</span> qmgr</span><br></pre></td></tr></table></figure>
<h3 id="pidof"><a class="header-anchor" href="#pidof"></a>pidof</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ pidof PROGRAM <span class="comment"># PROGRAM: 给定命令行程序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># demo</span></span><br><span class="line">$ pidof sshd</span><br><span class="line"><span class="number">2459</span> <span class="number">1223</span></span><br></pre></td></tr></table></figure>
<h3 id="top"><a class="header-anchor" href="#top"></a>top</h3>
<p><strong>有许多交互式的子命令</strong></p>
<ul>
<li><code>P</code>   以占据的CPU百分比大小排序；</li>
<li><code>M</code>   以占据Memory空间大小排序；</li>
<li><code>T</code>   CPU累积占用时间排序；</li>
<li><code>l</code>   是否显示系统负载行；队列长度的合理区间：CPU颗数*0.7</li>
<li><code>t</code>   是否显示进程摘要信息及CPU负载状态；</li>
<li><code>1</code>   平均或单独显示CPU的负载状态；</li>
<li><code>m</code>   是否显示内存相关的状态信息；</li>
<li><code>q</code>   退出命令</li>
<li><code>s</code>   修改延迟时长</li>
<li><code>k</code>   终止指定进程</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Cpu(s):  <span class="number">0.0</span>%us,  <span class="number">0.0</span>%sy,  <span class="number">0.0</span>%ni,<span class="number">100.0</span>%id,  <span class="number">0.0</span>%wa,  <span class="number">0.0</span>%hi,  <span class="number">0.0</span>%si,  <span class="number">0.0</span>%st</span><br><span class="line">	us: user space</span><br><span class="line">	sy: system (kernel space)</span><br><span class="line">	ni: nice</span><br><span class="line">	id: idle</span><br><span class="line">	wa: <span class="built_in">wait</span> io</span><br><span class="line">	hi: hardware interrupt</span><br><span class="line">	si: software interrupt</span><br><span class="line">	st: stolen, 被虚拟机“偷走”的百分比</span><br><span class="line"></span><br><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ top</span><br><span class="line">	-b batch   <span class="comment"># 批次显示</span></span><br><span class="line">	-n 		   <span class="comment">#: 显示的批次数量</span></span><br><span class="line">	<span class="operator">-d</span> 		   <span class="comment">#: 指明延迟时长</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># exercise</span></span><br><span class="line">$ top</span><br><span class="line">top - <span class="number">22</span>:<span class="number">55</span>:<span class="number">07</span> up <span class="number">3</span> days, <span class="number">22</span>:<span class="number">27</span>,  <span class="number">1</span> user,  load average: <span class="number">1.70</span>, <span class="number">0.46</span>, <span class="number">0.15</span></span><br><span class="line">Tasks:  <span class="number">96</span> total,   <span class="number">7</span> running,  <span class="number">89</span> sleeping,   <span class="number">0</span> stopped,   <span class="number">0</span> zombie</span><br><span class="line"><span class="comment"># Tasks当前系统上一共有多少个进程</span></span><br><span class="line">Cpu(s): <span class="number">99.3</span>%us,  <span class="number">0.3</span>%sy,  <span class="number">0.0</span>%ni,  <span class="number">0.0</span>%id,  <span class="number">0.0</span>%wa,  <span class="number">0.0</span>%hi,  <span class="number">0.3</span>%si,  <span class="number">0.0</span>%st</span><br><span class="line">Mem:   <span class="number">1018516</span>k total,   <span class="number">950732</span>k used,    <span class="number">67784</span>k free,    <span class="number">67796</span>k buffers</span><br><span class="line">Swap:  <span class="number">1048572</span>k total,        <span class="number">0</span>k used,  <span class="number">1048572</span>k free,   <span class="number">210728</span>k cached</span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND</span><br><span class="line"><span class="number">10140</span> www       <span class="number">20</span>   <span class="number">0</span>  <span class="number">382</span>m  <span class="number">47</span>m  <span class="number">27</span>m R <span class="number">17.0</span>  <span class="number">4.8</span>   <span class="number">1</span>:<span class="number">03.54</span> php-fpm</span><br><span class="line"> <span class="number">1097</span> www       <span class="number">20</span>   <span class="number">0</span>  <span class="number">400</span>m  <span class="number">57</span>m  <span class="number">32</span>m R <span class="number">16.6</span>  <span class="number">5.8</span>   <span class="number">2</span>:<span class="number">27.93</span> php-fpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># uptime命令: 显示当前系统时间，运行时长，登录用户数及系统平均负载</span></span><br><span class="line"><span class="comment"># (0.00 --&gt; 过去一分钟的平均负载, 0.00 过去五分钟的平均负载 , 0.00 过去十五分钟的平均负载)</span></span><br><span class="line">$ uptime</span><br><span class="line"> <span class="number">22</span>:<span class="number">44</span>:<span class="number">41</span> up <span class="number">3</span> days, <span class="number">22</span>:<span class="number">17</span>,  <span class="number">1</span> user,  load average: <span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.00</span></span><br></pre></td></tr></table></figure>
<h3 id="htop"><a class="header-anchor" href="#htop"></a>htop</h3>
<p><em>htop - interactive process viewer</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">htop</span><br><span class="line"><span class="comment"># 交互式命令</span></span><br><span class="line">	u <span class="comment"># 过滤仅显示选定用户的进程；</span></span><br><span class="line">	s <span class="comment"># 跟踪选定的进程所发起的系统调用；</span></span><br><span class="line">	l <span class="comment"># 显示选定进程所打开的文件；</span></span><br><span class="line">	t <span class="comment"># 显示进程的层次结构；</span></span><br><span class="line">	a <span class="comment"># 设定进程的cpu亲缘性；（将选定的进程绑定在指定的CPU上）</span></span><br><span class="line">	F2,S <span class="comment"># 到设置界面</span></span><br><span class="line">	F3,/ <span class="comment"># 进程搜索,search会将光标定位到符合条件的进程上</span></span><br><span class="line">	F4,\ <span class="comment"># 进程过滤,filter会直接将符合条件的进程筛选出来</span></span><br><span class="line">	F5   <span class="comment"># 显示进程树；</span></span><br><span class="line">	F7   <span class="comment"># 减小nice值,选择某一个进程,直接按F7</span></span><br><span class="line">	F8   <span class="comment"># 增加nice值,选择某一个进程,直接按F8</span></span><br><span class="line">	F9   <span class="comment"># 杀掉指定进程</span></span><br><span class="line">	F10  <span class="comment"># 退出htop</span></span><br><span class="line">	U	 <span class="comment"># 取消所有选中的进程；</span></span><br><span class="line">	I	 <span class="comment"># 对排序的结果进行反转显示；</span></span><br><span class="line">	M    <span class="comment"># 按照内存使用百分比排序，对应MEM%列；</span></span><br><span class="line">	P    <span class="comment"># 按照CPU使用百分比排序，对应CPU%列；</span></span><br><span class="line">	T    <span class="comment"># 按照进程运行的时间排序，对应TIME+列；</span></span><br><span class="line">	K    <span class="comment"># 隐藏内核线程；</span></span><br><span class="line">	H    <span class="comment"># 隐藏用户线程；</span></span><br><span class="line">	<span class="comment">#    # 快速定位光标到PID所指定的进程上。</span></span><br><span class="line"><span class="comment"># 选项</span></span><br><span class="line">	<span class="operator">-d</span> <span class="comment"># 延迟时长</span></span><br><span class="line">	-u <span class="comment"># USERNAME: 仅显示指定用户的进程；</span></span><br><span class="line">	<span class="operator">-s</span> <span class="comment"># COLUMN: 根据指定的字段进行排序；</span></span><br><span class="line">	空格键 <span class="comment"># 用于标记选中的进程，用于实现对多个进程同时操作；</span></span><br><span class="line">$ htop</span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-17/htop-view.png" alt="htop-view"></p>
<h3 id="vmstat"><a class="header-anchor" href="#vmstat"></a>vmstat</h3>
<h4 id="procs"><a class="header-anchor" href="#procs"></a>procs</h4>
<ul>
<li>r: 等待运行的进程的个数；（队列长度）</li>
<li>b：处理不可中断睡眠状态的进程的个数；（即IO阻塞队列长度）</li>
</ul>
<h4 id="memory"><a class="header-anchor" href="#memory"></a>memory</h4>
<ul>
<li>swpd: 交换内存使用量；</li>
<li>free: 空间的物理内存量；</li>
<li>buffer: 用于buffer的内存总量；</li>
<li>cache: 用于cache的内存总量；</li>
</ul>
<h4 id="swap"><a class="header-anchor" href="#swap"></a>swap</h4>
<ul>
<li>si: 数据进入swap中的速率(kb/s)</li>
<li>so: 数据离开swap的速率(kb/s)</li>
</ul>
<h4 id="io"><a class="header-anchor" href="#io"></a>io</h4>
<ul>
<li>bi: 从块设备读入数据到系统的速率(kb/s)</li>
<li>bo: 保存数据至块设备的速率(kb/s)</li>
</ul>
<h4 id="system"><a class="header-anchor" href="#system"></a>system</h4>
<ul>
<li>in: 中断速率</li>
<li>cs: 进程切换的速率</li>
</ul>
<h4 id="cpu-v2"><a class="header-anchor" href="#cpu-v2"></a>cpu</h4>
<ul>
<li>us: user space</li>
<li>sy: system (kernel space)</li>
<li>id: idle</li>
<li>wa: wait io</li>
<li>st: stolen, 被虚拟机“偷走”的百分比</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">vmstat [delay [count]] <span class="comment"># delay 显示延迟的时间, count 显示批次的数量</span></span><br><span class="line">		<span class="operator">-s</span> 	<span class="comment"># 显示内存的状态统计数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#exercise</span></span><br><span class="line">$ vmstat <span class="number">5</span> <span class="number">5</span></span><br><span class="line">procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----</span><br><span class="line">r  b  swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs    us sy id wa st</span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>     <span class="number">0</span> <span class="number">1617644</span>  <span class="number">24580</span> <span class="number">123460</span>   <span class="number">0</span>    <span class="number">0</span>   <span class="number">139</span>     <span class="number">4</span>   <span class="number">384</span>  <span class="number">328</span>    <span class="number">1</span>  <span class="number">6</span> <span class="number">85</span>  <span class="number">1</span>  <span class="number">6</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>     <span class="number">0</span> <span class="number">1617504</span>  <span class="number">24580</span> <span class="number">123488</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">6</span>   <span class="number">417</span>  <span class="number">246</span>    <span class="number">0</span>  <span class="number">0</span> <span class="number">99</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>     <span class="number">0</span> <span class="number">1617512</span>  <span class="number">24588</span> <span class="number">123488</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">3</span>   <span class="number">407</span>  <span class="number">250</span>    <span class="number">0</span>  <span class="number">0</span> <span class="number">99</span>  <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>     <span class="number">0</span> <span class="number">1617512</span>  <span class="number">24588</span> <span class="number">123488</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">346</span>  <span class="number">249</span>    <span class="number">0</span>  <span class="number">0</span> <span class="number">100</span> <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>     <span class="number">0</span> <span class="number">1617512</span>  <span class="number">24588</span> <span class="number">123488</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">280</span>  <span class="number">248</span>    <span class="number">0</span>  <span class="number">0</span> <span class="number">100</span> <span class="number">0</span>  <span class="number">0</span></span><br><span class="line"></span><br><span class="line">$ vmstat <span class="operator">-s</span> <span class="comment"># 显示内存的状态统计数据</span></span><br><span class="line">   <span class="number">1870512</span> K total memory</span><br><span class="line">    <span class="number">120004</span> K used memory</span><br><span class="line">     <span class="number">69036</span> K active memory</span><br><span class="line">    <span class="number">106952</span> K inactive memory</span><br><span class="line">   <span class="number">1571952</span> K free memory</span><br><span class="line">       <span class="number">920</span> K buffer memory</span><br><span class="line">    <span class="number">177636</span> K swap cache</span><br><span class="line">   <span class="number">4194296</span> K total swap</span><br><span class="line">         <span class="number">0</span> K used swap</span><br><span class="line">   <span class="number">4194296</span> K free swap</span><br><span class="line">       <span class="number">492</span> non-nice user cpu ticks</span><br><span class="line">         <span class="number">0</span> nice user cpu ticks</span><br><span class="line">      <span class="number">1827</span> system cpu ticks</span><br><span class="line">   <span class="number">3437284</span> idle cpu ticks</span><br><span class="line">        <span class="number">57</span> IO-wait cpu ticks</span><br><span class="line">         <span class="number">0</span> IRQ cpu ticks</span><br><span class="line">       <span class="number">548</span> softirq cpu ticks</span><br><span class="line">         <span class="number">0</span> stolen cpu ticks</span><br><span class="line">    <span class="number">138580</span> pages paged <span class="keyword">in</span></span><br><span class="line">      <span class="number">9589</span> pages paged out</span><br><span class="line">         <span class="number">0</span> pages swapped <span class="keyword">in</span></span><br><span class="line">         <span class="number">0</span> pages swapped out</span><br><span class="line">    <span class="number">312716</span> interrupts</span><br><span class="line">    <span class="number">490920</span> CPU context switches</span><br><span class="line"><span class="number">1443013324</span> boot time</span><br><span class="line">         <span class="number">4022</span> forks</span><br></pre></td></tr></table></figure>
<h3 id="pmap"><a class="header-anchor" href="#pmap"></a>pmap</h3>
<p><strong>查看指定进程的内存映射关系</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">pmap [OPTIONS] pid...</span><br><span class="line">		-x: <span class="comment"># 显示扩展信息</span></span><br></pre></td></tr></table></figure>
<h3 id="glances"><a class="header-anchor" href="#glances"></a>glances</h3>
<p><strong>一个跨平台的监控工具</strong></p>
<h4 id="glances交互式命令"><a class="header-anchor" href="#glances交互式命令"></a>glances交互式命令</h4>
<p><em>You can use the following keys while in Glances !</em></p>
<ul>
<li><code>a</code> <em>Sort process list automatically</em></li>
<li><code>b</code> <em>Switch between bit/s or Byte/s for network I/O</em></li>
<li><code>c</code> <em>Sort processes by CPU usage</em></li>
<li><code>d</code> <em>Show/hide disk I/O stats</em></li>
<li><code>f</code> <em>Show/hide file system stats</em></li>
<li><code>h</code> <em>Show/hide the help screen</em></li>
<li><code>i</code> <em>Sort processes by I/O rate</em></li>
<li><code>l</code> <em>Show/hide log messages</em></li>
<li><code>m</code> <em>Sort processes by MEM usage</em></li>
<li><code>n</code> <em>Show/hide network stats</em></li>
<li><code>p</code> <em>Sort processes by name</em></li>
<li><code>q</code> <em>Quit</em></li>
<li><code>s</code> <em>Show/hide sensors stats (only available with -e flag)</em></li>
<li><code>t</code> <em>View network I/O as combination</em></li>
<li><code>u</code> <em>View cumulative network I/O</em></li>
<li><code>w</code> <em>Delete finished warning log messages</em></li>
<li><code>x</code> <em>Delete finished warning and critical log messages</em></li>
<li><code>y</code> <em>Show/hide hddtemp stats (only available with -y flag)</em></li>
<li><code>z</code> <em>Show/hide processes list (for low CPU consumption)</em></li>
<li><code>p</code> <em>Sort processes by name</em></li>
<li><code>q</code> <em>Quit</em></li>
<li><code>s</code> <em>Show/hide sensors stats (only available with -e flag)</em></li>
<li><code>t</code> <em>View network I/O as combination</em></li>
<li><code>u</code> <em>View cumulative network I/O</em></li>
<li><code>w</code> <em>Delete finished warning log messages</em></li>
<li><code>x</code> <em>Delete finished warning and critical log messages</em></li>
<li><code>y</code> <em>Show/hide hddtemp stats (only available with -y flag)</em></li>
<li><code>z</code> <em>Show/hide processes list (for low CPU consumption)</em></li>
<li><code>1</code> <em>Switch between global CPU and per-CPU stats</em></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">glances [-bdehmnrsvyz1] [-B <span class="built_in">bind</span>] [-c server] [-C conffile] [-p port] [-P password] [--password] [-t refresh] [<span class="operator">-f</span> file] [-o output]</span><br><span class="line"></span><br><span class="line"><span class="comment"># options</span></span><br><span class="line"> -b  <span class="comment"># Display network rate in Byte per second (default: bit per second)</span></span><br><span class="line"> -B @IP|HOST <span class="comment"># 将服务绑定到给定的IPv4 / IPv6地址或主机名</span></span><br><span class="line"> -c @IP|HOST <span class="comment"># 连接到一个glances服务用给定的IPv4 / IPv6地址或主机名</span></span><br><span class="line"> <span class="operator">-s</span>  <span class="comment"># 运行glances在server模式下</span></span><br><span class="line"> -<span class="number">1</span>  <span class="comment"># 单独显示每颗CPU相关负载数据信息</span></span><br><span class="line"> -t  <span class="comment"># 指定延迟时长，默认为3秒</span></span><br><span class="line"> -n  <span class="comment"># 关闭网络功能模块</span></span><br><span class="line"> -m  <span class="comment"># 关闭mount功能模块</span></span><br><span class="line"> <span class="operator">-f</span>  <span class="comment"># /PATH/TO/SOMEFILE：设置输出文件的位置及格式</span></span><br><span class="line"> <span class="operator">-d</span>  <span class="comment"># 关闭磁盘I/O功能模块</span></span><br><span class="line"> -o  <span class="comment"># &#123;HTML|CSV&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># exercise</span></span><br><span class="line"><span class="comment"># 演示glances的服务模式</span></span><br><span class="line">$ glances <span class="operator">-s</span> -B <span class="number">192.168</span>.<span class="number">1.160</span> -p <span class="number">9999</span> &amp;</span><br><span class="line">$ <span class="built_in">jobs</span></span><br><span class="line">[<span class="number">1</span>]+  Running  glances <span class="operator">-s</span> -B <span class="number">192.168</span>.<span class="number">1.160</span> -p <span class="number">9999</span> &amp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端去连接</span></span><br><span class="line">$ glances -c <span class="number">192.168</span>.<span class="number">1.160</span> -p <span class="number">9999</span></span><br><span class="line"><span class="comment"># 参考下图</span></span><br><span class="line">Connected to <span class="number">192.168</span>.<span class="number">1.160</span> | Press <span class="string">'h'</span> <span class="keyword">for</span> <span class="built_in">help</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-17/glances-client.png" alt="glances-client"></p>
<h3 id="安装pip-bottle-batinfo"><a class="header-anchor" href="#安装pip-bottle-batinfo"></a>安装pip,bottle,batinfo</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装pip</span></span><br><span class="line">$ wget https://bootstrap.pypa.io/get-pip.py</span><br><span class="line">$ python get-pip.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试pip是否安装</span></span><br><span class="line">$ pip install bottle <span class="comment"># 用pip安装bottle</span></span><br><span class="line">Stored <span class="keyword">in</span> directory: /root/.cache/pip/wheels/<span class="number">2</span>e/<span class="number">69</span>/<span class="number">1</span>f/bcf8d1</span><br><span class="line">Successfully built bottle</span><br><span class="line">Installing collected packages: bottle</span><br><span class="line">Successfully installed bottle-<span class="number">0.12</span>.<span class="number">8</span></span><br><span class="line"></span><br><span class="line">$ pip install batinfo</span><br><span class="line">Building wheels <span class="keyword">for</span> collected packages: batinfo</span><br><span class="line">  Running setup.py bdist_wheel <span class="keyword">for</span> batinfo</span><br><span class="line">  Stored <span class="keyword">in</span> directory: /root/.cache/pip/wheels/<span class="number">04</span>/<span class="number">85</span>/aa/<span class="number">90</span>fac8b</span><br><span class="line">Successfully built batinfo</span><br><span class="line">Installing collected packages: batinfo</span><br><span class="line">Successfully installed batinfo-<span class="number">0.3</span></span><br></pre></td></tr></table></figure>
<h3 id="dstat"><a class="header-anchor" href="#dstat"></a>dstat</h3>
<p><strong>整合了vmstat, iostat, netstat and ifstat四款工具的功能</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">dstat [-afv] [options..] [delay [count]]</span><br><span class="line">	-c <span class="comment"># 显示cpu性能指标相关的统计数据；</span></span><br><span class="line">	<span class="operator">-d</span> <span class="comment"># 显示disk相关的速率数据；</span></span><br><span class="line">	-g <span class="comment"># 显示page相关的速率数据；</span></span><br><span class="line">	-i <span class="comment"># 显示interrupt相关的速率数据；</span></span><br><span class="line">	<span class="operator">-l</span> <span class="comment"># 显示load average相关的统计数据；</span></span><br><span class="line">	-m <span class="comment"># 显示memory相关的统计数据；</span></span><br><span class="line">	-n <span class="comment"># 显示网络收发数据的速率；`</span></span><br><span class="line">	-p <span class="comment"># 显示进程相关的统计数据，</span></span><br><span class="line">	-r <span class="comment"># io请求的速率；</span></span><br><span class="line">	<span class="operator">-s</span> <span class="comment"># 显示swap的相关数据</span></span><br><span class="line">	-y <span class="comment"># 显示系统相关的数据，包括中断和进程切换；</span></span><br><span class="line">	--top-cpu   <span class="comment"># 显示最占用CPU的进程；</span></span><br><span class="line">	--top-bio   <span class="comment"># 显示最消耗block io的进程；</span></span><br><span class="line">	--top-io    <span class="comment"># 最占用io的进程；</span></span><br><span class="line">	--top-mem   <span class="comment"># 显示最占用内存的进程；</span></span><br><span class="line">	--ipc 		<span class="comment"># 显示进程间通信相关的速率数据；</span></span><br><span class="line">	--raw 		<span class="comment"># 显示raw套接的相关的数据；</span></span><br><span class="line">	--tcp 		<span class="comment"># 显示tcp套接字的相关数据；</span></span><br><span class="line">	--udp 		<span class="comment"># 显示udp套接字的相关数据；</span></span><br><span class="line">	--unix 		<span class="comment"># 显示unix sock接口相关的统计数据；</span></span><br><span class="line">	--socket</span><br><span class="line">	<span class="operator">-a</span>: -cdngy</span><br><span class="line">	delay count <span class="comment"># 延长多少时间显示多少批</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># exercise</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-17/dstat-view.png" alt="dstat-view"></p>
<h3 id="kill"><a class="header-anchor" href="#kill"></a>kill</h3>
<p><em>kill - terminate a process</em></p>
<p>Linux中的<code>kill</code>命令用来终止指定的进程(terminate a process)的运行，是Linux下进程管理的常用命令。通常，终止一个前台进程可以使用<code>Ctrl+C</code>键，但是，对于一个后台进程就须用<code>kill</code>命令来终止，我们就需要先使用<code>ps/pidof/pstree/top</code>等工具获取进程<code>PID</code>，然后使用<code>kill</code>命令来杀掉该进程。<code>kill</code>命令是通过向进程或进程组发送指定的信号来结束相应进程的。在默认情况下，采用编号为15的TERM信号。TERM信号将终止所有不能捕获该信号的进程。对于那些可以捕获该信号的进程就要用编号为9的kill信号，强行“杀掉”该进程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line"><span class="built_in">kill</span> [<span class="operator">-s</span> signal|-p] [-q sigval] [<span class="operator">-a</span>] [--] pid...</span><br><span class="line"><span class="built_in">kill</span> <span class="operator">-l</span> [signal]</span><br><span class="line"></span><br><span class="line"><span class="comment"># options</span></span><br><span class="line"><span class="operator">-s</span> <span class="comment">#指定发送的信号。</span></span><br><span class="line">-p <span class="comment">#模拟发送信号。</span></span><br><span class="line"><span class="operator">-l</span> <span class="comment">#指定信号的名称列表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 向进程发信号</span></span><br><span class="line"><span class="built_in">kill</span> [-SIGNAL] PID <span class="comment">#默认的信号为SIGTERM</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kill相似的一组进程</span></span><br><span class="line">killall [-SIGNAL] PROGRAM</span><br><span class="line"></span><br><span class="line"><span class="comment"># /bin/kill</span></span><br><span class="line">$ /bin/<span class="built_in">kill</span> -p <span class="number">0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line">$ /bin/<span class="built_in">kill</span> -L</span><br><span class="line"> <span class="number">1</span> HUP      <span class="number">2</span> INT      <span class="number">3</span> QUIT     <span class="number">4</span> ILL      <span class="number">5</span> TRAP     <span class="number">6</span> ABRT     <span class="number">6</span> IOT</span><br><span class="line"> <span class="number">7</span> BUS      <span class="number">8</span> FPE      <span class="number">9</span> KILL    <span class="number">10</span> USR1    <span class="number">11</span> SEGV    <span class="number">12</span> USR2    <span class="number">13</span> PIPE</span><br><span class="line"><span class="number">14</span> ALRM    <span class="number">15</span> TERM    <span class="number">16</span> STKFLT  <span class="number">17</span> CHLD    <span class="number">17</span> CLD     <span class="number">18</span> CONT    <span class="number">19</span> STOP</span><br><span class="line"><span class="number">20</span> TSTP    <span class="number">21</span> TTIN    <span class="number">22</span> TTOU    <span class="number">23</span> URG     <span class="number">24</span> XCPU    <span class="number">25</span> XFSZ    <span class="number">26</span> VTALRM</span><br><span class="line"><span class="number">27</span> PROF    <span class="number">28</span> WINCH   <span class="number">29</span> IO      <span class="number">29</span> POLL    <span class="number">30</span> PWR     <span class="number">31</span> UNUSED  <span class="number">31</span> SYS</span><br><span class="line"><span class="number">34</span> RTMIN   <span class="number">64</span> RTMAX</span><br></pre></td></tr></table></figure>
<h3 id="jobs"><a class="header-anchor" href="#jobs"></a>jobs</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">$ <span class="built_in">jobs</span></span><br><span class="line">[<span class="number">1</span>]-  Stopped                 glances</span><br><span class="line">[<span class="number">2</span>]+  Stopped                 htop <span class="comment"># + 代码fg第一个被恢复的</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">fg</span></span><br><span class="line">[<span class="number">1</span>]+  Stopped                 glances</span><br></pre></td></tr></table></figure>
<h3 id="nice-renice"><a class="header-anchor" href="#nice-renice"></a>nice, renice</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">nice -n N COMMAND <span class="comment"># 对于尚未启动的进程</span></span><br><span class="line">renice -n N PID <span class="comment"># 对于已经启动并处于运行中的进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：普通用户仅能够调大nice，调低优先级；</span></span><br><span class="line"></span><br><span class="line">$ ps axo pid,<span class="built_in">command</span>,ni | grep httpd | grep -v grep</span><br><span class="line"><span class="number">2641</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"><span class="number">2642</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"><span class="number">2643</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"><span class="number">2644</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"><span class="number">2645</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"><span class="number">2647</span> /usr/sbin/httpd -DFOREGROUN   <span class="number">0</span></span><br><span class="line"></span><br><span class="line">$ killall httpd</span><br><span class="line">$ nice -n <span class="number">5</span> httpd</span><br><span class="line">$ ps axo pid,<span class="built_in">command</span>,ni | grep httpd | grep -v grep</span><br><span class="line"><span class="number">2781</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2796</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2797</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2798</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2799</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2800</span> httpd                         <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于已经启动的进程,用renice调整优先级</span></span><br><span class="line">$ renice -n <span class="number">10</span> <span class="number">2800</span></span><br><span class="line"><span class="number">2800</span> (process ID) old priority <span class="number">5</span>, new priority <span class="number">10</span></span><br><span class="line"></span><br><span class="line">$ ps axo pid,<span class="built_in">command</span>,ni | grep httpd | grep -v grep</span><br><span class="line"><span class="number">2781</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2796</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2797</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2798</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2799</span> httpd                         <span class="number">5</span></span><br><span class="line"><span class="number">2800</span> httpd                         <span class="number">10</span></span><br></pre></td></tr></table></figure>
<h3 id="iostat"><a class="header-anchor" href="#iostat"></a>iostat</h3>
<p><em>iostat - Report Central Processing Unit (CPU) statistics and input/output statistics for devices and partitions.</em></p>
<p>iostat工具将对系统的磁盘操作活动进行监视。它的特点是汇报磁盘活动统计情况，同时也会汇报出CPU使用情况。同<code>vmstat</code>一样，<code>iostat</code>也有一个弱点，就是它不能对某个进程进行深入分析，仅对系统的整体情况进行分析。<code>iostat</code>属于<code>sysstat</code>软件包。可以用<code>yum install sysstat</code>直接安装。通过iostat方便查看CPU、网卡、tty设备、磁盘、CD-ROM 等等设备的活动情况,负载信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line">iostat [options] [ interval [ count ] ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># options</span></span><br><span class="line">-C 		  <span class="comment"># 显示CPU使用情况</span></span><br><span class="line"><span class="operator">-d</span> 		  <span class="comment"># 显示磁盘使用情况</span></span><br><span class="line">-k 		  <span class="comment"># 以 KB 为单位显示</span></span><br><span class="line">-m 		  <span class="comment"># 以 M 为单位显示</span></span><br><span class="line">-N 		  <span class="comment"># 显示磁盘阵列(LVM) 信息</span></span><br><span class="line">-n 		  <span class="comment"># 显示NFS 使用情况</span></span><br><span class="line">-p [ &#123; device [,...] | ALL &#125; ] <span class="comment"># 显示磁盘和分区的情况</span></span><br><span class="line">-t 		  <span class="comment"># 显示终端和CPU的信息</span></span><br><span class="line">-x 		  <span class="comment"># 显示详细信息</span></span><br><span class="line">-V 		  <span class="comment"># 显示版本信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1 显示所有设备负载情况</span></span><br><span class="line">$ iostat</span><br><span class="line">Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229.14</span>.<span class="number">1</span>.el7.x86_64 (kernel) 	<span class="number">09</span>/<span class="number">26</span>/<span class="number">2015</span> 	_x86_64_	(<span class="number">4</span> CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           <span class="number">0.01</span>    <span class="number">0.00</span>    <span class="number">0.08</span>    <span class="number">0.01</span>    <span class="number">0.00</span>   <span class="number">99.90</span></span><br><span class="line"></span><br><span class="line">Device:            tps    kB_<span class="built_in">read</span>/s    kB_wrtn/s    kB_<span class="built_in">read</span>    kB_wrtn</span><br><span class="line">scd0              <span class="number">0.00</span>         <span class="number">0.01</span>         <span class="number">0.00</span>         <span class="number">44</span>          <span class="number">0</span></span><br><span class="line">sda               <span class="number">1.75</span>        <span class="number">29.76</span>         <span class="number">2.27</span>     <span class="number">142284</span>      <span class="number">10838</span></span><br><span class="line">dm-<span class="number">0</span>              <span class="number">0.05</span>         <span class="number">0.21</span>         <span class="number">0.00</span>       <span class="number">1008</span>          <span class="number">0</span></span><br><span class="line">dm-<span class="number">1</span>              <span class="number">1.16</span>        <span class="number">22.77</span>         <span class="number">1.41</span>     <span class="number">108838</span>       <span class="number">6726</span></span><br><span class="line">dm-<span class="number">2</span>              <span class="number">0.05</span>         <span class="number">0.13</span>         <span class="number">0.43</span>        <span class="number">610</span>       <span class="number">2048</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 显示指定磁盘信息</span></span><br><span class="line">$ iostat <span class="operator">-d</span> sda1</span><br><span class="line">Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229.14</span>.<span class="number">1</span>.el7.x86_64 (kernel) 	<span class="number">09</span>/<span class="number">26</span>/<span class="number">2015</span> 	_x86_64_	(<span class="number">4</span> CPU)</span><br><span class="line"></span><br><span class="line">Device:            tps    kB_<span class="built_in">read</span>/s    kB_wrtn/s    kB_<span class="built_in">read</span>    kB_wrtn</span><br><span class="line">sda1              <span class="number">2.48</span>        <span class="number">30.28</span>         <span class="number">2.23</span>      <span class="number">27752</span>       <span class="number">2048</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 以M为单位显示所有信息</span></span><br><span class="line">$ iostat -m</span><br><span class="line">Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229.14</span>.<span class="number">1</span>.el7.x86_64 (kernel) 	<span class="number">09</span>/<span class="number">26</span>/<span class="number">2015</span> 	_x86_64_	(<span class="number">4</span> CPU)</span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           <span class="number">0.08</span>    <span class="number">0.00</span>    <span class="number">0.24</span>    <span class="number">0.01</span>    <span class="number">0.00</span>   <span class="number">99.67</span></span><br><span class="line"></span><br><span class="line">Device:            tps    MB_<span class="built_in">read</span>/s    MB_wrtn/s    MB_<span class="built_in">read</span>    MB_wrtn</span><br><span class="line">scd0              <span class="number">0.01</span>         <span class="number">0.00</span>         <span class="number">0.00</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">sda               <span class="number">6.51</span>         <span class="number">0.12</span>         <span class="number">0.01</span>        <span class="number">139</span>          <span class="number">7</span></span><br><span class="line">dm-<span class="number">0</span>              <span class="number">0.21</span>         <span class="number">0.00</span>         <span class="number">0.00</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">dm-<span class="number">1</span>              <span class="number">4.04</span>         <span class="number">0.09</span>         <span class="number">0.00</span>        <span class="number">106</span>          <span class="number">3</span></span><br><span class="line">dm-<span class="number">2</span>              <span class="number">0.20</span>         <span class="number">0.00</span>         <span class="number">0.00</span>          <span class="number">0</span>          <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 查看TPS和吞吐量信息</span></span><br><span class="line">$ iostat <span class="operator">-d</span> -k <span class="number">1</span> <span class="number">1</span></span><br><span class="line">Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229.14</span>.<span class="number">1</span>.el7.x86_64 (kernel) 	<span class="number">09</span>/<span class="number">26</span>/<span class="number">2015</span> 	_x86_64_	(<span class="number">4</span> CPU)</span><br><span class="line"></span><br><span class="line">Device:            tps    kB_<span class="built_in">read</span>/s    kB_wrtn/s    kB_<span class="built_in">read</span>    kB_wrtn</span><br><span class="line">scd0              <span class="number">0.01</span>         <span class="number">0.03</span>         <span class="number">0.00</span>         <span class="number">44</span>          <span class="number">0</span></span><br><span class="line">sda               <span class="number">6.12</span>       <span class="number">112.94</span>         <span class="number">6.13</span>     <span class="number">142588</span>       <span class="number">7735</span></span><br><span class="line">dm-<span class="number">0</span>              <span class="number">0.20</span>         <span class="number">0.80</span>         <span class="number">0.00</span>       <span class="number">1008</span>          <span class="number">0</span></span><br><span class="line">dm-<span class="number">1</span>              <span class="number">3.80</span>        <span class="number">86.38</span>         <span class="number">2.88</span>     <span class="number">109046</span>       <span class="number">3635</span></span><br><span class="line">dm-<span class="number">2</span>              <span class="number">0.19</span>         <span class="number">0.49</span>         <span class="number">1.62</span>        <span class="number">614</span>       <span class="number">2048</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5 查看设备使用率（%util）、响应时间（await）</span></span><br><span class="line">$ iostat <span class="operator">-d</span> -x-k <span class="number">1</span> <span class="number">1</span></span><br><span class="line">Linux <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">229.14</span>.<span class="number">1</span>.el7.x86_64 (kernel) 	<span class="number">09</span>/<span class="number">26</span>/<span class="number">2015</span> 	_x86_64_	(<span class="number">4</span> CPU)</span><br><span class="line"></span><br><span class="line">Device: rrqm/s wrqm/s  r/s  w/s rkB/s wkB/s avgrq-sz avgqu-sz await r_await w_await svctm %util</span><br><span class="line">scd0      <span class="number">0.00</span>   <span class="number">0.00</span> <span class="number">0.01</span> <span class="number">0.00</span>  <span class="number">0.03</span>  <span class="number">0.00</span>     <span class="number">8.00</span>     <span class="number">0.00</span>  <span class="number">0.64</span>    <span class="number">0.64</span>    <span class="number">0.00</span>  <span class="number">0.64</span>  <span class="number">0.00</span></span><br><span class="line">sda       <span class="number">0.54</span>   <span class="number">0.02</span> <span class="number">4.11</span> <span class="number">0.81</span> <span class="number">90.69</span>  <span class="number">4.93</span>    <span class="number">38.86</span>     <span class="number">0.00</span>  <span class="number">0.39</span>    <span class="number">0.37</span>    <span class="number">0.47</span>  <span class="number">0.22</span>  <span class="number">0.11</span></span><br><span class="line">dm-<span class="number">0</span>      <span class="number">0.00</span>   <span class="number">0.00</span> <span class="number">0.16</span> <span class="number">0.00</span>  <span class="number">0.64</span>  <span class="number">0.00</span>     <span class="number">8.00</span>     <span class="number">0.00</span>  <span class="number">0.29</span>    <span class="number">0.29</span>    <span class="number">0.00</span>  <span class="number">0.16</span>  <span class="number">0.00</span></span><br><span class="line">dm-<span class="number">1</span>      <span class="number">0.00</span>   <span class="number">0.00</span> <span class="number">2.88</span> <span class="number">0.17</span> <span class="number">69.36</span>  <span class="number">2.32</span>    <span class="number">46.87</span>     <span class="number">0.00</span>  <span class="number">0.50</span>    <span class="number">0.42</span>    <span class="number">1.87</span>  <span class="number">0.26</span>  <span class="number">0.08</span></span><br><span class="line">dm-<span class="number">2</span>      <span class="number">0.00</span>   <span class="number">0.00</span> <span class="number">0.15</span> <span class="number">0.00</span>  <span class="number">0.39</span>  <span class="number">1.30</span>    <span class="number">22.66</span>     <span class="number">0.00</span>  <span class="number">0.19</span>    <span class="number">0.13</span>    <span class="number">3.25</span>  <span class="number">0.15</span>  <span class="number">0.00</span></span><br></pre></td></tr></table></figure>
<p>cpu属性值说明</p>
<ul>
<li><code>%user</code>   CPU处在用户模式下的时间百分比。</li>
<li><code>%nice</code>   CPU处在带NICE值的用户模式下的时间百分比。</li>
<li><code>%system</code> CPU处在系统模式下的时间百分比。</li>
<li><code>%iowait</code> CPU等待输入输出完成时间的百分比。</li>
<li><code>%steal</code>  管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比。</li>
<li><code>%idle</code>   CPU空闲时间百分比。</li>
</ul>
<p>如果<code>%iowait</code>的值过高，表示硬盘存在I/O瓶颈，<code>%idle</code>值高，表示CPU较空闲，如果<code>%idle</code>值高但系统响应慢时，有可能是CPU等待分配内存，此时应加大内存容量。<code>%idle</code>值如果持续低于10，那么系统的CPU处理能力相对较低，表明系统中最需要解决的资源是CPU。</p>
<p>disk属性值说明</p>
<ul>
<li><code>rrqm/s</code>      每秒进行 merge 的读操作数目。即 rmerge/s</li>
<li><code>wrqm/s</code>      每秒进行 merge 的写操作数目。即 wmerge/s</li>
<li><code>r/s</code>         每秒完成的读 I/O 设备次数。即 rio/s</li>
<li><code>w/s</code>         每秒完成的写 I/O 设备次数。即 wio/s</li>
<li><code>rsec/s</code>      每秒读扇区数。即 rsect/s</li>
<li><code>wsec/s</code>      每秒写扇区数。即 wsect/s</li>
<li><code>rkB/s</code>       每秒读K字节数。因为每扇区大小为512字节。</li>
<li><code>wkB/s</code>       每秒写K字节数。</li>
<li><code>avgrq-sz</code>    平均每次设备I/O操作的数据大小 (扇区)。</li>
<li><code>avgqu-sz</code>    平均I/O队列长度。</li>
<li><code>await</code>       平均每次设备I/O操作的等待时间 (毫秒)。</li>
<li><code>svctm</code>       平均每次设备I/O操作的服务时间 (毫秒)。</li>
<li><code>%util</code>       一秒中有百分之多少的时间用于 I/O 操作，即被io消耗的cpu百分比</li>
</ul>
<p>说明</p>
<ul>
<li><code>tps</code> 该设备每秒的传输次数（Indicate the number of transfers per second that were issued to the device.）。“一次传输”意思是“一次I/O请求”。多个逻辑请求可能会被合并为“一次I/O请求”。“一次传输”请求的大小是未知的。</li>
<li><code>kB_read/s</code>   每秒从设备（drive expressed）读取的数据量；</li>
<li><code>kB_wrtn/s</code>   每秒向设备（drive expressed）写入的数据量；</li>
<li><code>kB_read</code>     读取的总数据量；</li>
<li><code>kB_wrtn</code>     写入的总数量数据量；</li>
</ul>
<p>这些单位都为Kilobytes。</p>
<p>上面的例子中，我们可以看到磁盘sda以及它的各个分区的统计数据，当时统计的磁盘总TPS是22.73，下面是各个分区的TPS。（因为是瞬间值，所以总TPS并不严格等于各个分区TPS的总和）</p>
<p>如果 <code>%util</code> 接近 100%，说明产生的<code>I/O</code>请求太多，<code>I/O</code>系统已经满负荷，该磁盘可能存在瓶颈。如果 <code>svctm</code> 比较接近 <code>await</code>，说明 <code>I/O</code> 几乎没有等待时间；如果 <code>await</code> 远大于 <code>svctm</code>，说明<code>I/O</code>队列太长，io响应太慢，则需要进行必要优化。如果<code>avgqu-sz</code>比较大，也表示有大量io在等待。</p>
<h3 id="sar"><a class="header-anchor" href="#sar"></a>sar</h3>
]]></content>
    <summary type="html">
    <![CDATA[<p>Linux进程查看与管理</p>
<p>OS的基本功能：文件系统、网络功能、进程管理、内存管理、驱动程序、安全功能</p>
<p>OS提供虚拟的计算机，进而能够将有限资源借助于“保护”机制分配多个同时运行的程序，即“进程”使用，从而实现了所谓的多任务；</p>
<p>Linux进程查看及管理工具</p>
<p><code>top, pstree, ps, pidof, pgrep, pkill, htop, glances, pmap, vmstat, dstat, iostat, sar, kill, job, bg, fg</code></p>
<p>程序=指令+数据</p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-15]]></title>
    <link href="http://molloc.me/2015/09/15/ZY-2015-09-15/"/>
    <id>http://molloc.me/2015/09/15/ZY-2015-09-15/</id>
    <published>2015-09-15T15:19:32.000Z</published>
    <updated>2015-09-19T08:46:31.500Z</updated>
    <content type="html"><![CDATA[<h2 id="sed"><a class="header-anchor" href="#sed"></a>Sed</h2>
<p><em>Sed Stream editor</em></p>
<p>sed和awk是用户、程序员和管理员应用的工具。之所以称为sed是因为它是一个流编辑器（stream editor），用于对许多文件执行一系列的编辑操作。awk是根据它的开发者Aho、Weinberger和Kernighan命名的。awk是一种编程语言，它可以使你很容易地处理结构化数据和生成格式化报告。</p>
<p>Sed的工作方式,一次从文件中读取一行到<code>pattern space</code>,然后判断这一行是不是我们需要编辑的行,如何符合条件则对其进行处理,</p>
<p>处理完之后把处理的结果输出到屏幕上.如果不符合要求也输出到屏幕上来(Sed的默认操作,称之为打印模式空间).</p>
<a id="more"></a>
<h3 id="语法"><a class="header-anchor" href="#语法"></a>语法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">sed [OPTION]... &#123;script-only-if-no-other-script&#125; [input-file]...</span><br><span class="line"></span><br><span class="line">	-r 	<span class="comment"># 支持扩展正则表达式</span></span><br><span class="line">	-n  <span class="comment"># 静默模式；</span></span><br><span class="line">	<span class="operator">-e</span>  <span class="comment"># 指定多脚本运行 eg: -e script1 -e script2 -e script3</span></span><br><span class="line">	<span class="operator">-f</span>  <span class="comment"># 从指定的文件中读取脚本并运行, -f /path/to/script_file</span></span><br><span class="line">	-i: <span class="comment"># 直接修改源文件；</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># script 的组成有两部分, 地址定界和边界命令</span></span><br><span class="line"><span class="comment">## 地址定界</span></span><br><span class="line">	<span class="comment"># 							# 指定行；</span></span><br><span class="line">	$							<span class="comment"># 最后一行；</span></span><br><span class="line">	/regexp/	  				<span class="comment"># 任何能够被regexp所匹配到的行；</span></span><br><span class="line">	\%regexp%					<span class="comment"># 同上，只不过换作%为regexp边界符；</span></span><br><span class="line">	/regexp/</span><br><span class="line">	\%regexp%|  				<span class="comment"># 匹配时忽略字符大小写；</span></span><br><span class="line">	startline,endline</span><br><span class="line">		<span class="comment">#,/regexp/				# 从#行开始，到第一次被/regexp/所匹配到的行结束，中间的所有行；</span></span><br><span class="line">		<span class="comment">#,#</span></span><br><span class="line">		/regexp1/,/regexp2/		<span class="comment"># 从第一次被/regexp1/匹配到的行开始，到第一次被/regexp2/匹配到的行结束，中间的所有行；</span></span><br><span class="line">		<span class="comment">#,+n					# 从#行开始，一直到向下的n行；</span></span><br><span class="line">	first~step 					<span class="comment"># 指定起始行，以及步长；</span></span><br><span class="line">		<span class="number">1</span>~<span class="number">2</span>，<span class="number">2</span>~<span class="number">2</span></span><br><span class="line"><span class="comment">## 编辑命令</span></span><br><span class="line">	d 						 	<span class="comment"># 删除模式空间中的行；</span></span><br><span class="line">	=						 	<span class="comment"># 显示行号；</span></span><br><span class="line">	a \text					 	<span class="comment"># 附加text</span></span><br><span class="line">	i \text					 	<span class="comment"># 插入text，支持\n实现多行插入；</span></span><br><span class="line">	c \text					 	<span class="comment"># 用text替换匹配到的行；</span></span><br><span class="line">	p 						 	<span class="comment"># 打印模式空间中的行；</span></span><br><span class="line">	s /regexp/replacement/g   	<span class="comment"># 替换由regexp所匹配到的内容为replacement;g全局替换；</span></span><br><span class="line">	w /path/to/somefile		 	<span class="comment"># 把指定的内容另存至/path/to/somefile路径所指定的文件中；</span></span><br><span class="line">	r /path/from/somefile	 	<span class="comment"># 在文件的指定位置插入另一个文件的所有内容，完成文件合并</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 高级命令</span></span><br><span class="line">	h	<span class="comment"># 将pattern space中的内容拷贝到hold space中，原来的hold space里的内容被清除</span></span><br><span class="line">	H	<span class="comment"># 将pattern space中的内容append到hold space\n后</span></span><br><span class="line">	g	<span class="comment"># 将hold space中的内容拷贝到pattern space中，原来pattern space里的内容清除</span></span><br><span class="line">	G	<span class="comment"># 将hold space中的内容append到pattern space\n后</span></span><br><span class="line">	x	<span class="comment"># 交换pattern space和hold space的内容</span></span><br><span class="line">	n	<span class="comment"># 读取匹配到的行的下一行至模式空间；（会覆盖模式空间中的原有内容）；</span></span><br><span class="line">	N	<span class="comment"># 读取匹配到的行的下一行至模式空间，追加在模式空间中原有内容的后面；</span></span><br><span class="line">	d	<span class="comment"># 删除模式空间中的内容；</span></span><br><span class="line">	D	<span class="comment"># 删除多行模式空间中的首行；</span></span><br><span class="line">		<span class="comment"># 注意：命令功能可使用!取反(对命令取反,eg: sed '1,3!d' 代表删除第1到3行之外的行)；分号可用于分隔脚本；</span></span><br></pre></td></tr></table></figure>
<h3 id="实践"><a class="header-anchor" href="#实践"></a>实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#0 /etc/fstab最初的内容</span></span><br><span class="line">$ cat /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1 删除/etc/fstab下以UUID开头的行</span></span><br><span class="line">$ sed <span class="string">'/^UUID/d'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 删除/etc/fstab第一至七行</span></span><br><span class="line">$ sed <span class="string">'1,7d'</span> /etc/fstab</span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 显示/etc/fstab第1到4行的行号</span></span><br><span class="line">$ sed <span class="string">'1,4='</span> /etc/fstab</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5 每一个UUID开头的行,后面附加一个new text</span></span><br><span class="line">$ sed <span class="string">'/^UUID/a \new text'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">new text</span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6 在以UUID开头行的前面插入new line, second line</span></span><br><span class="line">$ sed <span class="string">'/^UUID/i \new line.\second line.'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">new line.</span><br><span class="line">second line.</span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6 在以UUID开头行替换成new line.</span></span><br><span class="line">$ sed <span class="string">'/^UUID/c \new line.'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">new line.</span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#7 打印模式空间中的行,一定是匹配到的</span></span><br><span class="line">$ sed -n <span class="string">'/^UUID/p'</span> /etc/fstab</span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#####################查找替换命令################################</span></span><br><span class="line"><span class="comment">## 此时/etc/fstab中的内容</span></span><br><span class="line">$ cat /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=<span class="number">7</span>ad769dc-<span class="number">1</span>ec8-<span class="number">4582</span>-be29-<span class="number">8</span>f39cfd466ad / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#8 查找UUID开头,替换成小写的UUID</span></span><br><span class="line">$ sed <span class="string">'s/^UUID/uuid/'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">uuid=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">uuid=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">uuid=<span class="number">7</span>ad769dc-<span class="number">1</span>ec8-<span class="number">4582</span>-be29-<span class="number">8</span>f39cfd466ad / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#9 读取所有的奇数行,然后保存到/tmp/bak.log</span></span><br><span class="line">$ sed <span class="string">'1~2w /tmp/bak.log'</span> /etc/fstab</span><br><span class="line">$ cat /tmp/bak.log</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">sysfs                   /sys                    sysfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">none                  /proc/xen               xenfs		defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#10 在/etc/fstab 第5行后面插入某个文件的内容</span></span><br><span class="line">$ sed <span class="string">'5r /etc/passwd'</span> /ect/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">...</span><br><span class="line">bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=<span class="number">7</span>ad769dc-<span class="number">1</span>ec8-<span class="number">4582</span>-be29-<span class="number">8</span>f39cfd466ad / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#11 删除/boot/grub2/grub.cfg文件中所有行的行首的空白字符；</span></span><br><span class="line">$ sed <span class="string">'s/^[[:space:]]\+//'</span> /boot/grub2/grub.cfg</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># DO NOT EDIT THIS FILE</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It is automatically generated by grub2-mkconfig using templates</span></span><br><span class="line"><span class="comment"># from /etc/grub.d and settings from /etc/default/grub</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">### BEGIN /etc/grub.d/00_header ###</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#12 删除/etc/fstab文件中所有以#开头，后跟至少一个空白字符的行的行首的#和空白字符；</span></span><br><span class="line">$ sed <span class="string">'s/^#[[:space:]]\+//'</span> /etc/fstab</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/etc/fstab</span><br><span class="line">Created by anaconda on Thu Aug <span class="number">14</span> <span class="number">21</span>:<span class="number">16</span>:<span class="number">42</span> <span class="number">2014</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">Accessible filesystems, by reference, are maintained under <span class="string">'/dev/disk'</span></span><br><span class="line">See man pages fstab(<span class="number">5</span>), findfs(<span class="number">8</span>), mount(<span class="number">8</span>) and/or blkid(<span class="number">8</span>) <span class="keyword">for</span> more info</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=<span class="number">94</span>e4e384-<span class="number">0</span>ace-<span class="number">437</span>f-bc96-<span class="number">057</span>dd64f42ee / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">UUID=<span class="number">7</span>ad769dc-<span class="number">1</span>ec8-<span class="number">4582</span>-be29-<span class="number">8</span>f39cfd466ad / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">devpts                  /dev/pts                devpts  gid=<span class="number">5</span>,mode=<span class="number">620</span>  <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#13 把/etc/fstab文件的奇数行另存为/tmp/fstab.3;</span></span><br><span class="line">$ sed <span class="string">'1~2w /tmp/fstab.3'</span> /etc/fstab</span><br><span class="line">$ cat /tmp/fstab.<span class="number">3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Created by anaconda on Thu Aug 14 21:16:42 2014</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">UUID=a20840d4-<span class="number">638</span>c-<span class="number">4</span>c56-<span class="number">99</span>e8-ca0e9b15c516 / ext4 defaults,barrier=<span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">tmpfs                   /dev/shm                tmpfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">sysfs                   /sys                    sysfs   defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line">none                  /proc/xen               xenfs		defaults        <span class="number">0</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#14 echo一个文件路径给sed命令, 取出其基名；</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'/tmp/test/'</span> | sed <span class="string">'s@^.*/\([^/]\+\)/\?$@\1@'</span></span><br><span class="line"><span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#15 echo一个文件路径给sed命令, 取出其路径名</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'/tmp/test/'</span> | sed <span class="string">'s@[^/]\+/\?$@@'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 高级用法示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># test.log最初的数据</span></span><br><span class="line">$ cat test.log</span><br><span class="line">one line.</span><br><span class="line">second line.</span><br><span class="line">three line.</span><br><span class="line"></span><br><span class="line"><span class="comment">#16 在文件中的每行后方添加空白行</span></span><br><span class="line">$ sed <span class="string">'G'</span> test.log</span><br><span class="line">one line.</span><br><span class="line"></span><br><span class="line">second line.</span><br><span class="line"></span><br><span class="line">three line.</span><br><span class="line"></span><br><span class="line"><span class="comment">#17 保留最后一行</span></span><br><span class="line">$ sed <span class="string">'$1d'</span> test.log</span><br><span class="line"></span><br><span class="line"><span class="comment">#18 保证指定的文件每一行后方有且只有一个空白行；</span></span><br><span class="line">$ sed <span class="string">'/^$/d;G'</span> test.log</span><br><span class="line">one line.</span><br><span class="line"></span><br><span class="line">second line.</span><br><span class="line"></span><br><span class="line">three line.</span><br><span class="line"></span><br><span class="line"><span class="comment">#19 保留奇数行</span></span><br><span class="line">$ sed <span class="string">'n;d'</span> test.log</span><br><span class="line">one line.</span><br><span class="line">three line.</span><br><span class="line"></span><br><span class="line"><span class="comment">#20 把/ect/issue中的内容倒置</span></span><br><span class="line">$ sed <span class="string">'1!G;h;$!d'</span> /etc/issue</span><br><span class="line"></span><br><span class="line"><span class="comment">#21 大写变小写</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'HELLO WOLRD'</span> | sed <span class="string">'s/[A-Z]/\L&amp;/g'</span></span><br><span class="line">hello wolrd</span><br><span class="line"></span><br><span class="line"><span class="comment">#21 小写变大写</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'hello world'</span> | sed <span class="string">'s/[a-z]/\U&amp;/g'</span></span><br><span class="line">HELLO WORLD</span><br></pre></td></tr></table></figure>
<p><strong>接下来我们看两个有趣的示例,用到的示例文件是:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat t.txt</span><br><span class="line">one</span><br><span class="line">two</span><br><span class="line">three</span><br></pre></td></tr></table></figure>
<p>第一个示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ sed <span class="string">'H;g'</span> t.txt</span><br><span class="line">one</span><br><span class="line"></span><br><span class="line">one</span><br><span class="line">two</span><br><span class="line"></span><br><span class="line">one</span><br><span class="line">two</span><br><span class="line">three</span><br></pre></td></tr></table></figure>
<p>是不是有点没看懂，我作个图你就看懂了。</p>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-15/sed_demo_00.jpg" alt="sed 'H;g' t.txt" title="sed 'H;g' t.txt"></p>
<p>第二个示例，反序了一个文件的行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sed <span class="string">'1!G;h;$!d'</span> t.txt</span><br><span class="line">three</span><br><span class="line">two</span><br><span class="line">one</span><br></pre></td></tr></table></figure>
<p>其中的 <code>1!G;h;$!d</code> 可拆解为三个命令</p>
<ul>
<li><code>1!G</code> —— 只有第一行不执行G命令，将hold space中的内容append回到pattern space</li>
<li><code>h</code> —— 第一行都执行h命令，将pattern space中的内容拷贝到hold space中</li>
<li><code>$!d</code> —— 除了最后一行不执行d命令，其它行都执行d命令，删除当前行</li>
</ul>
<p>这个执行序列很难理解，做个图如下大家就明白了</p>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-15/sed_demo.jpg" alt="sed '1!G;h;$!d' t.txt" title="sed '1!G;h;$!d' t.txt"></p>
<h2 id="awk"><a class="header-anchor" href="#awk"></a>Awk</h2>
<p><em>报告生成器, AWK a.k.a Aho, Weinberger, Kernighan, Gnu AWK, gawk</em></p>
<h3 id="语法-v2"><a class="header-anchor" href="#语法-v2"></a>语法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">awk [options] <span class="string">'program'</span> file file ...</span><br><span class="line">awk [options] <span class="string">'PATTERN&#123;action&#125;'</span> file file ...</span><br><span class="line"></span><br><span class="line"><span class="comment">## options</span></span><br><span class="line">	-F FS <span class="comment"># 只能分隔</span></span><br></pre></td></tr></table></figure>
<h3 id="awk-的输出"><a class="header-anchor" href="#awk-的输出"></a>awk 的输出</h3>
<p><code>print item1, item2,...</code></p>
<p><strong>要点</strong></p>
<ul>
<li>各项目之间使用逗号分隔，而输出时则使用输出分隔符分隔；</li>
<li>输出的各item可以字符串或数值、当前记录的字段、变量或awk的表达式；数值会被隐式转换为字符串后输出；</li>
<li>print后面item如果省略，相当于print $0；输出空白，使用pirnt &quot;&quot;；</li>
</ul>
<h3 id="awk-的变量"><a class="header-anchor" href="#awk-的变量"></a>awk 的变量</h3>
<p><em>内置变量，自定义变量</em></p>
<p><strong>(1) 内置变量</strong></p>
<ul>
<li>FS：Field Seperator, 输入时的字段分隔符</li>
<li>RS：Record Seperator, 输入行分隔符</li>
<li>OFS: Output Field Seperator, 输出时的字段分隔符;</li>
<li>ORS: Outpput Row Seperator, 输出时的行分隔符；</li>
<li>NF：Numbers of Field，字段数(<code>$NF</code>就变成最后一个字段的值)</li>
<li>NR：Numbers of Record, 行数；所有文件的一并计数；</li>
<li>FNR：行数；各文件分别计数；</li>
<li>ARGV：数组，保存命令本身这个字符，awk '{print $0}' 1.txt 2.txt，意味着ARGV[0]保存awk,</li>
<li>ARGC: 保存awk命令中参数的个数；</li>
<li>FILENAME： awk正在处理的当前文件的名称；</li>
</ul>
<p><strong>(2) 可自定义变量</strong></p>
<ul>
<li><code>-v var_name=VALUE</code> 变量名区分字符大小写；</li>
<li>(1) 可以program中定义变量；</li>
<li>(2) 可以命令行中通过-v选项自定义变量；</li>
</ul>
<h3 id="awk的printf命令"><a class="header-anchor" href="#awk的printf命令"></a>awk的printf命令</h3>
<p><strong>命令的使用格式</strong>：<code>printf format, item1, item2,...</code></p>
<p><strong>要点</strong></p>
<ul>
<li>要指定format；</li>
<li>不会自动换行；如需换行则需要给出<code>\n</code></li>
<li>format用于为后面的每个item指定其输出格式；</li>
</ul>
<p><strong>format格式的指示符都%开头，后跟一个字符</strong></p>
<ul>
<li>%c: 显示字符的ASCII码；</li>
<li>%d, %i: 十进制整数；</li>
<li>%e, %E: 科学计数法显示数值；</li>
<li>%f: 显示浮点数；</li>
<li>%g, %G: 以科学计数法格式或浮点数格式显示数值；</li>
<li>%s: 显示字符串；</li>
<li>%u: 显示无符号整数；</li>
<li>%%: 显示%自身；</li>
</ul>
<p><strong>修饰符</strong></p>
<ul>
<li>#：显示宽度</li>
<li>-：左对齐</li>
<li>+：显示数值的符号</li>
<li>.#: 取值精度</li>
</ul>
<h3 id="awk输出重定向"><a class="header-anchor" href="#awk输出重定向"></a>awk输出重定向</h3>
<ul>
<li><code>print items &gt; output-file</code></li>
<li><code>print items &gt;&gt; output-file</code></li>
<li><code>print items | command</code></li>
</ul>
<h3 id="awk模式"><a class="header-anchor" href="#awk模式"></a>awk模式</h3>
<ul>
<li>Regexp: 格式为<code>/PATTERN/</code>,仅处理被<code>/PATTERN/</code>匹配到的行；</li>
<li>Expression: 表达式，其结果为非0或非空字符串时满足条件；仅处理满足条件的行</li>
<li>Ranges: 行范围，此前地址定界，NR仅处理范围内的行</li>
<li>BEGIN/END: 特殊模式，仅在awk命令的program运行之前（BEGIN）或运行之后（END）执行一次；</li>
<li>Empty:空模式，匹配任意行；</li>
</ul>
<h3 id="awk控制语句"><a class="header-anchor" href="#awk控制语句"></a>awk控制语句</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>-else</span><br><span class="line"><span class="comment"># 格式：if (condition) &#123;then body&#125; else &#123;else body&#125;</span></span><br><span class="line">$ awk -F: <span class="string">'&#123;if ($3&gt;=500) &#123;print $1,"is a common user"&#125; else &#123;print $1, "is an admin or system user"&#125;&#125;'</span> /etc/passwd</span><br><span class="line">$ awk <span class="string">'&#123;if (NF&gt;=8) &#123;print&#125;&#125;'</span> /etc/inittab</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span></span><br><span class="line"><span class="comment"># 格式：while (condition) &#123;while body&#125;</span></span><br><span class="line">$ awk <span class="string">'&#123;i=1; while (i&lt;=NF)&#123;printf "%s ",$i;i+=2&#125;;print ""&#125;'</span> /etc/inittab</span><br><span class="line">$ awk <span class="string">'&#123;i=1; while (i&lt;=NF)&#123;if (length($i)&gt;=6) &#123;print $i&#125;; i++&#125;&#125;'</span> /etc/inittab</span><br><span class="line"></span><br><span class="line"><span class="comment"># length函数：取字符串的长度</span></span><br><span class="line">length()</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>-while</span><br><span class="line"><span class="comment"># 格式：do &#123;do-while body&#125; while (condition)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#for</span></span><br><span class="line"><span class="comment"># 格式：for (variable assignment; condition; iteration process) &#123;for body&#125;</span></span><br><span class="line">$ awk <span class="string">'&#123;for (i=1;i&lt;=NF;i+=2)&#123;printf "%s ",$i&#125;;print ""&#125;'</span> /etc/inittab</span><br><span class="line">$ awk <span class="string">'&#123;for (i=1;i&lt;=NF;i++)&#123;if (length($i)&gt;=6) print $i&#125;&#125;'</span> /etc/inittab</span><br><span class="line"></span><br><span class="line"><span class="comment"># for循环可用来遍历数组元素：</span></span><br><span class="line">$ <span class="keyword">for</span> (i <span class="keyword">in</span> array) &#123;<span class="keyword">for</span> body&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># case语句</span></span><br><span class="line">switch (expression) &#123;<span class="keyword">case</span> VALUE or /RGEEXP/: statement1;... default: stementN&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环控制</span></span><br><span class="line"><span class="built_in">break</span></span><br><span class="line"><span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># next</span></span><br><span class="line"><span class="comment">#提前结束对本行的处理进而提前进入下一行的处理；</span></span><br><span class="line">$ awk -F: <span class="string">'&#123;if($3%2==0) next;print $1,$3&#125;'</span> /etc/passwd</span><br><span class="line">$ awk -F: <span class="string">'&#123;if(NR%2==0) next; print NR,$1&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="awk数组"><a class="header-anchor" href="#awk数组"></a>awk数组</h3>
<p>传统数组：Index编号从1开始；</p>
<p>关联数组：</p>
<p>(1) <code>array[index-expression]</code></p>
<p>index-expression: 可以使用任意字符串; 如果某数组元素事先不存在，那么在引用时，awk会自动创建此元素并将其初始化空串；因此，要判断某数组是否存在某元素，必须使用“index in array”这种格式；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A[first]=<span class="string">"hello awk"</span></span><br><span class="line"><span class="built_in">print</span> A[second]</span><br></pre></td></tr></table></figure>
<p>(2) 要遍历数组中的每一个元素，需要使用如下特殊结构：</p>
<p><code>for (var in array) {for body}</code></p>
<p>其var会遍历array的索引；</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">state[LISTEN]++</span><br><span class="line">state[ESTABLISHED]++</span><br><span class="line">$ netstat -tan | awk <span class="string">'/^tcp/&#123;++state[$NF]&#125;END&#123;for (s in state) &#123;print s,state[s]&#125;&#125;'</span></span><br><span class="line">$ awk <span class="string">'&#123;ip[$1]++&#125;END&#123;for (i in ip) &#123;print i,ip[i]&#125;&#125;'</span> /var/<span class="built_in">log</span>/httpd/access_<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<p>(3) 删除数组元素：
<code>delete array[index]</code></p>
<h3 id="awk的内置函数"><a class="header-anchor" href="#awk的内置函数"></a>awk的内置函数</h3>
<p>(1) <code>split(string,array[,fieldsep[,seps]])</code></p>
<p>功能：将string表示的字符串以fieldsep为分隔符进行切片，并切片后的结果保存至array为名的数组中；数组下标从1开始；</p>
<p><code>root:x:0:0::/root:/bin/bash</code></p>
<p><code>user[1]=&quot;root&quot;, user[2]</code></p>
<p>此函数有返回值，返回值为切片后的元素的个数</p>
<p><code>$ netstat -tn | awk '/^tcp/{lens=split($5,client,&quot;:&quot;);ip[client[1]]++}END{for (i in ip) print i,ip[i]}'</code></p>
<p>(2) <code>length(string)</code></p>
<p>功能：返回给定字串的长度</p>
<p>(3) <code>substr(string,start[,length])</code></p>
<p>功能：从string中取子串，从start为起始位置为取length长度的子串；</p>
<h3 id="实践-v2"><a class="header-anchor" href="#实践-v2"></a>实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 把/etc/passwd按:切片</span></span><br><span class="line">$ awk -F: <span class="string">'&#123;print $1,$NF&#125;'</span> /etc/passwd</span><br><span class="line">postfix /sbin/nologin</span><br><span class="line">sshd /sbin/nologin</span><br><span class="line">avahi /sbin/nologin</span><br><span class="line">tcpdump /sbin/nologin</span><br><span class="line">kernel /bin/bash</span><br><span class="line">gentoo /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 内置变量NR,FNR(行号不同)</span></span><br><span class="line">$ awk <span class="string">'&#123;print NR, $0&#125;'</span> /etc/fstab /etc/issue</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="comment">#</span></span><br><span class="line"><span class="number">3</span> <span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="number">4</span> <span class="comment"># Created by anaconda on Sat Sep 12 17:37:10 2015</span></span><br><span class="line"><span class="number">5</span> <span class="comment">#</span></span><br><span class="line"><span class="number">6</span> <span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="number">7</span> <span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="number">8</span> <span class="comment">#</span></span><br><span class="line"><span class="number">9</span> /dev/mapper/centos_kernel-root	/       xfs     defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">11</span> /dev/mapper/centos_kernel-home	/home   xfs     defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">12</span> /dev/mapper/centos_kernel-swap	swap    swap    defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">13</span> /dev/sda5						/data	ext4	defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">14</span> /dev/sda7						swap	swap	defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">15</span> \S</span><br><span class="line"><span class="number">16</span> Kernel \r on an \m</span><br><span class="line"><span class="number">17</span></span><br><span class="line"></span><br><span class="line">$ awk <span class="string">'&#123;print FNR, $0&#125;'</span> /etc/fstab /etc/issue</span><br><span class="line">$ awk <span class="string">'&#123;print NR, $0&#125;'</span> /etc/fstab /etc/issue</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="comment">#</span></span><br><span class="line"><span class="number">3</span> <span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="number">4</span> <span class="comment"># Created by anaconda on Sat Sep 12 17:37:10 2015</span></span><br><span class="line"><span class="number">5</span> <span class="comment">#</span></span><br><span class="line"><span class="number">6</span> <span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="number">7</span> <span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="number">8</span> <span class="comment">#</span></span><br><span class="line"><span class="number">9</span> /dev/mapper/centos_kernel-root	/       xfs     defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">11</span> /dev/mapper/centos_kernel-home	/home   xfs     defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">12</span> /dev/mapper/centos_kernel-swap	swap    swap    defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">13</span> /dev/sda5						/data	ext4	defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">14</span> /dev/sda7						swap	swap	defaults   <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> \S</span><br><span class="line"><span class="number">2</span> Kernel \r on an \m</span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 /etc/grub2.cfg 中每一行拥有的字段数</span></span><br><span class="line">$ awk <span class="string">'&#123;print NF&#125;'</span> /etc/grub2.cfg</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">#4 打印/etc/passwd第一字段和最后一字段</span></span><br><span class="line">$ awk -F: <span class="string">'BEGIN&#123;printf "%-20s%-10s\n", "USER", "SHELL"&#125;;&#123;printf "%-20s%-10s\n", $1, $NF&#125;'</span> /etc/passwd</span><br><span class="line">USER                SHELL</span><br><span class="line">root                /bin/bash</span><br><span class="line">bin                 /sbin/nologin</span><br><span class="line">daemon              /sbin/nologin</span><br><span class="line">adm                 /sbin/nologin</span><br><span class="line">lp                  /sbin/nologin</span><br><span class="line">sync                /bin/sync</span><br><span class="line">shutdown            /sbin/shutdown</span><br><span class="line">halt                /sbin/halt</span><br><span class="line">mail                /sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment">#5 演示自定义变量</span></span><br><span class="line">$ awk -v <span class="built_in">test</span>=<span class="string">'hello'</span> -F: <span class="string">'&#123;print test, $1&#125;'</span> /etc/passwd</span><br><span class="line">hello root</span><br><span class="line">hello bin</span><br><span class="line">hello daemon</span><br><span class="line">hello adm</span><br><span class="line">hello lp</span><br><span class="line">hello sync</span><br><span class="line"></span><br><span class="line"><span class="comment">#6 演示条件表达式</span></span><br><span class="line">$ awk -F: <span class="string">'&#123;$3&gt;=1000?utype="common user":utype="admin or sys user"; print $1, "is a", utype&#125;'</span> /etc/passwd</span><br><span class="line">postfix is a admin or sys user</span><br><span class="line">sshd is a admin or sys user</span><br><span class="line">avahi is a admin or sys user</span><br><span class="line">tcpdump is a admin or sys user</span><br><span class="line">kernel is a common user</span><br><span class="line">gentoo is a common user</span><br><span class="line"></span><br><span class="line"><span class="comment">#7 显示/etc/fstab,以UUID开头的第三个字段</span></span><br><span class="line">$ awk <span class="string">'/^(UUID|uuid)/&#123;print $1, $3&#125;'</span> /etc/fstab</span><br><span class="line">UUID=<span class="number">944</span>c8505-<span class="number">929</span>d-<span class="number">42</span><span class="built_in">cd</span>-<span class="number">8</span>d3f-cc2f66c7df55 xfs</span><br><span class="line"></span><br><span class="line"><span class="comment">#8 如果用户的ID大于1000,就把它的用户名ID显示出来</span></span><br><span class="line">$ awk -F: <span class="string">'$3&gt;=1000&#123;print $1, $3&#125;'</span> /etc/passwd</span><br><span class="line">nfsnobody <span class="number">65534</span></span><br><span class="line">kernel <span class="number">1000</span></span><br><span class="line">gentoo <span class="number">1001</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#9 如果用户的shell是bash,就把它的用户名,shell显示出来</span></span><br><span class="line">$ awk -F: <span class="string">'$NF~/bash$/&#123;print $1, $NF&#125;'</span> /etc/passwd</span><br><span class="line">root /bin/bash</span><br><span class="line">kernel /bin/bash</span><br><span class="line">gentoo /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment">#10 处理指定的行,显示/etc/passwd第3-6行</span></span><br><span class="line">$ awk -F: <span class="string">'NR&gt;=3&amp;&amp;NR&lt;=6&#123;print NR, $1, $NF&#125;'</span> /etc/passwd</span><br><span class="line"><span class="number">3</span> daemon /sbin/nologin</span><br><span class="line"><span class="number">4</span> adm /sbin/nologin</span><br><span class="line"><span class="number">5</span> lp /sbin/nologin</span><br><span class="line"><span class="number">6</span> sync /bin/sync</span><br><span class="line"></span><br><span class="line"><span class="comment">#11 读取/etc/passwd文件的偶数行</span></span><br><span class="line">$ awk <span class="string">'&#123;if(NR%2) next; print NR, $0&#125;'</span> /etc/passwd</span><br><span class="line"><span class="number">2</span> bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line"><span class="number">4</span> adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"><span class="number">6</span> sync:x:<span class="number">5</span>:<span class="number">0</span>:sync:/sbin:/bin/sync</span><br><span class="line"><span class="number">8</span> halt:x:<span class="number">7</span>:<span class="number">0</span>:halt:/sbin:/sbin/halt</span><br><span class="line"><span class="number">10</span> operator:x:<span class="number">11</span>:<span class="number">0</span>:operator:/root:/sbin/nologin</span><br><span class="line"><span class="number">12</span> ftp:x:<span class="number">14</span>:<span class="number">50</span>:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line"><span class="number">14</span> dbus:x:<span class="number">81</span>:<span class="number">81</span>:System message bus:/:/sbin/nologin</span><br><span class="line"><span class="number">16</span> tss:x:<span class="number">59</span>:<span class="number">59</span>:<span class="number">1</span>:/dev/null:/sbin/nologin</span><br><span class="line"><span class="number">18</span> usbmuxd:x:<span class="number">113</span>:<span class="number">113</span>:usbmuxd user:/:/sbin/nologin</span><br><span class="line"><span class="number">20</span> libstoragemgmt:x:<span class="number">997</span>:<span class="number">995</span>:<span class="number">1</span>:/var/run/lsm:/sbin/nologin</span><br><span class="line"><span class="number">22</span> rpc:x:<span class="number">32</span>:<span class="number">32</span>:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin</span><br><span class="line"><span class="number">24</span> radvd:x:<span class="number">75</span>:<span class="number">75</span>:radvd user:/:/sbin/nologin</span><br><span class="line"><span class="number">26</span> nfsnobody:x:<span class="number">65534</span>:<span class="number">65534</span>:nfs:/var/lib/nfs:/sbin/nologin</span><br><span class="line"><span class="number">28</span> chrony:x:<span class="number">995</span>:<span class="number">994</span>::/var/lib/chrony:/sbin/nologin</span><br><span class="line"><span class="number">30</span> sssd:x:<span class="number">994</span>:<span class="number">993</span>:User <span class="keyword">for</span> sssd:/:/sbin/nologin</span><br><span class="line"><span class="number">32</span> unbound:x:<span class="number">993</span>:<span class="number">992</span>:b:/etc/unbound:/sbin/nologin</span><br><span class="line"><span class="number">34</span> gdm:x:<span class="number">42</span>:<span class="number">42</span>::/var/lib/gdm:/sbin/nologin</span><br><span class="line"><span class="number">36</span> postfix:x:<span class="number">89</span>:<span class="number">89</span>::/var/spool/postfix:/sbin/nologin</span><br><span class="line"><span class="number">38</span> avahi:x:<span class="number">70</span>:<span class="number">70</span>:s:/sbin/nologin</span><br><span class="line"><span class="number">40</span> kernel:x:<span class="number">1000</span>:<span class="number">1000</span>:kernel:/home/kernel:/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment">#12 测试自定义数组</span></span><br><span class="line">$ awk <span class="string">'BEGIN&#123;arr["mon"]="monday";arr["tue"]="tuesday";for(idx in arr)&#123;print arr[idx]&#125;&#125;'</span></span><br><span class="line">tuesday</span><br><span class="line">monday</span><br><span class="line"></span><br><span class="line"><span class="comment">#13 按最后一个字段统计</span></span><br><span class="line">netstat -tan | awk <span class="string">'/^tcp/&#123;state[$NF]++&#125;END&#123;for(idx in state)&#123;print idx,state[idx]&#125;&#125;'</span> | sort</span><br><span class="line">ESTABLISHED <span class="number">2</span></span><br><span class="line">LISTEN <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#14 统计某个IP的访问次数</span></span><br><span class="line">$ awk <span class="string">'&#123;ip[$1]++&#125;END&#123;for(idx in ip)&#123;print idx, ip[idx]&#125;&#125;'</span> /var/<span class="built_in">log</span>/httpd/access_<span class="built_in">log</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.102</span> <span class="number">67</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span> <span class="number">10000</span></span><br><span class="line"><span class="number">192.168</span>.<span class="number">1.160</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="sed"><a class="header-anchor" href="#sed"></a>Sed</h2>
<p><em>Sed Stream editor</em></p>
<p>sed和awk是用户、程序员和管理员应用的工具。之所以称为sed是因为它是一个流编辑器（stream editor），用于对许多文件执行一系列的编辑操作。awk是根据它的开发者Aho、Weinberger和Kernighan命名的。awk是一种编程语言，它可以使你很容易地处理结构化数据和生成格式化报告。</p>
<p>Sed的工作方式,一次从文件中读取一行到<code>pattern space</code>,然后判断这一行是不是我们需要编辑的行,如何符合条件则对其进行处理,</p>
<p>处理完之后把处理的结果输出到屏幕上.如果不符合要求也输出到屏幕上来(Sed的默认操作,称之为打印模式空间).</p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-13]]></title>
    <link href="http://molloc.me/2015/09/13/ZY-2015-09-13/"/>
    <id>http://molloc.me/2015/09/13/ZY-2015-09-13/</id>
    <published>2015-09-13T15:19:32.000Z</published>
    <updated>2015-09-20T16:33:30.416Z</updated>
    <content type="html"><![CDATA[<h2 id="shell"><a class="header-anchor" href="#shell"></a>Shell</h2>
<p>注意本文讨论的是Bash，而不一定是/bin/sh所链接的那个shell。这里出现的所有代码片段，默认在顶上都添加了<code>#!/bin/bash</code>。</p>
<p>计算机理解语言的 0 和 1 的称为二进制语言。</p>
<p>在早期的计算机时代，指令提供使用二进制语言，很难对我们所有人，读和写。所以在 Os 中是叫 Shell 的特别节目。壳 (大部分) 接受你的指令或命令在英语中的，如果它是一个有效的命令，它是传递给内核。</p>
<p>外壳是用户或程序是提供用户交互环境。Shell 是命令语言解释器执行命令从标准输入设备 (键盘) 或从文件读取。</p>
<p><code>Shell</code>不是系统内核的一部分，但使用系统内核执行程序、 创建文件等。</p>
<a id="more"></a>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-09-13/linux-system-call.png" alt="linux-system-call.png"></p>
<h2 id="进程"><a class="header-anchor" href="#进程"></a>进程</h2>
<ul>
<li>守护进程,服务进程: 启动,开机时自动启动.</li>
<li>交互式进程: shell应用程序</li>
</ul>
<h2 id="shell应用程序"><a class="header-anchor" href="#shell应用程序"></a>shell应用程序</h2>
<p><em>广义上分为: GUI,CLI</em></p>
<h3 id="cli"><a class="header-anchor" href="#cli"></a>CLI</h3>
<p><em>由<code>prompt(#|$) COMMAND options arguments</code> 组成, 在进行词法分析</em></p>
<p>命令有有内建命令,外部命令(PATH)之分.把一系列命令写在一个文件中,称为shell脚本.</p>
<p>脚本或程序源文件执行的两种方式:</p>
<ul>
<li>编译执行: 预处理 --&gt; 编译 --&gt; 链接; 事先完成,最终生成二进制文件.</li>
<li>解释执行: 有解释器全程参与运行过程, 每次读取一行, 运行一行.</li>
</ul>
<h2 id="程序"><a class="header-anchor" href="#程序"></a>程序</h2>
<ul>
<li>程序：指令+数据</li>
<li>过程式编程：以指令为中心，设计算法，数据服务于算法；</li>
<li>对象式编程：以数据为中心，设计数据结构(类)，程序服务于数据结构</li>
</ul>
<h3 id="python：编程库"><a class="header-anchor" href="#python：编程库"></a>Python：编程库</h3>
<ul>
<li>程序控制结构，调用编程库完成程序编写；</li>
<li>库文件：功能模块，在编程中可调用；通过其API；</li>
</ul>
<h3 id="bash：编程"><a class="header-anchor" href="#bash：编程"></a>Bash：编程</h3>
<ul>
<li>程序控制结构，调用机器上命令程序文件进行程序编写；</li>
<li>外部命令：各应用程序提供；</li>
</ul>
<h3 id="bash过程式编程"><a class="header-anchor" href="#bash过程式编程"></a>bash过程式编程</h3>
<ul>
<li>顺序执行：逐个执行</li>
<li>选择执行：只执行其中一个分支</li>
<li>循环执行：一段代码要执行0,1或多遍</li>
<li>编程元素：变量、流程、函数</li>
</ul>
<h2 id="shell基本语法"><a class="header-anchor" href="#shell基本语法"></a>Shell基本语法</h2>
<h3 id="变量"><a class="header-anchor" href="#变量"></a>变量</h3>
<ul>
<li>本地变量：当前shell进程；</li>
<li>环境变量：当前shell进程及其子进程；</li>
<li>局部变量：某个函数执行过程；</li>
<li>位置参数变量：在脚本中引用传递给脚本的参数；在函数中引用传递给函数的参数；</li>
<li>特殊变量：<code>$?, $*, $@, $#, $$</code></li>
</ul>
<h3 id="引用"><a class="header-anchor" href="#引用"></a>引用</h3>
<ul>
<li>弱引用: &quot;&quot;, 其内部的变量引用会被替换为变量值；</li>
<li>强引用：''，其变量的变量引用会保持原有字符；</li>
<li>命令引用：<code>COMMAND</code>, <code>$(COMMAND)</code>，引用命令的执行结果；</li>
</ul>
<h3 id="本地变量"><a class="header-anchor" href="#本地变量"></a>本地变量</h3>
<p>变量名：只能包含数字、字母和下划线；且不能以数字开头；
引用变量：${name}, $name</p>
<h3 id="声明"><a class="header-anchor" href="#声明"></a>声明</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -i name[=value]</span><br><span class="line"><span class="built_in">let</span> name=value</span><br></pre></td></tr></table></figure>
<p>查看所有变量<code>set</code>, 手动销毁变量<code>unset name</code></p>
<h3 id="环境变量"><a class="header-anchor" href="#环境变量"></a>环境变量</h3>
<p>被&quot;导出&quot;的本地变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> name[=value]</span><br><span class="line"><span class="built_in">declare</span> -x name[=value]</span><br></pre></td></tr></table></figure>
<p>查看所有环境变量<code>env, printenv, export</code>, 销毁<code>unset name</code></p>
<p>变量的类型作用: 存储空间, 运算, 存储格式;</p>
<p>Bash变量只有两种类型，字符串和数组。不过从严格意义上，Bash没有变量类型。Bash中的变量，在运行的时候会被展开成其对应的值（字符串）。你可以把它看做C/C++中的宏定义，或者一些模板语言中的占位符。</p>
<p>一般情况下，变量通过=赋值，注意=两边不要留空格。有些好孩子，已经养成了符号两端留空格的习惯，结果当开始写Bash的时候，他们抓狂了。</p>
<p>要想访问变量，只需在变量名前面添加<code>$</code>，解释器就会对它进行展开。如果该变量并不存在，解释器会把它展开成“”。</p>
<p>作为脚本语言，第一要义当然是要随时随地获取到命令行输入啦。</p>
<p>在Bash中，使用<code>$1</code>可以获取命令行输入的第一个参数，<code>$2</code>可以获取命令行输入的第2个参数，<code>$3</code>可以获取命令行输入的第......
你看，<code>$1</code>到<code>$10000</code>的用法就这么交代完了。Bash还是挺有逻辑的嘛。</p>
<p>顺便一提，<code>$0</code>获取的脚本的名字（其实就是其他语言中的第0个参数），<code>$@</code>获取所有的参数，<code>$#</code>获取参数的数目。记住<code>@</code>和<code>#</code>这两个符号，在Bash这一神秘的符文体系中，前者表示全部参数，后者表示参数的数目。</p>
<p>假如Bash变量中含有空白字符，或者含有特殊字符，比如<code>*</code>，展开后会污染到外面的字符串.所以需要加双引号括起来.</p>
<p>另外一种Bomb的可能是，变量后面需要接其它字符串，比如<code>$FRUITs</code>。如果想让解释器识别成<code>$FRUIT</code>变量，而不是<code>$FRUITs</code>，需要用花括号括起来，像<code>${FRUIT}s</code></p>
<p>Bash中可以使用两种容器。</p>
<p>一种是数组，另一种是关联数组，类似于其他语言中的<code>Map/Hash/Dict</code>。</p>
<ul>
<li>声明数组的常用语法： <code>declare -a ARY</code>或者<code>ARY=(1 2 3)</code></li>
<li>声明关联数组的唯一语法： <code>declare -A MAP</code></li>
</ul>
<p>赋值的语法：</p>
<ul>
<li>直接<code>ARY[N]=VALUE</code>，<code>N</code>可以是数字索引也可以是键。</li>
<li>关联数组可以使用<code>MAP=([x]=a [y]=b)</code>进行多项赋值。</li>
</ul>
<p>注意这是赋值的语句而不是声明。数组中的索引不一定要按顺序来，你可以先给2和3上的元素赋值。</p>
<p>往现有数组批量添加元素：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ARY+=(a b c)</span><br><span class="line">MAP+=([a]=<span class="number">1</span> [b]=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>取值：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;ARY[INDEX]&#125;</span></span><br><span class="line"><span class="variable">$&#123;MAP[KEY]&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="花括号的使用"><a class="header-anchor" href="#花括号的使用"></a>花括号的使用</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;A[@]&#125;</span>   		<span class="comment"># 展开成所有的变量，</span></span><br><span class="line"><span class="variable">$&#123;#A[@]&#125;</span>  		<span class="comment"># 而获取数组长度使用</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$&#123;ARY[@]:N:M&#125;</span> 	<span class="comment"># N是offset而M是length</span></span><br><span class="line"><span class="variable">$&#123;!MAP[@]&#125;</span> 		<span class="comment"># 返回索引，相当于keys()</span></span><br></pre></td></tr></table></figure>
<p>试试下面的代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> <span class="operator">-a</span> ARY</span><br><span class="line"><span class="built_in">declare</span> -A MAP</span><br><span class="line">MAP+=([a]=<span class="number">1</span> [b]=<span class="number">2</span>)</span><br><span class="line">ARY+=(a b c)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;ARY[1]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;MAP[a]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;ARY[@]&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;MAP[@]&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;ARY[@]:0:1&#125;</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#ARY[@]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;!MAP[@]&#125;</span>"</span></span><br><span class="line"></span><br><span class="line">ARY[<span class="number">4</span>]=a</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;ARY[@]&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;ARY[3]&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="变量-字符串-变换"><a class="header-anchor" href="#变量-字符串-变换"></a>变量（字符串）变换</h3>
<p>Bash中的变量变换，大体是${变量[操作符]}的形式</p>
<h3 id="大小写变换"><a class="header-anchor" href="#大小写变换"></a>大小写变换</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HI=HellO</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"<span class="variable">$HI</span>"</span> <span class="comment"># HellO</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI^&#125;</span> <span class="comment"># HellO</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI^^&#125;</span> <span class="comment"># HELLO</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI,&#125;</span> <span class="comment"># hellO</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI,,&#125;</span> <span class="comment"># hello</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI~&#125;</span> <span class="comment"># hellO</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;HI~~&#125;</span> <span class="comment">#hELLo</span></span><br></pre></td></tr></table></figure>
<p><code>^</code>大写，<code>,</code>小写， <code>~</code>大小写切换</p>
<p>重复一次只修改首字母，重复两次则应用于所有字母。</p>
<p>混着用会怎样？</p>
<p><code>echo ${HI^,^} # HellO</code></p>
<p>看来是不行的×_×</p>
<h3 id="移除匹配的字符串"><a class="header-anchor" href="#移除匹配的字符串"></a>移除匹配的字符串</h3>
<ul>
<li><code>%xx</code> 从后往前，开始匹配，移除匹配的内容</li>
<li><code>%%xx</code> 跟上面的差不多，不过这是贪婪匹配</li>
<li><code>#xx</code> 从前往后，开始匹配，移除匹配的内容</li>
<li><code>##xx</code> 跟上面的差不多，不过这是贪婪匹配</li>
</ul>
<p>这个比较难理解，不过看下面几个例子应该能明白了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FILENAME=/home/spacewander/param.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME%/*&#125;</span> <span class="comment"># /home/spacewander</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME%%/*&#125;</span> <span class="comment">#</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME#*/&#125;</span> <span class="comment"># home/spacewander/param.sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME##*/&#125;</span> <span class="comment"># param.sh</span></span><br></pre></td></tr></table></figure>
<h3 id="查找并替换"><a class="header-anchor" href="#查找并替换"></a>查找并替换</h3>
<ul>
<li><code>/MATCH/VALUE</code> 替换第一个匹配的内容。</li>
<li><code>//MATCH/VALUE</code> 替换匹配的内容</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME/home/office&#125;</span> <span class="comment"># /office/spacewander/param.sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;FILENAME//s/S&#125;</span> <span class="comment"># /home/Spacewander/param.Sh</span></span><br></pre></td></tr></table></figure>
<h3 id="其它字符串操作"><a class="header-anchor" href="#其它字符串操作"></a>其它字符串操作</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;#FILENAME&#125;</span> 		<span class="comment"># 获取变量（字符串）长度：</span></span><br><span class="line"><span class="variable">$&#123;STR:offset:len&#125;</span> 	<span class="comment"># 字符串切片：跟数组切片是同样的语法，</span></span><br><span class="line"></span><br><span class="line">TEXT=这个程序充满了BUG!</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;TEXT:0:8&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;TEXT:4&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 你还可以使用负数作为offset，这时候就是从后往前算起。注意负数要用括号括起来，避免冲突。</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;TEXT:(-4)&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="关于变量-其它的内容"><a class="header-anchor" href="#关于变量-其它的内容"></a>关于变量，其它的内容</h3>
<p>Bash中有一项特性，你可以方便地检查某个变量是否设置了，如果没有设置，就赋予一个默认值。尤其在处理环境变量的时候，这项特性会让你感到欣慰。</p>
<p>语法是<code>${VAR:=VALUE}</code>或者<code>${VAR:=VALUE}</code>。此外，还有一个相似的语法，<code>${VAR:=VALUE}</code>和<code>${VAR：=VALUE}</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 当变量未定义或者值为空时,返回值为word的内容,否则返回变量的值.</span></span><br><span class="line"><span class="variable">$&#123;value:-word&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 与前者类似,只是若变量未定义或者值为空时,在返回word的值的同时将word赋值给value</span></span><br><span class="line"><span class="variable">$&#123;value:=word&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 若变量已赋值的话,正常替换.否则将消息message送到标准错误输出(若此替换出现在Shell程序中,那么该程序将终止运行)</span></span><br><span class="line"><span class="variable">$&#123;value:?message&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 若变量已赋值的话,其值才用word替换,否则不进行任何替换</span></span><br><span class="line"><span class="variable">$&#123;value:+word&#125;</span></span><br></pre></td></tr></table></figure>
<p>下面展示下两者的区别</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># expand to default variable</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;NULL-"Not null"&#125;</span> <span class="comment"># Not null</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;NULL&#125;</span> <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set default variable</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;NIL="Not nil"&#125;</span> <span class="comment"># Not nil</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;NIL&#125;</span> <span class="comment"># Not nil</span></span><br></pre></td></tr></table></figure>
<p>可以看出，前者只是当变量不存在时，展开成指定的值。而后者在变量不存在时，将变量的值设置为指定值。</p>
<p>最后介绍一个，当目标变量不存在时，指定报错信息的语法。</p>
<p><code>echo ${TARGET?Not Found}</code> 当<code>$TARGET</code>不存在时，显示<code>TARGET: Not Found</code>，并结束程序。</p>
<hr>
<h2 id="脚本"><a class="header-anchor" href="#脚本"></a>脚本</h2>
<p>运行脚本：事实上是运行一个bash进程，此进程负责从脚本文件中读取一个执行逻辑，而后由bash进程负责解析并运行此逻辑。</p>
<h3 id="启动脚本"><a class="header-anchor" href="#启动脚本"></a>启动脚本</h3>
<ul>
<li><code>bash /PATH/TO/SCRIPT_FILE</code></li>
<li>一个执行权限，<code>./PATH/TO/SCRIPT_FILE</code></li>
</ul>
<h3 id="bash的常用选项"><a class="header-anchor" href="#bash的常用选项"></a>bash的常用选项</h3>
<ul>
<li><code>-n</code> 检查脚本中的语法错误。</li>
<li><code>-x</code> 调试执行脚本。</li>
</ul>
<h3 id="命令的状态结果"><a class="header-anchor" href="#命令的状态结果"></a>命令的状态结果</h3>
<p>bash进程用于追踪执行的命令成功与否的状态：</p>
<ul>
<li><code>0</code> 成功。</li>
<li><code>1-255</code> 失败。</li>
<li>特殊变量<code>$?</code>，上一条命令的执行状态结果。</li>
<li>自定义脚本的状态结果<code>exit [n]</code>。</li>
</ul>
<h3 id="条件测试"><a class="header-anchor" href="#条件测试"></a>条件测试</h3>
<p>界定程序执行环境</p>
<ul>
<li>根据运行命令的状态结果。</li>
<li>测试表达式<code>test EXPRESSION</code>,<code>[ EXPRESSION ]</code>,<code>[[ EXPRESSION ]]</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 整数测试：隐含着做数值大小比较，所以不要给变量引用加引用；</span></span><br><span class="line"><span class="variable">$A</span> <span class="operator">-gt</span> <span class="variable">$B</span> <span class="comment"># 大于</span></span><br><span class="line"><span class="variable">$A</span> -ge <span class="variable">$B</span> <span class="comment"># 大于等于</span></span><br><span class="line"><span class="variable">$A</span> <span class="operator">-lt</span> <span class="variable">$B</span> <span class="comment"># 小于</span></span><br><span class="line"><span class="variable">$A</span> -le <span class="variable">$B</span> <span class="comment"># 小于等于</span></span><br><span class="line"><span class="variable">$A</span> <span class="operator">-eq</span> <span class="variable">$B</span> <span class="comment"># 等于</span></span><br><span class="line"><span class="variable">$A</span> <span class="operator">-ne</span> <span class="variable">$B</span> <span class="comment"># 不等于</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 字符串测试：ASCII数值越大，字符比较时其值越大；</span></span><br><span class="line"><span class="string">"<span class="variable">$A</span>"</span> &gt; <span class="string">"<span class="variable">$B</span>"</span>  	<span class="comment"># 大于</span></span><br><span class="line"><span class="string">"<span class="variable">$A</span>"</span> &lt; <span class="string">"<span class="variable">$B</span>"</span>  	<span class="comment"># 小于</span></span><br><span class="line"><span class="string">"<span class="variable">$A</span>"</span> == <span class="string">"<span class="variable">$B</span>"</span> 	<span class="comment"># 等于</span></span><br><span class="line"><span class="string">"<span class="variable">$A</span>"</span> != <span class="string">"<span class="variable">$B</span>"</span>  	<span class="comment"># 不等于</span></span><br><span class="line">-z <span class="string">"<span class="variable">$B</span>"</span>  		<span class="comment"># 为空</span></span><br><span class="line">-n <span class="string">"<span class="variable">$B</span>"</span>  		<span class="comment"># 不为空</span></span><br><span class="line"><span class="comment"># 注意, 用[]的时候&lt;,&gt;需要转义为\&lt;,\&gt;,用[[EXPRESSION]]的时候不需要转义,建议使用[[]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 文件测试：测试文件的存在性以及属性；</span></span><br><span class="line"><span class="string">"-a <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在</span></span><br><span class="line"><span class="string">"-b <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为块设备文件</span></span><br><span class="line"><span class="string">"-c <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为字符设备文件</span></span><br><span class="line"><span class="string">"-d <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为目录</span></span><br><span class="line"><span class="string">"-e <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在</span></span><br><span class="line"><span class="string">"-f <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为普通文件</span></span><br><span class="line"><span class="string">"-g <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且有SGID权限</span></span><br><span class="line"><span class="string">"-h <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为符号链接文件</span></span><br><span class="line"><span class="string">"-k <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且具有Sticky bit权限</span></span><br><span class="line"><span class="string">"-p <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为管道文件</span></span><br><span class="line"><span class="string">"-r <span class="variable">$file</span>"</span>		<span class="comment"># 当前用户对文件是否拥有读权限</span></span><br><span class="line"><span class="string">"-s <span class="variable">$file</span>"</span>		<span class="comment"># 检测文件名是否存在且为非空白文件(filesize &gt; 0)</span></span><br><span class="line"><span class="string">"-t <span class="variable">$file</span>"</span>		<span class="comment"># <span class="doctag"><span class="keyword">TODO</span></span></span></span><br><span class="line"><span class="string">"-u <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且具有SUID权限</span></span><br><span class="line"><span class="string">"-w <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且具有可写权限</span></span><br><span class="line"><span class="string">"-x <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且具有执行权限</span></span><br><span class="line"><span class="string">"-G <span class="variable">$file</span>"</span>		<span class="comment"># 当前用户是否为指定文件的属组</span></span><br><span class="line"><span class="string">"-L <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为符号链接文件</span></span><br><span class="line"><span class="string">"-O <span class="variable">$file</span>"</span>		<span class="comment"># 当前用户是否为指定文件的属主</span></span><br><span class="line"><span class="string">"-S <span class="variable">$file</span>"</span>		<span class="comment"># 是否存在且为套接字文件</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file1</span> -nt <span class="variable">$file2</span> <span class="comment"># file1是否新于file2, file1的最近一次的修改时间戳是否晚于file2的；</span></span><br><span class="line"><span class="variable">$file1</span> -ot <span class="variable">$file2</span> <span class="comment"># file1是否旧于file2, file1的最近一次的修改时间戳是否早于file2的；</span></span><br><span class="line"><span class="variable">$file1</span> -ef <span class="variable">$file2</span> <span class="comment"># file1与file2是否指向了同一个inode；测试二者是否为同一个文件的硬链接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 模式匹配测试</span></span><br><span class="line">[[ <span class="string">"STRING"</span> =~ PATTERN ]] <span class="comment"># 模式匹配测试：</span></span><br></pre></td></tr></table></figure>
<h3 id="组合测试条件"><a class="header-anchor" href="#组合测试条件"></a>组合测试条件</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 表达式组合</span></span><br><span class="line">[[ CONDITION1 <span class="operator">-a</span> CONDITION2 ]] <span class="comment"># 与</span></span><br><span class="line">[[ CONDITION1 -o CONDITION2 ]] <span class="comment"># 或</span></span><br><span class="line">[ ! CONDITION ]   			   <span class="comment"># 取反</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 命令组合</span></span><br><span class="line">COMMAND1 &amp;&amp; COMMAND2  &lt;-- [ EXPR1 ] &amp;&amp; [ EXPR2 ]</span><br><span class="line">COMMAND1 || COMMAND2</span><br><span class="line">! COMMAND</span><br></pre></td></tr></table></figure>
<h3 id="短路操作符"><a class="header-anchor" href="#短路操作符"></a>短路操作符<code>&amp;&amp;</code>,<code>||</code></h3>
<h3 id="特殊设备"><a class="header-anchor" href="#特殊设备"></a>特殊设备</h3>
<ul>
<li><code>/dev/null</code> 空，bit buckets，吞下所有数据，并直接丢弃</li>
<li><code>/dev/zero</code> 吐出一堆0</li>
</ul>
<h3 id="条件判断"><a class="header-anchor" href="#条件判断"></a>条件判断</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax</span></span><br><span class="line"><span class="comment">#1 if/then, cash</span></span><br><span class="line"><span class="keyword">if</span> CONDITION; <span class="keyword">then</span></span><br><span class="line">	<span class="comment">#Do Something.</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> CONDITION; <span class="keyword">then</span></span><br><span class="line">	<span class="comment">#Do Something.</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment">#Do Something.</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> CONDITION1; <span class="keyword">then</span></span><br><span class="line">	<span class="comment"># if-CONDITION1-true-分支</span></span><br><span class="line"><span class="keyword">elif</span> CONDITION2; <span class="keyword">then</span></span><br><span class="line">	<span class="comment"># if-CONDITION2-true-分支</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment"># if-ALL-false-分支</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 循环 for, while, until</span></span><br><span class="line"><span class="keyword">for</span> VARIABLE <span class="keyword">in</span> LIST; <span class="keyword">do</span></span><br><span class="line">	<span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LIST：是由一个或多个空格或换行符分隔开的字符串组成；</span></span><br><span class="line"><span class="comment"># 把列表的每个字符串逐个赋值给VARIABLE表示的变量</span></span><br><span class="line"><span class="comment"># LIST的生成方法</span></span><br><span class="line"><span class="comment"># (1) 整数列表</span></span><br><span class="line"><span class="comment"># 	(a) &#123;start..end&#125;</span></span><br><span class="line"><span class="comment"># 	(b) $(seq [start [[step]] end)</span></span><br><span class="line"><span class="comment"># (2) 直接给出列表</span></span><br><span class="line"><span class="comment"># (3) glob</span></span><br><span class="line"><span class="comment"># (4) 命令生成</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 case 语句</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$VARIABLE</span> <span class="keyword">in</span></span><br><span class="line">	PATTERN_1)</span><br><span class="line">		<span class="comment"># branch_1</span></span><br><span class="line">		;;</span><br><span class="line">	PATTERN_2)</span><br><span class="line">		<span class="comment"># branch_2</span></span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="comment"># default branch</span></span><br><span class="line">		;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 流程控制语句while, until</span></span><br><span class="line"><span class="keyword">while</span> CONDITION; <span class="keyword">do</span></span><br><span class="line">	<span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5 until循环,退出条件,CONDITION为真时退出</span></span><br><span class="line">until CONDITION; <span class="keyword">do</span></span><br><span class="line">	<span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#6 循环控制</span></span><br><span class="line"><span class="built_in">continue</span> [n] <span class="comment"># 提前结束本轮循环,而直接进入下一轮</span></span><br><span class="line"><span class="built_in">break</span> [n] 	 <span class="comment"># 提前结束循环</span></span><br></pre></td></tr></table></figure>
<h3 id="case中的pattern可以使用glob模式的通配符"><a class="header-anchor" href="#case中的pattern可以使用glob模式的通配符"></a><code>case中</code>的<code>PATTERN</code>可以使用<code>glob</code>模式的通配符</h3>
<ul>
<li><code>*</code>: 任意长度的任意字符；</li>
<li><code>?</code>: 任意单个字符；</li>
<li><code>[]</code>: 指定范围内的任意单个字符；</li>
<li><code>a|b</code>: 多选1；</li>
</ul>
<h3 id="while-循环的特殊用法-遍历文件的每一行"><a class="header-anchor" href="#while-循环的特殊用法-遍历文件的每一行"></a>while 循环的特殊用法,遍历文件的每一行</h3>
<ul>
<li>expr1: 定义控制变量，并初始赋值</li>
<li>expr2: 循环控制条件</li>
<li>expr3: 修正控制变量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">	<span class="comment"># 处理每一行内容</span></span><br><span class="line"><span class="keyword">done</span> &lt; /PATH/TO/SOMEFILE</span><br></pre></td></tr></table></figure>
<h3 id="for循环的特殊用法"><a class="header-anchor" href="#for循环的特殊用法"></a>for循环的特殊用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ((expr1;expr2;expr3)); <span class="keyword">do</span></span><br><span class="line">	<span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="脚本参数-位置参数变量"><a class="header-anchor" href="#脚本参数-位置参数变量"></a>脚本参数(位置参数变量)</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./script.sh /etc/fstab /etc/grb.cfg</span></span><br><span class="line"><span class="comment"># 	$0 			$1 			$2</span></span><br></pre></td></tr></table></figure>
<h3 id="与用户交互"><a class="header-anchor" href="#与用户交互"></a>与用户交互</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># read</span></span><br><span class="line">$ <span class="built_in">read</span> [options] VAR ...</span><br><span class="line">		-P <span class="string">"PROMPT"</span></span><br><span class="line">		-t timeout</span><br></pre></td></tr></table></figure>
<h3 id="特殊变量"><a class="header-anchor" href="#特殊变量"></a>特殊变量</h3>
<ul>
<li><code>$?</code> 命令的状态结果；</li>
<li><code>$#</code> 传递给脚本或函数的参数的个数；</li>
<li><code>$*</code> 引用传递给脚本或函数的参数列表；受IFS控制</li>
<li><code>$@</code> 引用传递给脚本或函数的参数列表；不受IFS控制</li>
</ul>
<p>注：IFS:IFS(Internal Field Seperator)在Linux的shell中预设的分隔符，用来把command line分解成word（字段）。IFS可以是White Space（空白键）、Tab（ 表格键）、Enter（ 回车键）中的一个或几个。</p>
<p><code>shift [n]</code>：轮替</p>
<h3 id="算术运算"><a class="header-anchor" href="#算术运算"></a>算术运算</h3>
<ul>
<li><code>$[$A+$B]</code></li>
<li><code>$(($A+$B))</code></li>
<li><code>let VARIABLE=$A+$B</code></li>
<li><code>VARIABLE=$(expr $A + $B)</code></li>
</ul>
<h3 id="增强型赋值"><a class="header-anchor" href="#增强型赋值"></a>增强型赋值</h3>
<ul>
<li><code>let count=$[$count+1]</code> --&gt; <code>let count+=1</code> --&gt; <code>let count++</code></li>
<li><code>let count=$[$count-1]</code> --&gt; <code>let count-=1</code> --&gt; <code>let count--</code></li>
</ul>
<h3 id="函数"><a class="header-anchor" href="#函数"></a>函数</h3>
<p>把一段具有独立功能代码封装在一起，并给予命名；后续用到时，可直接通过给定函数名来调用整体代码.函数的作用(1)代码重用.(2)模块化编程.</p>
<p>自定义函数的状态的返回值<code>return [n]</code> 0:成功, 1-255: 失败.</p>
<h3 id="定义函数的二种格式"><a class="header-anchor" href="#定义函数的二种格式"></a>定义函数的二种格式</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># first</span></span><br><span class="line"><span class="keyword">function</span> f_name &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># second</span></span><br><span class="line"><span class="function"><span class="title">f_name</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数 : f_name [arg1, arg2, arg3, ...]</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="实践"><a class="header-anchor" href="#实践"></a>实践</h2>
<h3 id="1-如果某路径不存在-则将其创建为目录；否则显示其存在-并显示内容类型"><a class="header-anchor" href="#1-如果某路径不存在-则将其创建为目录；否则显示其存在-并显示内容类型"></a>(1) 如果某路径不存在，则将其创建为目录；否则显示其存在，并显示内容类型</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename create_file.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line">filename=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$filename</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"<span class="variable">$filename</span> exists. "</span> &amp;&amp; file <span class="variable">$filename</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	/usr/bin/mkdir -p <span class="variable">$filename</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"<span class="variable">$filename</span> creation done."</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="2-写一个脚本-判断给定的两个数值-孰大孰小；给定数值的方法：脚本参数-命令交互"><a class="header-anchor" href="#2-写一个脚本-判断给定的两个数值-孰大孰小；给定数值的方法：脚本参数-命令交互"></a>(2) 写一个脚本，判断给定的两个数值，孰大孰小；给定数值的方法：脚本参数，命令交互</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: integer_compare.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"Plz enter two integer: "</span> -t <span class="number">10</span> n1 n2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ (-z <span class="string">"<span class="variable">$n1</span>"</span>) || (-z <span class="string">"<span class="variable">$n2</span>"</span>) ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Plz give two integers."</span></span><br><span class="line">    <span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$n1</span> -ge <span class="variable">$n2</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Max: <span class="variable">$n1</span>, Min: <span class="variable">$n2</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Max: <span class="variable">$n2</span>, Min: <span class="variable">$n1</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="3-for循环中list取值测试"><a class="header-anchor" href="#3-for循环中list取值测试"></a>(3) for循环中LIST取值测试</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: generate_list_to_for_loop.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># list with &#123;1..10&#125;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">10</span>&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">"%-2sx%-2s=%-.2f\n"</span> <span class="variable">$i</span> <span class="variable">$i</span> $((<span class="variable">$i</span>*<span class="variable">$i</span>))</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># list with glob</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> /var/<span class="built_in">log</span>/httpd/*; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">"%-20s%-20s\n"</span> <span class="string">"FILENAME"</span> <span class="string">"FILETYPE"</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">"%-20s%-20s\n"</span> $(basename <span class="variable">$filename</span>) $(file <span class="variable">$filename</span>)</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># list with command result</span></span><br><span class="line"><span class="keyword">for</span> username <span class="keyword">in</span> $(cut <span class="operator">-d</span>: <span class="operator">-f</span>1 /etc/passwd | tail -n <span class="number">5</span>); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$username</span> primary group: <span class="variable">$(id -n -g $username)</span>."</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="4-求100以内所有偶数之和；使用至少三种方法实现"><a class="header-anchor" href="#4-求100以内所有偶数之和；使用至少三种方法实现"></a>(4) 求100以内所有偶数之和；使用至少三种方法实现</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: even_sum.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">declare</span> -i sum_v1=<span class="number">0</span></span><br><span class="line"><span class="built_in">declare</span> -i sum_v2=<span class="number">0</span></span><br><span class="line"><span class="built_in">declare</span> -i sum_v3=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"----------------------v1--------------------"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(seq <span class="number">0</span> <span class="number">2</span> <span class="number">100</span>); <span class="keyword">do</span></span><br><span class="line">    sum_v1+=<span class="variable">$i</span>;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Even Sum_v1: <span class="variable">$sum_v1</span>."</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"----------------------v2--------------------"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">100</span>&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ $((<span class="variable">$i</span>%<span class="number">2</span>)) <span class="operator">-eq</span> <span class="number">0</span> ]; <span class="keyword">then</span></span><br><span class="line">        sum_v2+=<span class="variable">$i</span>;</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Even Sum_v2: <span class="variable">$sum_v2</span>."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"----------------------v3--------------------"</span></span><br><span class="line"><span class="built_in">declare</span> -i i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$i</span> <span class="operator">-gt</span> <span class="number">100</span> ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Even Sum_v3: <span class="variable">$sum_v3</span>."</span></span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        sum_v3+=<span class="variable">$i</span>;</span><br><span class="line">        i+=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="5-写一个脚本实现如下功能；获取当前主机的主机名；如果当前主机的主机名为空-或者为localhost-则将其修改为www-molloc-com"><a class="header-anchor" href="#5-写一个脚本实现如下功能；获取当前主机的主机名；如果当前主机的主机名为空-或者为localhost-则将其修改为www-molloc-com"></a>(5) 写一个脚本实现如下功能；获取当前主机的主机名；如果当前主机的主机名为空，或者为localhost，则将其修改为www.molloc.com</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: modify_hostname.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">hostname=$(hostname)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -z <span class="string">"<span class="variable">$hostname</span>"</span> || <span class="string">"<span class="variable">$hostname</span>"</span> =~ <span class="string">"localhost"</span> ]]; <span class="keyword">then</span></span><br><span class="line">    /usr/bin/hostname www.molloc.com</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="6-写一个脚本"><a class="header-anchor" href="#6-写一个脚本"></a>(6) 写一个脚本</h3>
<ul>
<li>传递两个文本文件路径给脚本；</li>
<li>显示两个文件中空白行数较多的文件及其空白行的个数；</li>
<li>显示两个文件中总行数较多的文件及其总行数；</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: count_blank_lines.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"Plz Enter two filename: "</span> -t <span class="number">10</span> f1 f2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-e</span> <span class="string">"<span class="variable">$f1</span>"</span> <span class="operator">-a</span> <span class="operator">-e</span> <span class="string">"<span class="variable">$f2</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">    line_f1=$(egrep <span class="string">'^$'</span> -c <span class="variable">$f1</span>)</span><br><span class="line">    line_f2=$(egrep <span class="string">'^$'</span> -c <span class="variable">$f2</span>)</span><br><span class="line">    [ <span class="variable">$line_f1</span> <span class="operator">-gt</span> <span class="variable">$line_f2</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">"File: <span class="variable">$f1</span>, blank lines: <span class="variable">$line_f1</span>"</span> || <span class="built_in">echo</span> <span class="string">"File: <span class="variable">$f2</span>, blank lines: <span class="variable">$line_f2</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"No such file for input."</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="7-写一个脚本"><a class="header-anchor" href="#7-写一个脚本"></a>(7) 写一个脚本</h3>
<ul>
<li>提示用户输入一个字符串；</li>
<li>判断：如果输入的是quit，则退出脚本;否则，则显示其输入的字符串内容</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: echo_str.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"Plz enter a string or enter 'quit' exit : "</span> -t <span class="number">10</span> str</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="keyword">if</span> [[ <span class="string">"quit"</span> == <span class="variable">$str</span> ]]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Buy~"</span> &amp;&amp; <span class="built_in">exit</span> <span class="number">0</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$str</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="7-写一个脚本-打印九九乘法表"><a class="header-anchor" href="#7-写一个脚本-打印九九乘法表"></a>(7) 写一个脚本,打印九九乘法表</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: multiply.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1</span>..<span class="number">9</span>&#125;; <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> $(seq <span class="number">1</span> <span class="variable">$i</span>); <span class="keyword">do</span></span><br><span class="line">		<span class="built_in">echo</span> -n <span class="operator">-e</span> <span class="string">"<span class="variable">$&#123;j&#125;</span>x<span class="variable">$&#123;i&#125;</span>=<span class="variable">$(($i*$j)</span>)\t"</span></span><br><span class="line">	<span class="keyword">done</span></span><br><span class="line">	<span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"------------------------------------V2-------------------------------"</span></span><br><span class="line">seq <span class="number">9</span> | sed <span class="string">'H;g'</span> | awk -v RS=<span class="string">''</span> <span class="string">'&#123;for(i=1;i&lt;=NF;i++)printf("%dx%d=%d%s", i, NR, i*NR, i==NR?"\n":"\t")&#125;'</span></span><br></pre></td></tr></table></figure>
<h3 id="8-脚本可接受四个参数"><a class="header-anchor" href="#8-脚本可接受四个参数"></a>(8)脚本可接受四个参数</h3>
<ul>
<li><code>start</code>: 创建文件/var/lock/subsys/SCRIPT_NAME</li>
<li><code>stop</code>: 删除此文件</li>
<li><code>restart</code>: 删除此文件并重新创建</li>
<li><code>status</code>: 如果文件存在，显示为&quot;running&quot;，否则，显示为&quot;stopped&quot;</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: run_script.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">command</span>_name=$(basename <span class="variable">$0</span>)</span><br><span class="line">lock_file=<span class="string">"/var/lock/subsys/<span class="variable">$command_name</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> <span class="operator">-lt</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$command_name</span> start|stop|restart|status"</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$1</span>"</span> == <span class="string">"start"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is started yet."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$command_name</span> ok..."</span> || <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$command_name</span> failed..."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">"<span class="variable">$1</span>"</span> == <span class="string">"stop"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$command_name</span> ok..."</span> || <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$command_name</span> failed..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is stopped yet."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">"<span class="variable">$1</span>"</span> == <span class="string">"restart"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Restarting <span class="variable">$command_name</span> ok..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is stopped, Starging <span class="variable">$command_name</span> ok..."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">"<span class="variable">$1</span>"</span> == <span class="string">"status"</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is running..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is stopped..."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$command_name</span> start|stop|restart|status"</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="9-上一个例子的case版本"><a class="header-anchor" href="#9-上一个例子的case版本"></a>(9) 上一个例子的<code>case</code>版本</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: case_run_script.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">command</span>_name=$(basename <span class="variable">$0</span>)</span><br><span class="line">lock_file=<span class="string">"/var/lock/subsys/<span class="variable">$command_name</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$#</span>"</span> <span class="operator">-lt</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$command_name</span> start|stop|restart|status."</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">	start)</span><br><span class="line">		<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">			<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is started yet."</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$command_name</span> ok..."</span> || <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$command_name</span> failed..."</span></span><br><span class="line">		<span class="keyword">fi</span></span><br><span class="line">		;;</span><br><span class="line">	stop)</span><br><span class="line">		<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">			rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$command_name</span> ok...."</span> || <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$command_name</span> failed..."</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is Stopped yet."</span></span><br><span class="line">		<span class="keyword">fi</span></span><br><span class="line">		;;</span><br><span class="line">	restart)</span><br><span class="line">		<span class="keyword">if</span> [ <span class="operator">-f</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">			rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Restarting <span class="variable">$command_name</span> ok..."</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"<span class="variable">$command_name</span> is stopped, Starting <span class="variable">$command_name</span> ok...."</span></span><br><span class="line">		<span class="keyword">fi</span></span><br><span class="line">		;;</span><br><span class="line">	status)</span><br><span class="line">		[ <span class="operator">-e</span> <span class="variable">$lock_file</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">"Running..."</span> || <span class="built_in">echo</span> <span class="string">"Stopped..."</span></span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$command_name</span> start|stop|restart|status."</span></span><br><span class="line">		<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h3 id="9-分别求100以内所有奇数之和-及所有偶数之和"><a class="header-anchor" href="#9-分别求100以内所有奇数之和-及所有偶数之和"></a>(9) 分别求100以内所有奇数之和，及所有偶数之和</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: sum.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">declare</span> -i even_sum=<span class="number">0</span></span><br><span class="line"><span class="built_in">declare</span> -i odd_sum=<span class="number">0</span></span><br><span class="line"><span class="built_in">declare</span> -i i=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$i</span> -le <span class="number">100</span> ]; <span class="keyword">do</span></span><br><span class="line">	<span class="keyword">if</span> [ $[<span class="variable">$i</span>%<span class="number">2</span>] <span class="operator">-eq</span> <span class="number">0</span> ]; <span class="keyword">then</span></span><br><span class="line">		 even_sum+=<span class="variable">$i</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		 odd_sum+=<span class="variable">$i</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">	<span class="built_in">let</span>	i++</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Even Sum : <span class="variable">$&#123;even_sum&#125;</span>, Odd Sum : <span class="variable">$&#123;odd_sum&#125;</span>."</span></span><br></pre></td></tr></table></figure>
<h3 id="10-求100以内所有正整数之和-用until语法"><a class="header-anchor" href="#10-求100以内所有正整数之和-用until语法"></a>(10) 求100以内所有正整数之和,用until语法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: until_sum.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">declare</span> -i i=<span class="number">0</span></span><br><span class="line"><span class="built_in">declare</span> -i sum=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">until [ <span class="variable">$i</span> <span class="operator">-gt</span> <span class="number">100</span> ]; <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">let</span> sum+=<span class="variable">$i</span></span><br><span class="line">	<span class="built_in">let</span> i++</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Sum : <span class="variable">$&#123;sum&#125;</span>."</span></span><br></pre></td></tr></table></figure>
<h3 id="11-找出uid为偶数的所有用户-显示其用户名和id号"><a class="header-anchor" href="#11-找出uid为偶数的所有用户-显示其用户名和id号"></a>(11) 找出UID为偶数的所有用户，显示其用户名和ID号</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: process_line_use_while.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">	uid=$(<span class="built_in">echo</span> <span class="variable">$line</span> | cut <span class="operator">-d</span>: <span class="operator">-f</span>3)</span><br><span class="line">	<span class="keyword">if</span> [ $[<span class="variable">$uid</span>%<span class="number">2</span>] <span class="operator">-eq</span> <span class="number">0</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="variable">$line</span> | cut <span class="operator">-d</span>: <span class="operator">-f</span>1,<span class="number">3</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span> &lt; /etc/passwd</span><br></pre></td></tr></table></figure>
<h3 id="12-求100以内所有正整数之和-使用for循环的特殊用法实现"><a class="header-anchor" href="#12-求100以内所有正整数之和-使用for循环的特殊用法实现"></a>(12) 求100以内所有正整数之和,使用for循环的特殊用法实现</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: for_sum.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">declare</span> -i sum=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">0</span>;i&lt;=<span class="number">100</span>;i++)); <span class="keyword">do</span></span><br><span class="line">	sum+=<span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Sum : <span class="variable">$&#123;sum&#125;</span>."</span></span><br></pre></td></tr></table></figure>
<h3 id="13-传递一个文本文件为参数给脚本-取出此文件的所有的偶数行给予显示-行前要显示行号"><a class="header-anchor" href="#13-传递一个文本文件为参数给脚本-取出此文件的所有的偶数行给予显示-行前要显示行号"></a>(13) 传递一个文本文件为参数给脚本，取出此文件的所有的偶数行给予显示，行前要显示行号</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: process_text_use_awk.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> <span class="operator">-lt</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Must take a parameter."</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$1</span> ]; <span class="keyword">then</span></span><br><span class="line">	awk <span class="string">'&#123;if(NR%2==0)&#123;print NR, $0&#125;&#125;'</span> <span class="variable">$1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"No such file for <span class="variable">$1</span>."</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h3 id="14-用函数重构示例9"><a class="header-anchor" href="#14-用函数重构示例9"></a>(14) 用函数重构示例9</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: func_server.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">server_name=$(basename <span class="variable">$0</span>)</span><br><span class="line">lock_file=<span class="string">"/var/lock/subsys/<span class="variable">$server_name</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> <span class="operator">-lt</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$prog</span> start|stop|restart|status"</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$server_name</span> is started yet."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$server_name</span> ok..."</span> || <span class="built_in">echo</span> <span class="string">"Starting <span class="variable">$server_name</span> failed."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$server_name</span> ok..."</span> || <span class="built_in">echo</span> <span class="string">"Stop <span class="variable">$server_name</span> failed..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"<span class="variable">$server_name</span> is stopped yet."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">restart</span></span>() &#123;</span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		rm <span class="operator">-f</span> <span class="variable">$lock_file</span> &amp;&amp; touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"Restarting <span class="variable">$server_name</span> ok..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		touch <span class="variable">$lock_file</span> &amp;&amp; <span class="built_in">echo</span> <span class="string">"<span class="variable">$server_name</span> is stopped, Staring <span class="variable">$server_name</span> ok..."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">status</span></span>() &#123;</span><br><span class="line">	<span class="keyword">if</span> [ <span class="operator">-e</span> <span class="variable">$lock_file</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Running..."</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Stopped..."</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">	start)</span><br><span class="line">		start</span><br><span class="line">		;;</span><br><span class="line">	stop)</span><br><span class="line">		stop</span><br><span class="line">		;;</span><br><span class="line">	restart)</span><br><span class="line">		restart</span><br><span class="line">		;;</span><br><span class="line">	status)</span><br><span class="line">		status</span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$prog</span> start|stop|restart|status"</span></span><br><span class="line">		<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h3 id="15-写一个脚本-打印2-n表；n等于一个用户输入的值"><a class="header-anchor" href="#15-写一个脚本-打印2-n表；n等于一个用户输入的值"></a>(15) 写一个脚本，打印2^n表；n等于一个用户输入的值</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: func_power.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> <span class="operator">-lt</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Plz Enter a Integer[1-9]: "</span></span><br><span class="line">	<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">power</span></span>() &#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"2^<span class="variable">$1</span>=$[2**<span class="variable">$1</span>]"</span></span><br><span class="line">	[ <span class="variable">$1</span> <span class="operator">-eq</span> <span class="number">1</span> ] &amp;&amp; <span class="built_in">exit</span> <span class="number">0</span> || power $[<span class="variable">$1</span>-<span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">	[<span class="number">1</span>-<span class="number">9</span>][<span class="number">0</span>-<span class="number">9</span>]*)</span><br><span class="line">		power <span class="variable">$1</span></span><br><span class="line">		;;</span><br><span class="line">	*)</span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"Invalid arguments [<span class="variable">$1</span>]. the arguments must be a integer."</span></span><br><span class="line">		<span class="built_in">exit</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h3 id="16-写一个脚本-写这么几个函数：函数1-实现给定的两个数值的之和；函数2-取给定两个数值的最大公约数；函数3-取给定两个数值的最小公倍数；关于函数的选定-两个数值的大小都将通过交互式输入来提供"><a class="header-anchor" href="#16-写一个脚本-写这么几个函数：函数1-实现给定的两个数值的之和；函数2-取给定两个数值的最大公约数；函数3-取给定两个数值的最小公倍数；关于函数的选定-两个数值的大小都将通过交互式输入来提供"></a>(16) 写一个脚本，写这么几个函数：函数1、实现给定的两个数值的之和；函数2、取给定两个数值的最大公约数；函数3、取给定两个数值的最小公倍数；关于函数的选定、两个数值的大小都将通过交互式输入来提供。</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># filename: func_math.sh</span></span><br><span class="line"><span class="comment"># author: kernel</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"Plz Enter Two Integers: "</span> -t <span class="number">10</span> n1 n2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">sum</span></span>() &#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Sum : $[<span class="variable">$1</span>+<span class="variable">$2</span>]"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">highest_common_factor</span></span>() &#123;</span><br><span class="line">	reminder=$[<span class="variable">$1</span>%<span class="variable">$2</span>]</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$reminder</span> <span class="operator">-eq</span> <span class="number">0</span> ]; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">return</span> <span class="string">"<span class="variable">$2</span>"</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		highest_common_factor <span class="variable">$2</span> <span class="variable">$reminder</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">least_common_multiply</span></span>()&#123;</span><br><span class="line">	highest_common_factor <span class="variable">$1</span> <span class="variable">$2</span></span><br><span class="line">	<span class="built_in">return</span> $(<span class="built_in">echo</span> <span class="string">"$[<span class="variable">$1</span>*<span class="variable">$2</span>]/$?"</span> | bc)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$n1</span>=~<span class="string">"[1-9][0-9]*"</span> <span class="operator">-a</span> <span class="variable">$n2</span>=~<span class="string">"[1-9][0-9]*"</span> ]; <span class="keyword">then</span></span><br><span class="line">	sum <span class="variable">$n1</span> <span class="variable">$n2</span></span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$n1</span> <span class="operator">-gt</span> <span class="variable">$n2</span> ]; <span class="keyword">then</span></span><br><span class="line">		highest_common_factor <span class="variable">$n1</span> <span class="variable">$n2</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"HCF : $?"</span></span><br><span class="line">		least_common_multiply <span class="variable">$n1</span> <span class="variable">$n2</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"LCM : $?"</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		highest_common_factor <span class="variable">$n2</span> <span class="variable">$n1</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"HCF : $?"</span></span><br><span class="line">		least_common_multiply <span class="variable">$n2</span> <span class="variable">$n1</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">"LCM : $?"</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Invalid arguments : <span class="variable">$n1</span> <span class="variable">$n2</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="shell"><a class="header-anchor" href="#shell"></a>Shell</h2>
<p>注意本文讨论的是Bash，而不一定是/bin/sh所链接的那个shell。这里出现的所有代码片段，默认在顶上都添加了<code>#!/bin/bash</code>。</p>
<p>计算机理解语言的 0 和 1 的称为二进制语言。</p>
<p>在早期的计算机时代，指令提供使用二进制语言，很难对我们所有人，读和写。所以在 Os 中是叫 Shell 的特别节目。壳 (大部分) 接受你的指令或命令在英语中的，如果它是一个有效的命令，它是传递给内核。</p>
<p>外壳是用户或程序是提供用户交互环境。Shell 是命令语言解释器执行命令从标准输入设备 (键盘) 或从文件读取。</p>
<p><code>Shell</code>不是系统内核的一部分，但使用系统内核执行程序、 创建文件等。</p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-01]]></title>
    <link href="http://molloc.me/2015/09/12/ZY-2015-09-01/"/>
    <id>http://molloc.me/2015/09/12/ZY-2015-09-01/</id>
    <published>2015-09-12T09:42:18.000Z</published>
    <updated>2015-09-14T15:47:55.613Z</updated>
    <content type="html"><![CDATA[<h2 id="linux-磁盘管理"><a class="header-anchor" href="#linux-磁盘管理"></a>Linux 磁盘管理</h2>
<p><strong>硬盘分为:机械式硬盘,SSD</strong></p>
<h3 id="机械式硬盘"><a class="header-anchor" href="#机械式硬盘"></a>机械式硬盘</h3>
<ul>
<li>rpm: 5400, 7200, 10000, 15000</li>
<li>track</li>
<li>sector 512byte</li>
<li>cylinder, 分区以柱面为基本单位进行的</li>
<li>MBR(Master Boot Record)</li>
</ul>
<a id="more"></a>
<p>MBR位于0磁道,占512byte,</p>
<p>其中前446字节是存放bootloader,</p>
<p>后64字节是存放filesystem allocation table.</p>
<p>后64字节中,每16字节标识一个分区,因此只能有四个分区,</p>
<p>最后2个字节(55,55AA)用来标记次MBR中的数据有效与否.</p>
<h3 id="磁盘接口的类型"><a class="header-anchor" href="#磁盘接口的类型"></a>磁盘接口的类型</h3>
<ul>
<li>IDE(ATA) -&gt; 理论接口速率(133MB/s) -&gt; (在centos5下,被识别为<code>/dev/hd[a-z]</code>)</li>
<li>SCSI -&gt; 理论接口速率(640MB/s)</li>
<li>SATA -&gt; 理论接口速率(6Gbps/s)</li>
<li>SAS -&gt; 理论接口速率(6Gbps/s)</li>
<li>USB -&gt; 理论接口速率(480MB/s)</li>
</ul>
<h3 id="识别硬盘设备-dev-sd"><a class="header-anchor" href="#识别硬盘设备-dev-sd"></a>识别硬盘设备: <code>/dev/sd</code></h3>
<ul>
<li>标记不同的硬盘设备<code>/dev/sd[a-z]</code></li>
<li>标记同一设备上的不同分区<code>/dev/sd[a-z][1-n]</code>
<ul>
<li>1-4: 主或扩展分区标识</li>
<li>5+ : 逻辑分区标识</li>
</ul>
</li>
</ul>
<p>设备文件是一种特殊文件,每一个设备文件它都没有大小,而有设备号的概念,</p>
<p>设备号由major(用来标识识别类型),minor(用来标识同一类型下的不同设备)组成.</p>
<p>major(主设备号)的主要作用在于让内核去识别配套的设备驱动的.</p>
<p>minor(次设备号)的主要作用在于让驱动程序来识别同一种驱动程序上所映射到的不同设备的.</p>
<p>&quot;块&quot; block, 设备类型标识均为'b', 允许随机访问,因此也被称为随机访问设备.</p>
<p>&quot;字符&quot; character 设备类型标识均为 'c', 也称为线性设备.</p>
<p>大于2T的硬盘用MBR管理会有问题,MBR不能识别大于2T的空间, 可以用GPT技术来管理.</p>
<h3 id="分区"><a class="header-anchor" href="#分区"></a>分区</h3>
<p>分区,主要用来分隔存储空间为多个小的空间,每个空间可独立使用文件系统.</p>
<p>分区工具,fdisk, parted, sfdisk</p>
<p>fdisk工具的使用,最多支持在一块磁盘上管理15个分区.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fdisk 操纵磁盘分区表</span></span><br><span class="line">SYNOPSIS</span><br><span class="line">       fdisk [-uc] [-b sectorsize] [-C cyls] [-H heads] [-S sects] device</span><br><span class="line"></span><br><span class="line">       fdisk <span class="operator">-l</span> [-u] [device...]</span><br><span class="line"></span><br><span class="line">       fdisk <span class="operator">-s</span> partition...</span><br><span class="line"></span><br><span class="line">       fdisk -v</span><br><span class="line"></span><br><span class="line">       fdisk -h</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分区</span></span><br><span class="line">$ fdisk /dev/sda</span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux <span class="number">2.23</span>.<span class="number">2</span>).</span><br><span class="line"></span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write command.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): m <span class="comment"># 键入m获取帮助</span></span><br><span class="line"></span><br><span class="line">Command action</span><br><span class="line">   a   toggle a bootable flag</span><br><span class="line">   b   edit bsd disklabel</span><br><span class="line">   c   toggle the dos compatibility flag</span><br><span class="line">   d   delete a partition <span class="comment"># 删除一个分区</span></span><br><span class="line">   g   create a new empty GPT partition table</span><br><span class="line">   G   create an IRIX (SGI) partition table</span><br><span class="line">   l   list known partition types <span class="comment"># 列出所有支持的ID类型</span></span><br><span class="line">   m   <span class="built_in">print</span> this menu <span class="comment"># 获取帮助</span></span><br><span class="line">   n   add a new partition <span class="comment"># 添加一个新分区</span></span><br><span class="line">   o   create a new empty DOS partition table</span><br><span class="line">   p   <span class="built_in">print</span> the partition table <span class="comment"># 显示当前磁盘的分区表</span></span><br><span class="line">   q   quit without saving changes <span class="comment"># 放弃修改并退出</span></span><br><span class="line">   s   create a new empty Sun disklabel</span><br><span class="line">   t   change a partition\<span class="string">'s system id # 修改分区的ID</span><br><span class="line">   u   change display/entry units</span><br><span class="line">   v   verify the partition table</span><br><span class="line">   w   write table to disk and exit # 保存退出</span><br><span class="line">   x   extra functionality (experts only)</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">Partition type:</span><br><span class="line">   p   primary (3 primary, 0 extended, 1 free)</span><br><span class="line">   e   extended</span><br><span class="line">Select (default e):</span><br><span class="line">Using default response e</span><br><span class="line">Selected partition 4</span><br><span class="line">First sector (110077952-251658239, default 110077952):</span><br><span class="line">Using default value 110077952</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (110077952-251658239, default 251658239):</span><br><span class="line">Using default value 251658239</span><br><span class="line">Partition 4 of type Extended and of size 67.5 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0009454e</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1            2048     1026047      512000   83  Linux</span><br><span class="line">/dev/sda2         1026048     5220351     2097152   82  Linux swap / Solaris</span><br><span class="line">/dev/sda3   *     5220352   110077951    52428800   83  Linux</span><br><span class="line">/dev/sda4       110077952   251658239    70790144    5  Extended</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">All primary partitions are in use</span><br><span class="line">Adding logical partition 5</span><br><span class="line">First sector (110080000-251658239, default 110080000):</span><br><span class="line">Using default value 110080000</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (110080000-251658239, default 251658239): +10G</span><br><span class="line">Partition 5 of type Linux and of size 10 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0009454e</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1            2048     1026047      512000   83  Linux</span><br><span class="line">/dev/sda2         1026048     5220351     2097152   82  Linux swap / Solaris</span><br><span class="line">/dev/sda3   *     5220352   110077951    52428800   83  Linux</span><br><span class="line">/dev/sda4       110077952   251658239    70790144    5  Extended</span><br><span class="line">/dev/sda5       110080000   131051519    10485760   83  Linux</span><br><span class="line"></span><br><span class="line">Command (m for help): n</span><br><span class="line">All primary partitions are in use</span><br><span class="line">Adding logical partition 6</span><br><span class="line">First sector (131053568-251658239, default 131053568):</span><br><span class="line">Using default value 131053568</span><br><span class="line">Last sector, +sectors or +size&#123;K,M,G&#125; (131053568-251658239, default 251658239): +20G</span><br><span class="line">Partition 6 of type Linux and of size 20 GiB is set</span><br><span class="line"></span><br><span class="line">Command (m for help): p</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0009454e</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1            2048     1026047      512000   83  Linux</span><br><span class="line">/dev/sda2         1026048     5220351     2097152   82  Linux swap / Solaris</span><br><span class="line">/dev/sda3   *     5220352   110077951    52428800   83  Linux</span><br><span class="line">/dev/sda4       110077952   251658239    70790144    5  Extended</span><br><span class="line">/dev/sda5       110080000   131051519    10485760   83  Linux</span><br><span class="line">/dev/sda6       131053568   172996607    20971520   83  Linux</span><br><span class="line"></span><br><span class="line">Command (m for help):w</span><br><span class="line"></span><br><span class="line">The partition table has been altered!</span><br><span class="line"></span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line"></span><br><span class="line">WARNING: Re-reading the partition table failed with error 16: Device or resource busy.</span><br><span class="line">The kernel still uses the old table. The new table will be used at</span><br><span class="line">the next reboot or after you run partprobe(8) or kpartx(8)</span><br><span class="line">Syncing disks.</span><br><span class="line"></span><br><span class="line"># 查看fdisk -l /dev/sda 此时fdisk能识别,内核不一定能识别</span><br><span class="line">$ fdisk -l /dev/sda</span><br><span class="line">Disk /dev/sda: 128.8 GB, 128849018880 bytes, 251658240 sectors</span><br><span class="line">Units = sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disk label type: dos</span><br><span class="line">Disk identifier: 0x0009454e</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1            2048     1026047      512000   83  Linux</span><br><span class="line">/dev/sda2         1026048     5220351     2097152   82  Linux swap / Solaris</span><br><span class="line">/dev/sda3   *     5220352   110077951    52428800   83  Linux</span><br><span class="line">/dev/sda4       110077952   251658239    70790144    5  Extended</span><br><span class="line">/dev/sda5       110080000   131051519    10485760   83  Linux</span><br><span class="line">/dev/sda6       131053568   172996607    20971520   83  Linux</span><br><span class="line"></span><br><span class="line"># 创建完成后查看内核有没有识别新的分区</span><br><span class="line">$ cat /proc/partitions</span><br><span class="line"></span><br><span class="line">major minor  #blocks  name</span><br><span class="line"></span><br><span class="line">8        0  125829120 sda</span><br><span class="line">8        1    2097152 sda1</span><br><span class="line">8        2   52428800 sda2</span><br><span class="line">11        0    7413760 sr0</span><br><span class="line"></span><br><span class="line"># 有三个命令可以让内核重读磁盘分区表</span><br><span class="line">CentOS5 partprobe [DEVICE]</span><br><span class="line">CentOS6,7 partx, kpartx</span><br><span class="line"></span><br><span class="line"># partx 告诉内核关于磁盘分区的现状和编号</span><br><span class="line">SYNOPSIS</span><br><span class="line">   partx [-a|-d|-s|-u] [-t TYPE] [-n M:N] [-] disk</span><br><span class="line">   partx [-a|-d|-s|-u] [-t TYPE] partition [disk]</span><br><span class="line"></span><br><span class="line">$ partx DEVICE</span><br><span class="line"></span><br><span class="line">$ partx -a DEVICE</span><br><span class="line"></span><br><span class="line">$ partx -a -n M:N DEVICE</span><br><span class="line"></span><br><span class="line">$ partx -a -n 3:6 /dev/sda</span><br><span class="line">$ cat /etc/partitions</span><br><span class="line">major minor  #blocks  name</span><br><span class="line"></span><br><span class="line">   8        0  125829120 sda</span><br><span class="line">   8        1     512000 sda1</span><br><span class="line">   8        2   44047360 sda2</span><br><span class="line">   8        3   10485760 sda3</span><br><span class="line">   8        4          1 sda4</span><br><span class="line">   8        5   10485760 sda5</span><br><span class="line">   8        6   20971520 sda6</span><br><span class="line">  11        0    1048575 sr0</span><br><span class="line"> 253        0    2097152 dm-0</span><br><span class="line"> 253        1   20971520 dm-1</span><br><span class="line"> 253        2   20971520 dm-2</span><br><span class="line"></span><br><span class="line">## 到此分区结束</span></span><br></pre></td></tr></table></figure>
<h2 id="linux-文件系统"><a class="header-anchor" href="#linux-文件系统"></a>linux 文件系统</h2>
<p>linux 通过 VFS(Virtual File System) 管理众多文件系统.</p>
<h3 id="分类"><a class="header-anchor" href="#分类"></a>分类</h3>
<ul>
<li>Linux: ext2, ext3, ext4, reiserfs, xfs, btrfs, swap, ISO9660</li>
<li>Window: fat32(vfat), ntfs</li>
<li>Unix: ffs, ufs, jfs, jfs2</li>
<li>网络文件系统: nfs, cifs</li>
<li>集群文件系统: ocfs2, gfs2</li>
<li>分布式文件系统: ceph, moosefs, mogilefs, hdfs, gfs, glusterfs</li>
</ul>
<h3 id="有无日志"><a class="header-anchor" href="#有无日志"></a>有无日志</h3>
<ul>
<li>日志型文件系统(ext3...)</li>
<li>非日志型文件系统(ext2)</li>
</ul>
<h3 id="swap"><a class="header-anchor" href="#swap"></a>swap</h3>
<p>交换分区,避免内存用尽</p>
<h3 id="创建文件系统"><a class="header-anchor" href="#创建文件系统"></a>创建文件系统</h3>
<p>创建文件系统实质就是在分区上执行格式化(高级格式化),要使用某种文件系统,需满足2个条件,</p>
<p>(1) 内核中支持此种文件系统.</p>
<p>(2) 有专门的文件系统管理工具.</p>
<p>创建工具的公用接口: <code>mkfs</code>, 检查工具的公用接口: <code>fsck</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建工具: mkfs (make filesystem)</span></span><br><span class="line">NAME</span><br><span class="line">   mkfs - build a Linux filesystem</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">   mkfs [options] [-t <span class="built_in">type</span>] [fs-options] device [size]</span><br><span class="line"></span><br><span class="line">$ mkfs -t ext4 /dev/sda5</span><br><span class="line"></span><br><span class="line">-&gt; mke2fs <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">   Filesystem label=</span><br><span class="line">   OS <span class="built_in">type</span>: Linux</span><br><span class="line">   Block size=<span class="number">4096</span> (<span class="built_in">log</span>=<span class="number">2</span>)</span><br><span class="line">   Fragment size=<span class="number">4096</span> (<span class="built_in">log</span>=<span class="number">2</span>)</span><br><span class="line">   Stride=<span class="number">0</span> blocks, Stripe width=<span class="number">0</span> blocks</span><br><span class="line">   <span class="number">655360</span> inodes, <span class="number">2621440</span> blocks</span><br><span class="line">   <span class="number">131072</span> blocks (<span class="number">5.00</span>%) reserved <span class="keyword">for</span> the super user</span><br><span class="line">   First data block=<span class="number">0</span></span><br><span class="line">   Maximum filesystem blocks=<span class="number">2151677952</span></span><br><span class="line">   <span class="number">80</span> block groups</span><br><span class="line">   <span class="number">32768</span> blocks per group, <span class="number">32768</span> fragments per group</span><br><span class="line">   <span class="number">8192</span> inodes per group</span><br><span class="line">   Superblock backups stored on blocks:</span><br><span class="line">   	<span class="number">32768</span>, <span class="number">98304</span>, <span class="number">163840</span>, <span class="number">229376</span>, <span class="number">294912</span>, <span class="number">819200</span>, <span class="number">884736</span>, <span class="number">1605632</span></span><br><span class="line"></span><br><span class="line">   Allocating group tables: <span class="keyword">done</span></span><br><span class="line">   Writing inode tables: <span class="keyword">done</span></span><br><span class="line">   Creating journal (<span class="number">32768</span> blocks): <span class="keyword">done</span></span><br><span class="line">   Writing superblocks and filesystem accounting information: <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">$ mkfs.xfs /dev/sda3</span><br><span class="line">-&gt; meta-data=/dev/sda3              isize=<span class="number">256</span>    agcount=<span class="number">4</span>, agsize=<span class="number">655360</span> blks</span><br><span class="line">            =                       sectsz=<span class="number">512</span>   attr=<span class="number">2</span>, projid32bit=<span class="number">1</span></span><br><span class="line">            =                       crc=<span class="number">0</span>        finobt=<span class="number">0</span></span><br><span class="line">   data     =                       bsize=<span class="number">4096</span>   blocks=<span class="number">2621440</span>, imaxpct=<span class="number">25</span></span><br><span class="line">            =                       sunit=<span class="number">0</span>      swidth=<span class="number">0</span> blks</span><br><span class="line">   naming   =version <span class="number">2</span>              bsize=<span class="number">4096</span>   ascii-ci=<span class="number">0</span> ftype=<span class="number">0</span></span><br><span class="line">   <span class="built_in">log</span>      =internal <span class="built_in">log</span>           bsize=<span class="number">4096</span>   blocks=<span class="number">2560</span>, version=<span class="number">2</span></span><br><span class="line">            =                       sectsz=<span class="number">512</span>   sunit=<span class="number">0</span> blks, lazy-count=<span class="number">1</span></span><br><span class="line">   realtime =none                   extsz=<span class="number">4096</span>   blocks=<span class="number">0</span>, rtextents=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## mke2fs ext系列文件系统的专用管理工具</span></span><br><span class="line">$ mke2fs -t &#123;ext2|ext3|ext4&#125; DEVICE</span><br><span class="line">		 -b &#123;<span class="number">1024</span>|<span class="number">2048</span>|<span class="number">4096</span>&#125; <span class="comment"># 只能是 1024, 2048, 4096</span></span><br><span class="line">		 -L <span class="string">'LABEL'</span> <span class="comment"># 设定卷标</span></span><br><span class="line">		 -j <span class="comment"># 启动日志功能,相当于mke2fs -t ext3</span></span><br><span class="line">		 -i <span class="comment">#</span></span><br><span class="line">		 -N <span class="comment"># 一共保留多少个inode</span></span><br><span class="line">		 -m <span class="comment"># 预留磁盘空间占据多大百分比的空间为后期管理使用</span></span><br><span class="line">		 -O <span class="comment"># feature(启用), ^feature(不启用), 启用指定特性</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 文件系统属性查看及调整工具</span></span><br><span class="line">$ tune2fs <span class="comment">#显示ext系列文件系统的属性,或调整其属性</span></span><br><span class="line">		<span class="operator">-l</span> <span class="comment"># 显示超级块中的信息,显示整个文件的属性及布局等相关信息.</span></span><br><span class="line">		-L <span class="comment"># 'LABAL' 修改卷标</span></span><br><span class="line">		-m <span class="comment"># 调整预留给管理员的管理空间占据百分比</span></span><br><span class="line">		-j <span class="comment"># ext2 --&gt; ext3</span></span><br><span class="line">		-O <span class="comment"># 启用或禁用某种属性,文件系统属性的启动或关闭</span></span><br><span class="line">		-o <span class="comment"># 文件系统默认挂载选项的启用或关闭</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## dumpe2fs 能显示整个文件系统的布局管理及超级块信息</span></span><br><span class="line">$ dume2fs</span><br><span class="line">		-h <span class="comment"># 仅显示超级块信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## fsck 文件系统检查关系</span></span><br><span class="line">$ fsck -t <span class="built_in">type</span></span><br><span class="line">		fsck.type</span><br><span class="line">			<span class="operator">-a</span> <span class="comment"># 自动修复错误</span></span><br><span class="line">			<span class="operator">-f</span> <span class="comment"># 强制检测</span></span><br><span class="line">			-r <span class="comment"># 交互式修复错误</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1 检查sda5分区</span></span><br><span class="line">$ fsck.ext4 /dev/sda5</span><br><span class="line">-&gt; e2fsck <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">   MYDATA: clean, <span class="number">11</span>/<span class="number">655360</span> files, <span class="number">83137</span>/<span class="number">2621440</span> blocks</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 强制检查sda5分区</span></span><br><span class="line">$ fsck.ext4 <span class="operator">-f</span> /dev/sda5</span><br><span class="line">-&gt; e2fsck <span class="number">1.42</span>.<span class="number">9</span> (<span class="number">28</span>-Dec-<span class="number">2013</span>)</span><br><span class="line">   Pass <span class="number">1</span>: Checking inodes, blocks, and sizes</span><br><span class="line">   Pass <span class="number">2</span>: Checking directory structure</span><br><span class="line">   Pass <span class="number">3</span>: Checking directory connectivity</span><br><span class="line">   Pass <span class="number">4</span>: Checking reference counts</span><br><span class="line">   Pass <span class="number">5</span>: Checking group summary information</span><br><span class="line">   MYDATA: <span class="number">11</span>/<span class="number">655360</span> files (<span class="number">0.0</span>% non-contiguous), <span class="number">83137</span>/<span class="number">2621440</span> blocks</span><br><span class="line"></span><br><span class="line">$ e2fsck <span class="comment"># ext 系列文件系统专用检查修复工具</span></span><br><span class="line">      -y <span class="comment"># 自动回答为'yes'</span></span><br><span class="line">      <span class="operator">-f</span> <span class="comment"># force 强制检测</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## e2label 查看或设置ext系列文件系统的卷标</span></span><br><span class="line">$ e2label</span><br><span class="line">		e2label DEVICE [LABEL] <span class="comment"># 带卷标就是设置卷标,不带就是查看此设备的卷标.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## blkid 查看分区相关信息</span></span><br><span class="line">$ blkid /dev/sda5</span><br><span class="line">-&gt; /dev/sda5: UUID=<span class="string">"a20840d4-638c-4c56-99e8-ca0e9b15c516"</span> TYPE=<span class="string">"ext4"</span></span><br></pre></td></tr></table></figure>
<h3 id="文件系统的挂载和使用"><a class="header-anchor" href="#文件系统的挂载和使用"></a>文件系统的挂载和使用</h3>
<p>kernel --&gt; rootfs(分区)</p>
<p>具有<code>bin,sbin,etc,lib,lib64,dev,tmp,proc,sys</code>目录的分区才可能是rootfs分区.需要加载<code>/sbin/init</code>的程序,在CentOS7下是<code>systemd</code>, 第一次加载的系统一定是根文件系统,将额外文件系统与根文件系统某现存的目录建立起关联关系,进而使得此目录作为其他文件系统访问入口的行为,称之为挂载,解除此关联关系的过程,称之为卸载.设备挂载至的位置称之为挂载点(mount point),如果挂载点之下原来就有文件的话,原文件会被隐藏,当卸载后,又会显现,所以挂载点最好使用空目录.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">$ mount <span class="comment"># 不带任何参数,是通过读取/etc/mtab文件来显示当前系统所有已经挂载的设备.</span></span><br><span class="line">$ mount <span class="operator">-a</span> <span class="comment"># 挂载/etc/fstab文件中的所有支持自动挂载的文件系统</span></span><br><span class="line">$ mount [options] [-o options] DEVICE MOUNT_POINT <span class="comment"># 第一个options是命令选项,第二个options是挂载选项.</span></span><br><span class="line">         <span class="comment"># DEVICE 要挂载的设备</span></span><br><span class="line">         <span class="comment"># (1) 设备文件,/dev/sda5</span></span><br><span class="line">         <span class="comment"># (2) 卷标, -L 'LABEL'</span></span><br><span class="line">         <span class="comment"># (3) UUID, -U 'UUID'</span></span><br><span class="line">         <span class="comment"># (4) 伪文件系统需要指定伪文件系统名字</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># COMMAND</span></span><br><span class="line">$ mount -t <span class="comment"># type: 文件系统类型</span></span><br><span class="line">        -r <span class="comment"># 以'只读'方式挂载此文件系统.</span></span><br><span class="line">        -w <span class="comment"># 以'读写'方式挂载此文件系统.</span></span><br><span class="line">        -n <span class="comment"># 每个文件系统在挂载时都会自动更新/etc/mtab文件,-n是禁止此功能.</span></span><br><span class="line">           <span class="comment"># 此时如果想查看挂载的所有文件系统,可以 cat /proc/mounts</span></span><br><span class="line">        <span class="operator">-a</span> <span class="comment"># 自动挂载所有支持自动挂载的设备.</span></span><br><span class="line">        -L <span class="comment"># 以LABEL的方式挂载</span></span><br><span class="line">        -B <span class="comment"># 与某个目录绑定</span></span><br><span class="line">         <span class="comment">########</span></span><br><span class="line">        -o <span class="comment"># 挂载选项</span></span><br><span class="line">            async                <span class="comment"># 异步模式</span></span><br><span class="line">            sync                 <span class="comment"># 同步模式</span></span><br><span class="line">            atime/noatime        <span class="comment"># 是否更新访问时间戳</span></span><br><span class="line">            diratime/nodiratime  <span class="comment"># 是否更新目录访问时间戳</span></span><br><span class="line">            auto/noauto          <span class="comment"># 是否允许次设备自动挂载</span></span><br><span class="line">            <span class="built_in">exec</span>/noexec          <span class="comment"># 是否允许执行次文件系统上的应用程序</span></span><br><span class="line">            dev/nodev            <span class="comment"># 是否支持在次设备上使用设备文件</span></span><br><span class="line">            remount              <span class="comment"># 重新挂载</span></span><br><span class="line">            ro</span><br><span class="line">            rw</span><br><span class="line">            nouser/user          <span class="comment"># 是否允许普通用户挂载次设备</span></span><br><span class="line">            act                  <span class="comment"># 是否支持此设备上使用facl</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## umount 卸载命令</span></span><br><span class="line">$ umount &#123;DEVICE|MOUNT_POINT&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#1 卸载/dev/sda5</span></span><br><span class="line">$ umount /dev/sda5</span><br><span class="line">-&gt; umount: /data: target is busy.</span><br><span class="line">        (In some cases useful info about processes that use</span><br><span class="line">         the device is found by lsof(<span class="number">8</span>) or fuser(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">$ fuser -v /data/ <span class="comment"># 查看正在访问指定挂载点的进程</span></span><br><span class="line">                     USER        PID ACCESS COMMAND</span><br><span class="line">/data:               root     kernel mount /data</span><br><span class="line">                     root       <span class="number">3337</span> ..c.. bash</span><br><span class="line"></span><br><span class="line">$ fuser -km /data/ <span class="comment"># 终止所有正在访问指定的挂载点的进程</span></span><br><span class="line">$ umount /data/</span><br><span class="line"></span><br><span class="line"><span class="comment">#1 把/dev/sda5挂载至/data目录</span></span><br><span class="line">$ mount /dev/sda5 /data</span><br><span class="line">$ mount | tail -n <span class="number">1</span></span><br><span class="line">-&gt; /dev/sda5 on /data <span class="built_in">type</span> ext4 (rw,relatime,seclabel,data=ordered)</span><br></pre></td></tr></table></figure>
<h3 id="交换分区swap"><a class="header-anchor" href="#交换分区swap"></a>交换分区swap</h3>
<p>SWAP就是LINUX下的虚拟内存分区,它的作用是在物理内存使用完之后,将磁盘空间(也就是SWAP分区)虚拟成内存来使用.
它和Windows系统的交换文件作用类似，但是它是一段连续的磁盘空间，并且对用户不可见。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># COMMAND</span></span><br><span class="line">$ free <span class="comment">#查看memory和swap的使用状态.</span></span><br><span class="line">$ free -m 以MB为单位</span><br><span class="line">       -g 以GB为单位</span><br><span class="line"></span><br><span class="line">$ free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           <span class="number">1826</span>         <span class="number">155</span>        <span class="number">1458</span>           <span class="number">8</span>         <span class="number">212</span>        <span class="number">1494</span></span><br><span class="line">Swap:          <span class="number">2047</span>           <span class="number">0</span>        <span class="number">2047</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1 添加一块交换分区</span></span><br><span class="line">$ fdisk <span class="operator">-l</span> /dev/sda</span><br><span class="line"></span><br><span class="line">Disk /dev/sda: <span class="number">128.8</span> GB, <span class="number">128849018880</span> bytes, <span class="number">251658240</span> sectors</span><br><span class="line">Units = sectors of <span class="number">1</span> * <span class="number">512</span> = <span class="number">512</span> bytes</span><br><span class="line">Sector size (logical/physical): <span class="number">512</span> bytes / <span class="number">512</span> bytes</span><br><span class="line">I/O size (minimum/optimal): <span class="number">512</span> bytes / <span class="number">512</span> bytes</span><br><span class="line">Disk label <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: <span class="number">0</span>x0009722d</span><br><span class="line"></span><br><span class="line">   Device Boot      Start         End      Blocks   Id  System</span><br><span class="line">/dev/sda1   *        <span class="number">2048</span>     <span class="number">1026047</span>      <span class="number">512000</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda2         <span class="number">1026048</span>    <span class="number">89120767</span>    <span class="number">44047360</span>   <span class="number">8</span>e  Linux LVM</span><br><span class="line">/dev/sda3        <span class="number">89120768</span>   <span class="number">110092287</span>    <span class="number">10485760</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda4       <span class="number">110092288</span>   <span class="number">251658239</span>    <span class="number">70782976</span>    <span class="number">5</span>  Extended</span><br><span class="line">/dev/sda5       <span class="number">110094336</span>   <span class="number">131065855</span>    <span class="number">10485760</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda6       <span class="number">131067904</span>   <span class="number">173010943</span>    <span class="number">20971520</span>   <span class="number">83</span>  Linux</span><br><span class="line">/dev/sda7       <span class="number">173012992</span>   <span class="number">177207295</span>     <span class="number">2097152</span>   <span class="number">82</span>  Linux swap / Solaris</span><br><span class="line"></span><br><span class="line"><span class="comment"># COMMAND</span></span><br><span class="line">$ mkswap [option] DEVICE <span class="comment"># 创建交换分区</span></span><br><span class="line">         -L <span class="string">'LABEL'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 创建交换分区</span></span><br><span class="line">$ mkswap /dev/sda7</span><br><span class="line"></span><br><span class="line">Setting up swapspace version <span class="number">1</span>, size = <span class="number">2097148</span> KiB</span><br><span class="line">no label, UUID=<span class="number">7</span>ad769dc-<span class="number">1</span>ec8-<span class="number">4582</span>-be29-<span class="number">8</span>f39cfd466ad</span><br><span class="line"></span><br><span class="line"><span class="comment"># COMMAND</span></span><br><span class="line">$ swapon [option] [DEVICE]</span><br><span class="line">         <span class="operator">-a</span> <span class="comment"># 激活所有交换分区</span></span><br><span class="line">         -p PRIORITY <span class="comment"># 设定其优先级</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 启用交换分区</span></span><br><span class="line">$ swapon /dev/sda7</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           <span class="number">1826</span>         <span class="number">159</span>        <span class="number">1454</span>           <span class="number">8</span>         <span class="number">212</span>        <span class="number">1491</span></span><br><span class="line">Swap:          <span class="number">4095</span>           <span class="number">0</span>        <span class="number">4095</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 若要关闭则用swapoff</span></span><br><span class="line">$ swapoff /dev/sda7</span><br></pre></td></tr></table></figure>
<p>文件系统等空间占用信息的查看工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#COMMAND</span></span><br><span class="line">$ df <span class="comment"># 显示磁盘空间占用信息</span></span><br><span class="line">   -h <span class="comment"># human-readable 人类可读的</span></span><br><span class="line">   -i <span class="comment"># 显示inode数量</span></span><br><span class="line">   -P <span class="comment"># 以POSIX兼容的格式显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#COMMAND</span></span><br><span class="line">$ du <span class="comment"># 评估文件空间使用情况</span></span><br><span class="line">   -h <span class="comment"># human-readable 人类可读的</span></span><br><span class="line">   <span class="operator">-s</span> <span class="comment"># summary 概要情况</span></span><br></pre></td></tr></table></figure>
<p>文件系统相关的挂载配置文件<code>/etc/fstab</code>,每次系统启动都回去读取该文件,并自动挂载该文件下定义的文件系统,包含伪文件系统.此文件中每行定义一个文件系统.格式如下:</p>
<p>&quot;要挂载的设备或伪文件系统   挂载点   文件系统类型   挂载选项  转储频率  自检次序&quot;</p>
<ul>
<li>要挂载的设备或伪文件系统, 可以使用设备文件, LABLE=, UUID=, 使用伪文件系统名称</li>
<li>挂载点 <code>/data</code></li>
<li>文件系统类型 <code>ext2, ext3, xfs...</code></li>
<li>defaults # Use default options: rw, suid, dev, exec, auto, nouser, and async.</li>
<li>转储频率, 可以理解为备份, (0: 不转储, 1: 每天转储, 2: 每隔一天转储)</li>
<li>自检次序, (0: 不自检, 1: 首先自检,通常只有/才为1, 2: 其他)</li>
</ul>
<h3 id="软连接与硬链接"><a class="header-anchor" href="#软连接与硬链接"></a>软连接与硬链接</h3>
<p>硬链接:两个路径指向同一个inode.(不能对目录进行,不能跨分区进行)</p>
<p>指向同一个inode的多个不同路径,创建文件的硬链接会增加inode的引用计数,删除硬链接仅是删除其一个访问路径,直到最后一个路径被删除.</p>
<p>符号链接:链接文件的数据指向另一个文件路径(可以对目录进行,也可以跨分区,指向的是另一个文件路径,而非inode,对文件创建符号链接不会增加其引用计数,删除原文件,符号链接也丢失)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#COMMAND</span></span><br><span class="line">$ ln [<span class="operator">-s</span>] SRC DEST</span><br><span class="line">   <span class="operator">-s</span> <span class="comment"># symbolic link</span></span><br><span class="line">   -v <span class="comment"># verbose</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="linux-磁盘管理"><a class="header-anchor" href="#linux-磁盘管理"></a>Linux 磁盘管理</h2>
<p><strong>硬盘分为:机械式硬盘,SSD</strong></p>
<h3 id="机械式硬盘"><a class="header-anchor" href="#机械式硬盘"></a>机械式硬盘</h3>
<ul>
<li>rpm: 5400, 7200, 10000, 15000</li>
<li>track</li>
<li>sector 512byte</li>
<li>cylinder, 分区以柱面为基本单位进行的</li>
<li>MBR(Master Boot Record)</li>
</ul>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-10]]></title>
    <link href="http://molloc.me/2015/09/11/ZY-2015-09-10/"/>
    <id>http://molloc.me/2015/09/11/ZY-2015-09-10/</id>
    <published>2015-09-11T15:18:37.000Z</published>
    <updated>2015-09-12T08:58:58.860Z</updated>
    <content type="html"><![CDATA[<p>总结rpm和yum实现程序包的管理功能</p>
<h2 id="程序包管理"><a class="header-anchor" href="#程序包管理"></a>程序包管理</h2>
<h3 id="包管理器"><a class="header-anchor" href="#包管理器"></a>包管理器</h3>
<p><strong>打包,包管理(安装,升级,卸载,查询及校验)</strong></p>
<ul>
<li>deb: debian</li>
<li>rpm: redhat package manager --&gt; RPM is Package Manager</li>
<li>DNF:</li>
</ul>
<a id="more"></a>
<p>systemctl set-default multi-user.target # 切换runlevel</p>
<h4 id="rpm包的命名机制"><a class="header-anchor" href="#rpm包的命名机制"></a>rpm包的命名机制</h4>
<p>name-VERSION-RELEASE.ARCH.rpm</p>
<ul>
<li><code>bash-4.2.4-1.e17.x76_64.rpm</code> 其中,<code>1.e17</code>是rpm包的relase号(<code>el7</code>是适用的操作系统,也当做release号的一部分).</li>
<li><code>bash-devel-4.2.4-1.e17.x76_64.rpm</code></li>
</ul>
<p>包与包之间有可能存在依赖关系: X --&gt; Y,通过rpm数据库<code>/var/lib/rpm/</code>,追踪rpm的关系</p>
<p>如何获取rpm包的途径</p>
<ul>
<li>发行版提供的程序包(<code>mkdir /media/cdrom;mount -r /dev/cdrom /media/cdrom</code>)</li>
<li>Fedora-EPEL</li>
<li>某个项目程序的官方站点</li>
<li>搜索引擎(http://rpm.pbone.net, http:pkgs.org)</li>
</ul>
<p>基于rpm命令实现程序包管理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 安装</span></span><br><span class="line">rpm &#123;-i|--install&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line"><span class="comment"># 与-i常用的选项:</span></span><br><span class="line"><span class="comment"># -v: 显示详细过程, -vv, -vvv</span></span><br><span class="line"><span class="comment"># -h: 显示安装进度</span></span><br><span class="line"></span><br><span class="line">rpm -q <span class="comment"># 查询包相关信息,一般跟上包名就可以了</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个rpm包提供一个或多个capabilities</span></span><br><span class="line">--nodeps <span class="comment"># 忽略依赖关系</span></span><br><span class="line">--test <span class="comment">#做测试</span></span><br><span class="line">--replacepkgs <span class="comment"># 重装程序包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 升级,需提供包文件(package-file)</span></span><br><span class="line">rpm &#123;-U|--upgrade&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line">rpm &#123;-F|--freshen&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line"></span><br><span class="line">-Uvh: 如果有旧版程序包,则升级之.如果没有,则安装之.</span><br><span class="line">-Fvh: 如果有旧版程序包,则升级之.如果没有,则不安装.</span><br><span class="line"></span><br><span class="line">--nodeps <span class="comment"># 忽略依赖关系</span></span><br><span class="line">--oldpackage <span class="comment"># 降级</span></span><br><span class="line">--force <span class="comment"># 强制升级</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 卸载, 仅需提供包名(Package-name)</span></span><br><span class="line">rpm &#123;<span class="operator">-e</span>|--erase&#125; [--allmatches] [--nodeps] [--noscripts]</span><br><span class="line">           [--notriggers] [--test] PACKAGE_NAME ...</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查询</span></span><br><span class="line">rpm &#123;-q|--query&#125; [select-options] [query-options]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询选项</span></span><br><span class="line">-qa <span class="comment"># 查询本机已经安装的所有程序包.</span></span><br><span class="line">-qf /PATH/TO/SOMEFILE <span class="comment"># 查询此处指定的文件由那个程序包安装生成</span></span><br><span class="line"></span><br><span class="line">-qc <span class="comment"># 查询指定程序包安装生成的配置文件.</span></span><br><span class="line">-qd <span class="comment"># 查询指定程序包安装生成的文档.</span></span><br><span class="line">-qi <span class="comment"># 查询指定程序包的相关信息.</span></span><br><span class="line">-ql <span class="comment"># 查询指定程序包生成的所有文件的列表.</span></span><br><span class="line">-qR <span class="comment"># 查询指定程序包依赖那些能力</span></span><br><span class="line">-q --scripts <span class="comment"># 查询程序包相关脚本</span></span><br><span class="line">			 <span class="comment"># 四类脚本</span></span><br><span class="line">			 <span class="comment"># preinstall 安装前脚本</span></span><br><span class="line">			 <span class="comment"># postinstall 安装后脚本</span></span><br><span class="line">			 <span class="comment"># preuninstall 卸载前脚本</span></span><br><span class="line">			 <span class="comment"># ppostuninstall 卸载后脚本</span></span><br><span class="line"></span><br><span class="line">-p <span class="comment"># 查询针对的是未安装程序包文件</span></span><br><span class="line">$ rpm -qpi php-mysqlnd-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">23</span>.el7_0.<span class="number">3</span>.x86_64.rpm</span><br><span class="line">--&gt; Name        : php-mysqlnd</span><br><span class="line">	Version     : <span class="number">5.4</span>.<span class="number">16</span></span><br><span class="line">	Release     : <span class="number">23</span>.el7_0.<span class="number">3</span></span><br><span class="line">	Architecture: x86_64</span><br><span class="line">	Install Date: (not installed)</span><br><span class="line">	Group       : Development/Languages</span><br><span class="line">	Size        : <span class="number">472238</span></span><br><span class="line">	License     : PHP</span><br><span class="line">	Signature   : RSA/SHA256, Fri <span class="number">31</span> Oct <span class="number">2014</span> <span class="number">10</span>:<span class="number">24</span>:<span class="number">58</span> PM CST, Key ID <span class="number">24</span>c6a8a7f4a80eb5</span><br><span class="line">	Source RPM  : php-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">23</span>.el7_0.<span class="number">3</span>.src.rpm</span><br><span class="line">	Build Date  : Fri <span class="number">31</span> Oct <span class="number">2014</span> <span class="number">09</span>:<span class="number">07</span>:<span class="number">27</span> PM CST</span><br><span class="line">	Build Host  : worker1.bsys.centos.org</span><br><span class="line">	Relocations : (not relocatable)</span><br><span class="line">	Packager    : CentOS BuildSystem &lt;http://bugs.centos.org&gt;</span><br><span class="line">	Vendor      : CentOS</span><br><span class="line">	URL         : http://www.php.net/</span><br><span class="line">	Summary     : A module <span class="keyword">for</span> PHP applications that use MySQL databases</span><br><span class="line">	Description :</span><br><span class="line"></span><br><span class="line">$ rpm -qpl php-mysqlnd-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">23</span>.el7_0.<span class="number">3</span>.x86_64.rpm</span><br><span class="line">--&gt; /etc/php.d/mysqlnd.ini</span><br><span class="line">	/etc/php.d/mysqlnd_mysql.ini</span><br><span class="line">	/etc/php.d/mysqlnd_mysqli.ini</span><br><span class="line">	/etc/php.d/pdo_mysqlnd.ini</span><br><span class="line"></span><br><span class="line"><span class="comment">## 校验</span></span><br><span class="line">rpm &#123;-V|--verify&#125; [select-options] [verify-options]</span><br><span class="line">$ rpm -V zsh</span><br><span class="line">--&gt; S.<span class="number">5</span>....T.    /usr/share/zsh/<span class="number">5.0</span>.<span class="number">2</span>/<span class="built_in">functions</span>/run-help</span><br><span class="line"><span class="comment"># S.5....T.</span></span><br><span class="line">S file Size differs <span class="comment"># 文件大小发生改变</span></span><br><span class="line">M Mode differs (includes permissions and file <span class="built_in">type</span>) <span class="comment"># 权限发生改变</span></span><br><span class="line"><span class="number">5</span> digest (formerly MD5 sum) differs <span class="comment"># 校验码发生改变</span></span><br><span class="line">D Device major/minor number mismatch <span class="comment"># 设备文件的主次设备号不匹配</span></span><br><span class="line">L <span class="built_in">read</span>Link(<span class="number">2</span>) path mismatch</span><br><span class="line">U User ownership differs <span class="comment"># 文件属主发生改变</span></span><br><span class="line">G Group ownership differs <span class="comment"># 文件属组发生改变</span></span><br><span class="line">T mTime differs <span class="comment"># 文件修改时间戳发生改变</span></span><br><span class="line">P caPabilities differ <span class="comment"># 能力改变,比如说删除一个文件</span></span><br></pre></td></tr></table></figure>
<h4 id="打包-一个单一的归档文件"><a class="header-anchor" href="#打包-一个单一的归档文件"></a>打包: 一个单一的归档文件</h4>
<p>通过rpmbuild打包(基于specs文件).</p>
<p>程序当中10中功能,5种常用,3种不常用,2种基本不用,会通过分包机制:</p>
<ul>
<li>核心包: testapp-VERSION.tar.gz</li>
<li>支包: testapp-dev-VERSION.tar.gz</li>
<li>程序包的版本命名机制VERSION: major,minor,release(eg: bash-4.2.4.tar.gz)</li>
</ul>
<h4 id="包校验"><a class="header-anchor" href="#包校验"></a>包校验</h4>
<ul>
<li>来源合法性验证: 基于非对称性加密(公钥加密只能用对应的私钥解密,反之亦然)</li>
<li>完整性验证: 基于单向加密</li>
</ul>
<p>centos相关目录(<code>/etc/pki/tls/,/etc/pki/rpm-gpg</code>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ls /etc/pki/&#123;tls,rpm-gpg&#125;</span><br><span class="line">--&gt; /etc/pki/rpm-gpg:</span><br><span class="line">	RPM-GPG-KEY-CentOS-<span class="number">7</span>  RPM-GPG-KEY-CentOS-Debug-<span class="number">7</span>  RPM-GPG-KEY-CentOS-Testing-<span class="number">7</span>  RPM-GPG-KEY-EPEL-<span class="number">7</span></span><br><span class="line"></span><br><span class="line">	/etc/pki/tls:</span><br><span class="line">	cert.pem  certs  misc  openssl.cnf  private</span><br><span class="line"></span><br><span class="line"><span class="comment">## 导入校验文件</span></span><br><span class="line">$ rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-<span class="number">7</span></span><br><span class="line"></span><br><span class="line">-K <span class="comment"># 校验来源</span></span><br><span class="line">$ rpm -K zsh-<span class="number">5.0</span>.<span class="number">2</span>-<span class="number">7</span>.el7.x86_64.rpm</span><br><span class="line">--&gt; zsh-<span class="number">5.0</span>.<span class="number">2</span>-<span class="number">7</span>.el7.x86_64.rpm: rsa sha1 (md5) pgp md5 OK</span><br></pre></td></tr></table></figure>
<h3 id="程序包组成"><a class="header-anchor" href="#程序包组成"></a>程序包组成</h3>
<ul>
<li>二进制程序: <code>/bin, /sbin/, /usr/bin, /usr/sbin</code></li>
<li>库文件: <code>/lib64, /lib, /usr/lib64, /usr/lib</code></li>
<li>配置文件: <code>/etc</code></li>
<li>帮助文件: manual, info</li>
</ul>
<hr>
<h2 id="yum"><a class="header-anchor" href="#yum"></a>YUM</h2>
<p><em>Yellowdog Updater Modified</em></p>
<h3 id="yum程序的配置文件"><a class="header-anchor" href="#yum程序的配置文件"></a>YUM程序的配置文件</h3>
<ul>
<li><code>/etc/yum.conf</code>,定义全局配置,对所有仓库都适用的配置.</li>
<li><code>/etc/yum.repos.d/*.repo</code>,一个文件通常用于一个或一组功能相近或相关的仓库.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## yum.conf</span></span><br><span class="line">[main]</span><br><span class="line"><span class="comment"># cachedir：yum缓存的目录，yum在此存储下载的rpm包和数据库，一般</span></span><br><span class="line"><span class="comment"># 是/var/cache/yum/$basearch/$releasever</span></span><br><span class="line">cachedir=/var/cache/yum/<span class="variable">$basearch</span>/<span class="variable">$releasever</span></span><br><span class="line"><span class="comment"># 是否保留缓存内容，0：表示安装后删除软件包，1表示安装后保留软件包</span></span><br><span class="line">keepcache=<span class="number">0</span></span><br><span class="line"><span class="comment"># 除错级别，0──10,默认是2 貌似只记录安装和删除记录</span></span><br><span class="line">debuglevel=<span class="number">2</span></span><br><span class="line">logfile=/var/<span class="built_in">log</span>/yum.log</span><br><span class="line"><span class="comment"># 有两个选项1和0,代表是否只升级和你安装软件包cpu体系一致的包，</span></span><br><span class="line"><span class="comment"># 如果设为1，则如你安装了一个i386的rpm，则yum不会用1686的包来升级。</span></span><br><span class="line">exactarch=<span class="number">1</span></span><br><span class="line">obsoletes=<span class="number">1</span></span><br><span class="line">gpgcheck=<span class="number">1</span></span><br><span class="line">plugins=<span class="number">1</span></span><br><span class="line">installonly_<span class="built_in">limit</span>=<span class="number">5</span></span><br><span class="line">bugtracker_url=http://bugs.centos.org/<span class="built_in">set</span>_project.php</span><br><span class="line">distroverpkg=centos-release</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个仓库的格式</span></span><br><span class="line">[REPOID] <span class="comment"># 唯一</span></span><br><span class="line">name=Centos <span class="number">7</span> Base Repo on aliyun.com</span><br><span class="line">baseurl= <span class="comment"># 可以跟多个路径,用空格,换行隔开</span></span><br><span class="line">mirrorlist=SCHEME://HOSTNAME/PATH/TO/MIRROR_LIST_FILE <span class="comment"># 里面定义了所有可用镜像的列表</span></span><br><span class="line"><span class="built_in">enable</span>=&#123;<span class="number">0</span>|<span class="number">1</span>&#125; <span class="comment"># 0 不启用,1 启用</span></span><br><span class="line">gpgcheck=&#123;<span class="number">0</span>|<span class="number">1</span>&#125; <span class="comment"># 0 不检查,1 检查</span></span><br><span class="line">gpgkey=</span><br><span class="line">cost=</span><br><span class="line"><span class="comment">#failovermethode</span></span><br><span class="line"><span class="comment"># 有两个选项roundrobin和priority，意思分别是有多个url可供选择时，</span></span><br><span class="line"><span class="comment"># yum选择的次序，roundrobin是随机选择，如果连接失</span></span><br><span class="line"><span class="comment"># 败则使用下一个，依次循环，priority则根据url的次序从第一个开始。</span></span><br><span class="line"><span class="comment"># 如果不指明，默认是roundrobin。</span></span><br><span class="line">failovermethod=priority</span><br><span class="line"></span><br><span class="line"><span class="comment">## 使用发行的仓库当本地仓库,先挂载光盘至某目录</span></span><br><span class="line">[LocalRepo]</span><br><span class="line">name=</span><br><span class="line">baseurl=file:///media/cdrom</span><br><span class="line">gpgcheck=<span class="number">1</span></span><br><span class="line">enabled=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 创建本地仓库</span></span><br><span class="line">yum install createrepo</span><br><span class="line">createrepo /PATH/TO/RPMFILES/</span><br><span class="line"></span><br><span class="line"><span class="comment">## 定义仓库的可用变量</span></span><br><span class="line"><span class="variable">$releasever</span>: <span class="comment"># 引用当前系统的主版本号</span></span><br><span class="line"><span class="variable">$basearch</span>: <span class="comment"># 引用当前系统的基本架构</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## command yum</span></span><br><span class="line">yum [options] [<span class="built_in">command</span>] [package ...]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装</span></span><br><span class="line">yum install mysql</span><br><span class="line"></span><br><span class="line"><span class="comment">## 卸载</span></span><br><span class="line"><span class="comment"># remove 一个包的时候,依赖与此包的包一并被卸载.</span></span><br><span class="line"><span class="comment"># eg: php-mbstring 依赖于 php-common,那么卸载php-common的时候,php-mbstring也会被卸载.</span></span><br><span class="line">yum remove php-common</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查询</span></span><br><span class="line">yum info KEYWORD <span class="comment"># 安装不安装都可以查询</span></span><br><span class="line">yum seach KEYWORD <span class="comment"># 基于关键字做搜索,而且只是基于包名,概要做匹配</span></span><br><span class="line">yum list [all|installed|availiable]</span><br><span class="line">yum provides KEYWORD <span class="comment"># 查询指定文件有那个包安装生成</span></span><br><span class="line">yum reinstall KEYWORD <span class="comment"># 重新安装</span></span><br><span class="line">yum localinstall KEYWORD <span class="comment"># 从本地安装, localinstall已被废弃,建议使用install安装.</span></span><br><span class="line">yum downgrade KEYWORD <span class="comment"># 降级</span></span><br><span class="line">yum clean [ packages | metadata | expire-cache | rpmdb | plugins | all ] <span class="comment"># 清理缓存</span></span><br><span class="line">yum makecache [fast] <span class="comment"># 手动生成缓存</span></span><br><span class="line">yum grouplist <span class="comment"># 列出包组名</span></span><br><span class="line">yum groupinfo PACKAGE_GROUP_NAME <span class="comment"># 查看包组里面的内容, 带加号的是必须要装上去的,不带的为已经装过的.还有可选的</span></span><br><span class="line">yum groupinstall PACKAGE_GROUP_NAME <span class="comment"># 安装包组</span></span><br><span class="line">yum groupremove PACKAGE_GROUP_NAME <span class="comment"># 移除包组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 仓库相关</span></span><br><span class="line">yum repolist [ all | enabled | disabled ] <span class="comment"># 列出所有,可用的,禁用的</span></span><br><span class="line">yum repoinfo [ all | enabled | disabled ]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 帮助</span></span><br><span class="line">yum <span class="built_in">help</span> repoinfo</span><br><span class="line"></span><br><span class="line"><span class="comment">## 升级</span></span><br><span class="line">yum check-update <span class="comment"># 检查有那些可用升级</span></span><br></pre></td></tr></table></figure>
<h2 id="yum-history"><a class="header-anchor" href="#yum-history"></a>yum history</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 列出所有操作</span></span><br><span class="line">$ yum <span class="built_in">history</span></span><br><span class="line"><span class="comment">### OR ###</span></span><br><span class="line">$ yum <span class="built_in">history</span> list</span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">ID     | Command line             | Date and time    | Action(s)      | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">     <span class="number">2</span> | install -y php-mbstring  | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">36</span> | Install        |    <span class="number">2</span></span><br><span class="line">     <span class="number">1</span> | remove php-common        | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">12</span>:<span class="number">57</span> | Erase          |    <span class="number">2</span></span><br><span class="line"><span class="built_in">history</span> list</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 列出某个指定的`historyID`</span></span><br><span class="line">$ yum <span class="built_in">history</span> list <span class="number">1</span></span><br><span class="line">Loaded plugins: axelget, fastestmirror, langpacks</span><br><span class="line">ID     | Command line             | Date and time    | Action(s)      | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">     <span class="number">1</span> | remove php-common        | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">12</span>:<span class="number">57</span> | Erase          |    <span class="number">2</span></span><br><span class="line"><span class="built_in">history</span> list</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 由历史标识(historyID)显示全部信息。</span></span><br><span class="line">$ yum <span class="built_in">history</span> info <span class="number">2</span></span><br><span class="line">Loaded plugins: axelget, fastestmirror, langpacks</span><br><span class="line">Transaction ID : <span class="number">2</span></span><br><span class="line">Begin time     : Sat Sep <span class="number">12</span> <span class="number">14</span>:<span class="number">36</span>:<span class="number">30</span> <span class="number">2015</span></span><br><span class="line">Begin rpmdb    : <span class="number">1273</span>:d5fafe71514a5f40941114c75679544fcb3f2d30</span><br><span class="line">End time       :                           (<span class="number">0</span> seconds)</span><br><span class="line">End rpmdb      : <span class="number">1275</span>:<span class="number">08</span>e0ab8a5924efd808d9de461722e9376fe2e529</span><br><span class="line">User           : root &lt;root&gt;</span><br><span class="line">Return-Code    : Success</span><br><span class="line">Command Line   : install -y php-mbstring</span><br><span class="line">Transaction performed with:</span><br><span class="line">    Installed     rpm-<span class="number">4.11</span>.<span class="number">1</span>-<span class="number">25</span>.el7.x86_64                      @anaconda</span><br><span class="line">    Installed     yum-<span class="number">3.4</span>.<span class="number">3</span>-<span class="number">125</span>.el7.centos.noarch               @anaconda</span><br><span class="line">    Installed     yum-plugin-fastestmirror-<span class="number">1.1</span>.<span class="number">31</span>-<span class="number">29</span>.el7.noarch @anaconda</span><br><span class="line">Packages Altered:</span><br><span class="line">    Dep-Install php-common-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1.x86_64   @updates</span><br><span class="line">    Install     php-mbstring-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1.x86_64 @updates</span><br><span class="line"><span class="built_in">history</span> info</span><br><span class="line"></span><br><span class="line"><span class="comment">#4 Shows summary of lates operations.</span></span><br><span class="line">Loaded plugins: axelget, fastestmirror, langpacks</span><br><span class="line">Login user                 | Time                | Action(s)        | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">root &lt;root&gt;                | Last day            | E, I             |        <span class="number">6</span></span><br><span class="line"><span class="built_in">history</span> summary</span><br><span class="line"></span><br><span class="line"><span class="comment">#5 yum history repeat command repeats old operation by history ID.</span></span><br><span class="line">$ yum <span class="built_in">history</span></span><br><span class="line">ID     | Command line             | Date and time    | Action(s)      | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">     <span class="number">4</span> | remove php-mbstring      | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">49</span> | Erase          |    <span class="number">1</span></span><br><span class="line">     <span class="number">3</span> | install yum-axelget.noar | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">40</span> | Install        |    <span class="number">2</span></span><br><span class="line">     <span class="number">2</span> | install -y php-mbstring  | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">14</span>:<span class="number">36</span> | Install        |    <span class="number">2</span></span><br><span class="line">     <span class="number">1</span> | remove php-common        | <span class="number">2015</span>-<span class="number">09</span>-<span class="number">12</span> <span class="number">12</span>:<span class="number">57</span> | Erase          |    <span class="number">2</span></span><br><span class="line"><span class="built_in">history</span> list</span><br><span class="line"></span><br><span class="line">$ yum <span class="built_in">history</span> repeat <span class="number">2</span></span><br><span class="line">Dependencies Resolved</span><br><span class="line">...</span><br><span class="line">Install  <span class="number">1</span> Package</span><br><span class="line"></span><br><span class="line">Total download size: <span class="number">503</span> k</span><br><span class="line">Installed size: <span class="number">1.3</span> M</span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">Downloading packages:</span><br><span class="line">php-mbstring-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1.x86_64.rpm</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction <span class="built_in">test</span></span><br><span class="line">Transaction <span class="built_in">test</span> succeeded</span><br><span class="line">Running transaction</span><br><span class="line">  Installing : php-mbstring-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1.x86_64</span><br><span class="line">  Verifying  : php-mbstring-<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1.x86_64</span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  php-mbstring.x86_64 <span class="number">0</span>:<span class="number">5.4</span>.<span class="number">16</span>-<span class="number">36</span>.el7_1</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line"><span class="comment">#5 清空History</span></span><br><span class="line">$ yum <span class="built_in">history</span> new</span><br><span class="line">Loaded plugins: dellsysidplugin2, fastestmirror, refresh-packagekit</span><br><span class="line">ID     | Login user             | Date and time    | Action(s)      | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"><span class="built_in">history</span> list</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>总结rpm和yum实现程序包的管理功能</p>
<h2 id="程序包管理"><a class="header-anchor" href="#程序包管理"></a>程序包管理</h2>
<h3 id="包管理器"><a class="header-anchor" href="#包管理器"></a>包管理器</h3>
<p><strong>打包,包管理(安装,升级,卸载,查询及校验)</strong></p>
<ul>
<li>deb: debian</li>
<li>rpm: redhat package manager --&gt; RPM is Package Manager</li>
<li>DNF:</li>
</ul>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-09-05]]></title>
    <link href="http://molloc.me/2015/09/09/ZY-2015-09-05/"/>
    <id>http://molloc.me/2015/09/09/ZY-2015-09-05/</id>
    <published>2015-09-09T14:18:46.000Z</published>
    <updated>2015-09-11T15:22:08.112Z</updated>
    <content type="html"><![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<h2 id="linux上的任务计划"><a class="header-anchor" href="#linux上的任务计划"></a>Linux上的任务计划</h2>
<h3 id="任务计划"><a class="header-anchor" href="#任务计划"></a>任务计划</h3>
<ul>
<li>在未来时间点一次性执行某任务: <code>at, batch</code></li>
<li>周期性执行某任务: <code>crontab</code></li>
</ul>
<h3 id="电子邮件服务"><a class="header-anchor" href="#电子邮件服务"></a>电子邮件服务</h3>
<ul>
<li>smtp: Simple Mail Transfer Protocol</li>
<li>POP3: Post Office Protocol - Version 3</li>
<li>imap4: Internet Message Access Protocol 4 交互式数据消息访问协议第四个版本</li>
<li>邮件用户代理（MUA，Mail User Agent）(mail,mailx)</li>
<li>邮件传送代理（MTA，Mail Transport Agent）(sendmail)</li>
<li>邮件分发代理（MDA，Mail Deliver Agent）</li>
<li>通俗的说MUA就是用户使用的客户端，而MTA则是真正发送邮件的发送进程，MUA编写的邮件最终也交由MTA发送至目标端。</li>
<li>mail和mailx即为负责查看、编写邮件和向MTA发送邮件的MUA。mailx是mail的功能加强版。</li>
<li>sendmail即为负责邮件在网络上传输的MTA，将邮件从一个MTA传送至另一个MTA。</li>
</ul>
<p>linux中mail的存放路径<code>/var/sool/mail/USERNAME</code></p>
<a id="more"></a>
<h2 id="相关命令"><a class="header-anchor" href="#相关命令"></a>相关命令</h2>
<h3 id="mailx"><a class="header-anchor" href="#mailx"></a>mailx</h3>
<p><strong>mailx - 发送和接收 Internet 邮件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">mailx [-BDdEFintv~] [<span class="operator">-s</span> subject] [<span class="operator">-a</span> attachment ] [-c cc-addr] [-b bcc-addr] [-r from-addr] [-h hops] [-A account] to-addr</span><br><span class="line">      . . .</span><br><span class="line">mailx [-BDdeEHiInNRv~] [-T name] [-A account] [-S variable[=value]] <span class="operator">-f</span> [name]</span><br><span class="line">mailx [-BDdeE<span class="keyword">in</span>NRv~] [-A account] [-S variable[=value]] [-u user]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s subject //指定邮件的主题,有空格需要引号引起来</span></span><br><span class="line">$ mailx <span class="operator">-s</span> <span class="string">'hello mailx'</span> root@localhost <span class="comment"># 进入交互式收发邮件接口</span></span><br><span class="line">hello new world.</span><br><span class="line">...</span><br><span class="line"><span class="comment">#CTRL+D (保存退出)</span></span><br><span class="line"></span><br><span class="line">$ mailx</span><br><span class="line">--&gt; Heirloom Mail version <span class="number">12.5</span> <span class="number">7</span>/<span class="number">5</span>/<span class="number">10</span>.  Type ? <span class="keyword">for</span> help.</span><br><span class="line">	<span class="string">"/var/spool/mail/root"</span>: <span class="number">3</span> messages <span class="number">1</span> new <span class="number">2</span> unread</span><br><span class="line">	 U  <span class="number">1</span> user@localhost.local  Wed Aug <span class="number">19</span> <span class="number">23</span>:<span class="number">07</span> <span class="number">709</span>/<span class="number">52085</span> <span class="string">"[abrt] full crash report"</span></span><br><span class="line">	    <span class="number">2</span> root                  Wed Sep  <span class="number">9</span> <span class="number">22</span>:<span class="number">55</span>  <span class="number">19</span>/<span class="number">619</span>   <span class="string">"hello mailx"</span></span><br><span class="line">	&gt;N  <span class="number">3</span> root                  Wed Sep  <span class="number">9</span> <span class="number">23</span>:<span class="number">01</span>  <span class="number">18</span>/<span class="number">629</span>   <span class="string">"hello mailx"</span></span><br><span class="line">&amp;(此处键入编号查看邮件内容)</span><br><span class="line">&amp;(输入quit退出)</span><br><span class="line"></span><br><span class="line">$ mailx <span class="operator">-s</span> <span class="string">'hello mailx'</span> root@localhost &lt; cat /PATH/FROM/SOMEFILE</span><br><span class="line">$ COMMAND | mailx <span class="operator">-s</span> <span class="string">'hello mailx'</span> root@localhost</span><br></pre></td></tr></table></figure>
<h3 id="at"><a class="header-anchor" href="#at"></a>at</h3>
<p><strong>at - 在一个指定的时间执行一个指定任务，只能执行一次，且需要开启atd进程,支持使用作业队列,默认使用a队列</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">at [OPTION]... TIME</span><br><span class="line"></span><br><span class="line"><span class="comment">## 常用参数</span></span><br><span class="line">-m 当指定的任务被完成之后，将给用户发送邮件，即使没有标准输出</span><br><span class="line"><span class="operator">-l</span> atq的别名</span><br><span class="line"><span class="operator">-d</span> atrm的别名</span><br><span class="line">-v 显示任务将被执行的时间</span><br><span class="line">-c 打印任务的内容到标准输出</span><br><span class="line">-V 显示版本信息</span><br><span class="line">-q&lt;列队&gt; 使用指定的列队</span><br><span class="line"><span class="operator">-f</span>&lt;文件&gt; 从指定文件读入任务而不是从标准输入读入</span><br><span class="line">-t&lt;时间参数&gt; 以时间参数的形式提交要运行的任务</span><br><span class="line"></span><br><span class="line"><span class="comment">## 操作实践</span></span><br><span class="line">$ at now+<span class="number">3</span>minutes</span><br><span class="line">at&gt; cat /etc/passwd</span><br><span class="line">&lt;CTRL+D&gt;</span><br><span class="line"></span><br><span class="line">$ atq</span><br><span class="line">--&gt; <span class="number">1</span>	Thu Sep <span class="number">10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a centos</span><br><span class="line">	<span class="number">2</span>	Wed Sep  <span class="number">9</span> <span class="number">23</span>:<span class="number">38</span>:<span class="number">00</span> <span class="number">2015</span> a admin</span><br><span class="line"></span><br><span class="line"><span class="comment">#1 三天后的下午 5 点钟执行 /bin/ls</span></span><br><span class="line">$ at <span class="number">5</span>pm + <span class="number">3</span>days</span><br><span class="line">at&gt; /bin/ls</span><br><span class="line">&lt;CTRL+D&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 明天17点钟，输出时间到指定文件内</span></span><br><span class="line">$ at <span class="number">17</span>:<span class="number">00</span> tomorrow</span><br><span class="line">at&gt; date &gt; /tmp/date.log</span><br><span class="line">&lt;CTRL+D&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#3 计划任务设定后，在没有执行之前我们可以用atq命令来查看系统没有执行工作任务</span></span><br><span class="line">$ atq</span><br><span class="line">--&gt; <span class="number">1</span>	Thu Sep <span class="number">10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a centos</span><br><span class="line">	<span class="number">3</span>	Thu Sep <span class="number">10</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a root</span><br><span class="line">	<span class="number">4</span>	Thu Sep <span class="number">10</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a root</span><br><span class="line">	<span class="number">5</span>	Thu Sep <span class="number">10</span> <span class="number">17</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a root</span><br><span class="line"></span><br><span class="line"><span class="comment">#4 删除已经设置的任务</span></span><br><span class="line">$ atrm <span class="number">5</span></span><br><span class="line">$ atq</span><br><span class="line">--&gt; <span class="number">1</span>	Thu Sep <span class="number">10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a centos</span><br><span class="line">		<span class="number">3</span>	Thu Sep <span class="number">10</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a root</span><br><span class="line">		<span class="number">4</span>	Thu Sep <span class="number">10</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">00</span> <span class="number">2015</span> a root</span><br><span class="line"></span><br><span class="line"><span class="comment">#5 显示已经设置的任务内容</span></span><br><span class="line">$ at -c <span class="number">1</span></span><br><span class="line">--&gt; <span class="comment">#!/bin/sh</span></span><br><span class="line">	<span class="comment"># atrun uid=1001 gid=1001</span></span><br><span class="line">	<span class="comment"># mail centos 0</span></span><br><span class="line">	<span class="built_in">umask</span> <span class="number">2</span></span><br><span class="line">	XDG_SESSION_ID=<span class="number">14</span>; <span class="built_in">export</span> XDG_SESSION_ID</span><br><span class="line">	HOSTNAME=kernel; <span class="built_in">export</span> HOSTNAME</span><br><span class="line">	SHELL=/bin/bash; <span class="built_in">export</span> SHELL</span><br><span class="line">	HISTSIZE=<span class="number">1000</span>; <span class="built_in">export</span> HISTSIZE</span><br><span class="line">	...</span><br><span class="line">	cat ~/.bashrc</span><br><span class="line">	marcinDELIMITER2ccbf31a</span><br></pre></td></tr></table></figure>
<hr>
<p>既然是计划任务，那么应该会有任务执行的方式，并且将这些任务排进行程表中。那么产生计划任务的方式是怎么进行的?</p>
<p>事实上，我们使用 at 这个命令来产生所要运行的计划任务，并将这个计划任务以文字档的方式写入 /var/spool/at/ 目录内，该工作便能等待 atd 这个服务的取用与运行了。就这么简单。</p>
<p>不过，并不是所有的人都可以进行 at 计划任务。为什么?</p>
<p>因为系统安全的原因。很多主机被所谓的攻击破解后，最常发现的就是他们的系统当中多了很多的黑客程序， 这些程序非常可能运用一些计划任务来运行或搜集你的系统运行信息,并定时的发送给黑客。</p>
<p>所以，除非是你认可的帐号，否则先不要让他们使用 at 命令。那怎么达到使用 at 的可控呢?</p>
<p>我们可以利用 /etc/at.allow 与 /etc/at.deny 这两个文件来进行 at 的使用限制。加上这两个文件后， at 的工作情况是这样的：</p>
<p>先找寻 /etc/at.allow 这个文件，写在这个文件中的使用者才能使用 at ，没有在这个文件中的使用者则不能使用 at (即使没有写在 at.deny 当中);
如果 /etc/at.allow 不存在，就寻找 /etc/at.deny 这个文件，若写在这个 at.deny 的使用者则不能使用 at ，而没有在这个 at.deny 文件中的使用者，就可以使用 at 命令了。</p>
<p>如果两个文件都不存在，那么只有 root 可以使用 at 这个命令。</p>
<hr>
<p>透过这个说明，我们知道 /etc/at.allow 是管理较为严格的方式，而 /etc/at.deny 则较为松散 (因为帐号没有在该文件中，就能够运行 at 了)。在一般的 distributions 当中，由于假设系统上的所有用户都是可信任的， 因此系统通常会保留一个空的 /etc/at.deny 文件，意思是允许所有人使用 at 命令的意思 (您可以自行检查一下该文件)。 不过，万一你不希望有某些使用者使用 at 的话，将那个使用者的帐号写入 /etc/at.deny 即可！ 一个帐号写一行。</p>
<p>at允许使用一套相当复杂的指定时间的方法。他能够接受在当天的hh:mm（小时:分钟）式的时间指定。</p>
<p>假如该时间已过去，那么就放在第二天执行。当然也能够使用midnight（深夜），noon（中午），teatime（饮茶时间，一般是下午4点）等比较模糊的 词语来指定时间。</p>
<p>用户还能够采用12小时计时制，即在时间后面加上AM（上午）或PM（下午）来说明是上午还是下午。 也能够指定命令执行的具体日期，指定格式为month day（月 日）或mm/dd/yy（月/日/年）或dd.mm.yy（日.月.年）。</p>
<p>指定的日期必须跟在指定时间的后面。上面介绍的都是绝对计时法，其实还能够使用相对计时法，这对于安排不久就要执行的命令是很有好处的。</p>
<p>指定格式为：now + count time-units ，now就是当前时间，timeunits是时间单位，这里能够是minutes（分钟）、hours（小时）、days（天）、weeks（星期）。count是时间的数量，究竟是几天，还是几小时，等等。</p>
<p>更有一种计时方法就是直接使用today（今天）、tomorrow（明天）来指定完成命令的时间。</p>
<h3 id="batch"><a class="header-anchor" href="#batch"></a>batch</h3>
<p>由系统自行选择在资源较为空闲时运行指定的任务；</p>
<h3 id="crontab"><a class="header-anchor" href="#crontab"></a>crontab</h3>
<p><strong>at - 周期性任务计划，且需要开启crond进程</strong></p>
<p>Linux下的任务调度分为两类，系统任务调度和用户任务调度。</p>
<ol>
<li>
<p>系统cron任务；没有默认运行用户身份，所以需要额外指定运行者；
<code>/etc/crontab</code>
vim命令
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  * user-name  command to be executed</span></span><br></pre></td></tr></table></figure></p>
<p>7个字段：
前5个字段：时间点
user-name: 以哪个用户的身份运行任务
command to be executed: 要运行任务</p>
</li>
<li>
<p>用户cron任务：由某个用户所提交，默认就以提交者的身份运行，所以无需额外指定运行者；
<code>/var/spool/cron/USERNAME</code>
vim命令；不建议
crontab命令：建议
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example of job definition:</span></span><br><span class="line"><span class="comment"># .---------------- minute (0 - 59)</span></span><br><span class="line"><span class="comment"># |  .------------- hour (0 - 23)</span></span><br><span class="line"><span class="comment"># |  |  .---------- day of month (1 - 31)</span></span><br><span class="line"><span class="comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span></span><br><span class="line"><span class="comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span></span><br><span class="line"><span class="comment"># |  |  |  |  |</span></span><br><span class="line"><span class="comment"># *  *  *  *  *  command to be executed</span></span><br></pre></td></tr></table></figure></p>
</li>
</ol>
<p>5个时间点：分钟(0-59),小时(0-23),日(1-31)月(1-12),周(0-7)</p>
<ul>
<li>注意：几月几号与4周几，不建议同时使用；*</li>
</ul>
<p>时间表示法：</p>
<ul>
<li>*: 对应时间点有效取值范围内的每个时间点；</li>
<li>-: 一个特定连续时间范围, 3-7</li>
<li>,：一个离散的时间点, 3,5,7</li>
<li>/#：有效时间范围内的每多少时间；用于指定频率；1-30/4, */4</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">at [OPTION]... TIME</span><br><span class="line">crontab [-u user] file</span><br><span class="line">crontab [-u user] [<span class="operator">-l</span> | -r | <span class="operator">-e</span>] [-i] [<span class="operator">-s</span>]</span><br><span class="line">crontab -n [ hostname ]</span><br><span class="line">crontab -c</span><br><span class="line"></span><br><span class="line"><span class="comment">## 常用参数</span></span><br><span class="line">-u user: 不是管理自己的cron任务，而是指定的目标用户的cron任务；仅root拥有管理其它用户的cron任务的权限；默认管理自己的；</span><br><span class="line"><span class="operator">-l</span>: list，列出任务；</span><br><span class="line">-r: remove, 移除所有任务；</span><br><span class="line"><span class="operator">-e</span>: edit，编辑，打开一当前shell会话的默认编辑器来编辑cron任务表；</span><br><span class="line">-i: 在删除用户的crontab文件时给确认提示。</span><br><span class="line"></span><br><span class="line"><span class="comment">## 操作实践</span></span><br><span class="line">$ crontab <span class="operator">-e</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1 用gentoo创建一个新的crontab文件</span></span><br><span class="line">$ crontab <span class="operator">-e</span></span><br><span class="line">--&gt; no crontab <span class="keyword">for</span> gentoo - using an empty one</span><br><span class="line">	crontab: installing new crontab</span><br><span class="line"></span><br><span class="line">$ crontab <span class="operator">-l</span></span><br><span class="line">--&gt; * * * * * `<span class="built_in">which</span> ls --skip-alias` .</span><br><span class="line"></span><br><span class="line"><span class="comment">#2 在crontab中使用date命令</span></span><br><span class="line">$ crontab <span class="operator">-e</span></span><br><span class="line">* * * * * `<span class="built_in">which</span> --skip-alias ls` -al . &gt; /tmp/gentoo.$(date <span class="string">'+\%F %T'</span>).log</span><br></pre></td></tr></table></figure>
<h2 id="注意事项"><a class="header-anchor" href="#注意事项"></a>注意事项</h2>
<p>有时我们创建了一个crontab，但是这个任务却无法自动执行，而手动执行这个任务却没有问题，这种情况一般是由于在crontab文件中没有配置环境变量引起的。
在crontab文件中定义多个调度任务时，需要特别注意的一个问题就是环境变量的设置，因为我们手动执行某个任务时，是在当前shell环境下进行的，程序当然能找到环境变量，而系统自动执行任务调度时，是不会加载任何环境变量的，因此，就需要在crontab文件中指定任务运行所需的所有环境变量，这样，系统执行任务调度时就没有问题了。
不要假定cron知道所需要的特殊环境，它其实并不知道。所以你要保证在shelll脚本中提供所有必要的路径和环境变量，除了一些自动设置的全局变量。所以注意如下3点：</p>
<ol>
<li>脚本中涉及文件路径时写全局路径；</li>
<li>脚本执行要用到java或其他环境变量时，通过source命令引入环境变量，如：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat start_cbp.sh</span><br><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="built_in">export</span> RUN_CONF=/home/d139/conf/platform/cbp/cbp_jboss.conf</span><br><span class="line">/usr/<span class="built_in">local</span>/jboss-<span class="number">4.0</span>.<span class="number">5</span>/bin/run.sh -c mev &amp;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>当手动执行脚本OK，但是crontab死活不执行时。这时必须大胆怀疑是环境变量惹的祸，并可以尝试在crontab中直接引入环境变量解决问题。如：</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> * * * * . /etc/profile;/bin/sh /var/www/java/audit_no_count/bin/restart_audit.sh</span><br></pre></td></tr></table></figure>
<h3 id="注意清理系统用户的邮件日志"><a class="header-anchor" href="#注意清理系统用户的邮件日志"></a>注意清理系统用户的邮件日志</h3>
<p>每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。
例如，可以在crontab文件中设置如下形式，忽略日志输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> */<span class="number">3</span> * * * /usr/<span class="built_in">local</span>/apache2/apachectl restart &gt;/dev/null <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p><code>/dev/null 2&gt;&amp;1</code>表示先将标准输出重定向到<code>/dev/null</code>，然后将标准错误重定向到标准输出，由于标准输出已经重定向到了<code>/dev/null</code>，因此标准错误也会重定向到/dev/null，这样日志输出问题就解决了。</p>
<h3 id="系统级任务调度与用户级任务调度"><a class="header-anchor" href="#系统级任务调度与用户级任务调度"></a>系统级任务调度与用户级任务调度</h3>
<p>系统级任务调度主要完成系统的一些维护操作，用户级任务调度主要完成用户自定义的一些任务，可以将用户级任务调度放到系统级任务调度来完成（不建议这么做），但是反过来却不行，root用户的任务调度操作可以通过<code>crontab –uroot –e</code>来设置，也可以将调度任务直接写入/etc/crontab文件，需要注意的是，如果要定义一个定时重启系统的任务，就必须将任务放到<code>/etc/crontab</code>文件，即使在root用户下创建一个定时重启系统的任务也是无效的。</p>
<h3 id="其他注意事项"><a class="header-anchor" href="#其他注意事项"></a>其他注意事项</h3>
<p>新创建的cron job，不会马上执行，至少要过2分钟才执行。如果重启cron则马上执行。
当crontab突然失效时，可以尝试<code>/etc/init.d/crond restart</code>解决问题。或者查看日志看某个job有没有执行/报错<code>tail -f /var/log/cron</code>。
千万别乱运行crontab -r。它从Crontab目录（/var/spool/cron）中删除用户的Crontab文件。删除了该用户的所有crontab都没了。
在crontab中%是有特殊含义的，表示换行的意思。如果要用的话必须进行转义%，如经常用的date ‘+%Y%m%d’在crontab里是不会执行的，应该换成<code>date &quot;+\%Y\%m\%d&quot;</code>。</p>
<hr>
<p><strong>每周一到周六的凌晨3点20分，运行cp命令对/etc/目录进行归档另存，存储位置为<code>/backups/etc-YYYY-MM-DD</code>;</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">20</span> <span class="number">3</span> * * <span class="number">1</span>-<span class="number">6</span> `<span class="built_in">which</span> cp` <span class="operator">-a</span> /etc/ /backups/etc-$(date <span class="string">'+\%F'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>每周日凌晨2点30分，运行cp命令对/etc/fstab文件进行备份，存储位置为<code>/backups/fstab-YYYY-MM-DD-hh-mm-ss</code>;</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">30</span> <span class="number">2</span> * * <span class="number">0</span> `<span class="built_in">which</span> cp` <span class="operator">-a</span> /etc/fstab /backups/fstab-$(date <span class="string">'+\%F-\%H-\%M-\%S'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>每天晚上12点，取得/proc/meminfo文件中所有以S或M开头的行，追加至<code>/statistics/meminfo.txt</code>文件中，且每天的消息之前，要加上类似===============分隔线;</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">0</span> * * * <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">'\033[31m===========================\033[0m'</span> &gt;&gt; /statistics/meminfo.txt; \</span><br><span class="line">cat /proc/meminfo | egrep <span class="string">'^(S|M)'</span> &gt;&gt; /statistics/meminfo.txt</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<h2 id="linux上的任务计划"><a class="header-anchor" href="#linux上的任务计划"></a>Linux上的任务计划</h2>
<h3 id="任务计划"><a class="header-anchor" href="#任务计划"></a>任务计划</h3>
<ul>
<li>在未来时间点一次性执行某任务: <code>at, batch</code></li>
<li>周期性执行某任务: <code>crontab</code></li>
</ul>
<h3 id="电子邮件服务"><a class="header-anchor" href="#电子邮件服务"></a>电子邮件服务</h3>
<ul>
<li>smtp: Simple Mail Transfer Protocol</li>
<li>POP3: Post Office Protocol - Version 3</li>
<li>imap4: Internet Message Access Protocol 4 交互式数据消息访问协议第四个版本</li>
<li>邮件用户代理（MUA，Mail User Agent）(mail,mailx)</li>
<li>邮件传送代理（MTA，Mail Transport Agent）(sendmail)</li>
<li>邮件分发代理（MDA，Mail Deliver Agent）</li>
<li>通俗的说MUA就是用户使用的客户端，而MTA则是真正发送邮件的发送进程，MUA编写的邮件最终也交由MTA发送至目标端。</li>
<li>mail和mailx即为负责查看、编写邮件和向MTA发送邮件的MUA。mailx是mail的功能加强版。</li>
<li>sendmail即为负责邮件在网络上传输的MTA，将邮件从一个MTA传送至另一个MTA。</li>
</ul>
<p>linux中mail的存放路径<code>/var/sool/mail/USERNAME</code></p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-08-27]]></title>
    <link href="http://molloc.me/2015/08/30/ZY-2015-08-27/"/>
    <id>http://molloc.me/2015/08/30/ZY-2015-08-27/</id>
    <published>2015-08-29T16:00:33.000Z</published>
    <updated>2015-09-11T15:22:07.648Z</updated>
    <content type="html"><![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>本文涉及的命令有: chmod, chown, chgrp, umask, grep, egrep</em></p>
<a id="more"></a>
<h2 id="linux文件系统的权限"><a class="header-anchor" href="#linux文件系统的权限"></a>Linux文件系统的权限</h2>
<p>属主(owner, u), 属组(group, g), 其他用户(other, o):
rwx, rwx, rwx</p>
<p>对应当前资源,每类账户都通过三位权限限定.(000-111: 0-7)</p>
<h2 id="权限管理相关命令"><a class="header-anchor" href="#权限管理相关命令"></a>权限管理相关命令</h2>
<ul>
<li>权限管理 chmod</li>
<li>所属关系管理: chown, chgrp</li>
<li>文件遮罩码: umask</li>
</ul>
<h2 id="chmod"><a class="header-anchor" href="#chmod"></a>chmod</h2>
<p><strong>chmod - 修改文件的权限</strong></p>
<h3 id="基本用法"><a class="header-anchor" href="#基本用法"></a>基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-R: recursive <span class="comment">#递归修改权限</span></span><br></pre></td></tr></table></figure>
<h3 id="二种用法"><a class="header-anchor" href="#二种用法"></a>二种用法</h3>
<ol>
<li>操作指定类别用户的权限</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=model</span><br><span class="line">	=rx, =r, =</span><br><span class="line">	ug=rx, go=, a=</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>操作某类用户的某位或某些位权限<code>+|-</code></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[\+|-]mode</span><br><span class="line">	u\+r,</span><br><span class="line">		\+x</span><br><span class="line">		\+w</span><br></pre></td></tr></table></figure>
<h3 id="操作实践"><a class="header-anchor" href="#操作实践"></a>操作实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">chmod [OPTION]... MODE[,MODE]... FILE...</span><br><span class="line">chmod [OPTION]... OCTAL-MODE FILE...</span><br><span class="line">chmod [OPTION]... --reference=RFILE FILE...</span><br><span class="line"></span><br><span class="line">$ chmod u=r file <span class="comment">#会覆盖掉已有的权限</span></span><br><span class="line">--&gt; -r--rwxrwx <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">29</span> <span class="number">15</span>:<span class="number">12</span> file</span><br><span class="line"></span><br><span class="line">$ chmod u+wx file</span><br><span class="line">--&gt; -rwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">29</span> <span class="number">15</span>:<span class="number">12</span> file</span><br><span class="line"></span><br><span class="line">$ ll</span><br><span class="line">-rw-rw-rw- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> a</span><br><span class="line">-rw-r--r-- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> b</span><br><span class="line"></span><br><span class="line"><span class="comment">## 参考文件a的权限修改b的权限</span></span><br><span class="line">$ chmod --reference=a b</span><br><span class="line">$ ll</span><br><span class="line">--&gt; -rw-rw-rw- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> a</span><br><span class="line">	-rw-rw-rw- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> b</span><br><span class="line"></span><br><span class="line">$ chmod u-r,g-w c</span><br><span class="line">--&gt; --w-r--rw- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> c</span><br><span class="line"></span><br><span class="line"><span class="comment">#eg:复制/etc/skel目录为/home/tuser1,要求/home/tuser1及其内部文件的属组和其它用户均没有任何访问权限.</span></span><br><span class="line">$ cp -R /etc/skel/ /home/tuser1/</span><br><span class="line">$ chmod go= -R /home/tuser1</span><br><span class="line">$ ll <span class="operator">-a</span> tuser1/</span><br><span class="line">--&gt; drwx------  <span class="number">4</span> root root <span class="number">4096</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .</span><br><span class="line">	drwxr-xr-x. <span class="number">7</span> root root <span class="number">4096</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> ..</span><br><span class="line">	-rw-------  <span class="number">1</span> root root   <span class="number">18</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .bash_<span class="built_in">logout</span></span><br><span class="line">	-rw-------  <span class="number">1</span> root root  <span class="number">176</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .bash_profile</span><br><span class="line">	-rw-------  <span class="number">1</span> root root  <span class="number">124</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .bashrc</span><br><span class="line">	drwx------  <span class="number">2</span> root root <span class="number">4096</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .gnome2</span><br><span class="line">	drwx------  <span class="number">4</span> root root <span class="number">4096</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">34</span> .mozilla</span><br></pre></td></tr></table></figure>
<h2 id="chown"><a class="header-anchor" href="#chown"></a>chown</h2>
<p><strong>chown - 修改文件的属主或属组</strong></p>
<h3 id="基本用法-v2"><a class="header-anchor" href="#基本用法-v2"></a>基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">chown [OPTION]... [OWNER][:[GROUP]] FILE...</span><br><span class="line">chown [OPTION]... --reference=RFILE FILE...</span><br><span class="line"></span><br><span class="line">-R, --recursive <span class="comment"># 递归操纵文件或目录</span></span><br><span class="line"></span><br><span class="line">USER <span class="comment"># 只改属主</span></span><br><span class="line">USER:GROUP(USER.GROUP) <span class="comment"># 同时修改属主,属主</span></span><br></pre></td></tr></table></figure>
<h3 id="操作实践-v2"><a class="header-anchor" href="#操作实践-v2"></a>操作实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改b文件的属主为gentoo</span></span><br><span class="line">$ chown gentoo b</span><br><span class="line">$ ll b</span><br><span class="line">--&gt; -rw-rw-rw- <span class="number">1</span> gentoo root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改b文件的属主,属组为centos</span></span><br><span class="line">$ chown centos:centos b</span><br><span class="line">$ ll</span><br><span class="line">--&gt; -rw-rw-rw- <span class="number">1</span> centos centos <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参照文件b的属主,属主为a设置</span></span><br><span class="line">$ ll a</span><br><span class="line">--&gt; -rw-rw-rw- <span class="number">1</span> root root <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> a</span><br><span class="line">$ chown --reference=b a</span><br><span class="line">$ ll a b</span><br><span class="line">--&gt; -rw-rw-rw- <span class="number">1</span> centos centos <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> a</span><br><span class="line">	-rw-rw-rw- <span class="number">1</span> centos centos <span class="number">0</span> Nov <span class="number">30</span> <span class="number">13</span>:<span class="number">37</span> b</span><br></pre></td></tr></table></figure>
<h2 id="chgrp"><a class="header-anchor" href="#chgrp"></a>chgrp</h2>
<p><strong>chgrp - 修改组</strong></p>
<h3 id="基本用法-v3"><a class="header-anchor" href="#基本用法-v3"></a>基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">chgrp [OPTION]... GROUP FILE...</span><br><span class="line">chgrp [OPTION]... --reference=RFILE FILE...</span><br><span class="line"></span><br><span class="line">-R, --recursive <span class="comment"># 递归操纵文件或目录</span></span><br></pre></td></tr></table></figure>
<h2 id="umask"><a class="header-anchor" href="#umask"></a>umask</h2>
<p><strong>umask - 设定和显示遮罩码</strong></p>
<h3 id="操作实践-v3"><a class="header-anchor" href="#操作实践-v3"></a>操作实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示遮罩码</span></span><br><span class="line">$ <span class="built_in">umask</span></span><br><span class="line">--&gt; <span class="number">0022</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置遮罩码, 仅对当前shell进程有效</span></span><br><span class="line">$ <span class="built_in">umask</span> <span class="number">0002</span></span><br><span class="line">$ <span class="built_in">umask</span></span><br><span class="line">--&gt; <span class="number">0002</span></span><br></pre></td></tr></table></figure>
<h2 id="grep"><a class="header-anchor" href="#grep"></a>grep</h2>
<ul>
<li>Linux文本处理三剑客
<ol>
<li>grep: 文本过滤工具；</li>
<li>sed：文本编辑器(行)；stream editor</li>
<li>awk：文本报告生成器；Linux上awk的实现为gawk</li>
</ol>
</li>
<li>作用: 文本搜索工具,根据用户制定的'模式(pattern)'逐行去搜索目标文本,打印匹配到的行.</li>
<li>模式: 有正则表达式的元字符及文本字符所编写的过滤条件.</li>
<li>元字符: 字符不表示其字面的意义,而用于表示通配或控制功能.</li>
<li>BRE: 基本正则表达式</li>
<li>ERE: 扩展正则表达式</li>
</ul>
<h3 id="基本用法-v4"><a class="header-anchor" href="#基本用法-v4"></a>基本用法</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">grep [OPTIONS] PATTERN [FILE...]</span><br><span class="line">grep [OPTIONS] [<span class="operator">-e</span> PATTERN | <span class="operator">-f</span> FILE] [FILE...]</span><br><span class="line"></span><br><span class="line">--color=auto <span class="comment"># 对匹配到的行做高亮显示</span></span><br><span class="line">-v, --invert-match <span class="comment">#显示模式匹配不到的行</span></span><br><span class="line">-i, --ignore-case <span class="comment"># 忽略字符大小写</span></span><br><span class="line">-q, --quiet, --silent <span class="comment"># 静默模式, 不输出到标准输出</span></span><br><span class="line">-E, --extended-regexp <span class="comment"># 解释模式问扩展的正则表达式</span></span><br><span class="line">-P, --perl-regexp <span class="comment"># 解释模式作为一个Perl的正则表达式。这是高度的实验和grep -P可以警告未实现的功能。</span></span><br><span class="line">-c, --count <span class="comment"># 输出匹配到的行数</span></span><br></pre></td></tr></table></figure>
<h3 id="操作实践-v4"><a class="header-anchor" href="#操作实践-v4"></a>操作实践</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出匹配到的行数</span></span><br><span class="line">$ grep <span class="string">'bash\&gt;'</span> /etc/passwd -c</span><br><span class="line">--&gt; <span class="number">6</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="基本正则表达式"><a class="header-anchor" href="#基本正则表达式"></a>基本正则表达式</h2>
<h3 id="字符匹配"><a class="header-anchor" href="#字符匹配"></a>字符匹配</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.: 			<span class="comment"># 匹配任意单个字符；</span></span><br><span class="line">[]：		<span class="comment"># 匹配指定范围内的任意单个字符；</span></span><br><span class="line">[^]：		<span class="comment"># 匹配指定范围内的任意单个字符；</span></span><br><span class="line">[:lower:]   <span class="comment"># 小写字符</span></span><br><span class="line">[:upper:]   <span class="comment"># 大写字符</span></span><br><span class="line">[:alnum:]   <span class="comment"># 文字数字字符</span></span><br><span class="line">[:digit:]   <span class="comment"># 数字字符</span></span><br><span class="line">[:space:]   <span class="comment"># 所有空白字符（新行，空格，制表符)</span></span><br><span class="line">[:blank:]   <span class="comment"># 空格或制表符</span></span><br><span class="line">[:punct:]   <span class="comment"># 标点符号</span></span><br><span class="line">[:alpha:]   <span class="comment"># 文字字符</span></span><br><span class="line">[:blank:]   <span class="comment"># 空格或制表符</span></span><br><span class="line">[:cntrl:]   <span class="comment"># 控制字符</span></span><br><span class="line">[:graph:]   <span class="comment"># 非空字符（非空格、控制字符）</span></span><br><span class="line">[:<span class="built_in">print</span>:]   <span class="comment"># 非空字符（包括空格）</span></span><br><span class="line">[:xdigit:]  <span class="comment"># 十六进制数字（0-9，a-f，A-F）</span></span><br></pre></td></tr></table></figure>
<h3 id="次数匹配"><a class="header-anchor" href="#次数匹配"></a>次数匹配</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?      <span class="comment"># 0到1次</span></span><br><span class="line">*      <span class="comment"># 0到多次</span></span><br><span class="line">+      <span class="comment"># 1到多次</span></span><br><span class="line">&#123;n&#125;    <span class="comment"># 匹配n次</span></span><br><span class="line">&#123;n,&#125;   <span class="comment"># 至少匹配n次</span></span><br><span class="line">&#123;,m&#125;   <span class="comment"># 最多m次</span></span><br><span class="line">&#123;n,m&#125;  <span class="comment"># 最少n次,最多m次</span></span><br><span class="line">.* 	   <span class="comment"># 匹配任意长度的任意字符</span></span><br></pre></td></tr></table></figure>
<h3 id="位置锚定："><a class="header-anchor" href="#位置锚定："></a>位置锚定：</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">^: 			<span class="comment"># 行首锚定；用于模式的最左侧；</span></span><br><span class="line">$: 			<span class="comment"># 行尾锚定；用于模式的最右侧；(用单引号)</span></span><br><span class="line">\&lt;, \b: 	<span class="comment"># 词首锚定；用于表示单词的模式的左侧；</span></span><br><span class="line">\&gt;, \b：	<span class="comment"># 词尾锚定；用于表示单词的模式的右侧；</span></span><br><span class="line">^$: 		<span class="comment"># 空白行</span></span><br></pre></td></tr></table></figure>
<h3 id="分组："><a class="header-anchor" href="#分组："></a>分组：()</h3>
<p>分组的小括号中的模式匹配到的内容,会在执行过程中被正则表达式引擎记录下来,并保存在内置变量中,这些变量分别是\1,\2...</p>
<p>\1: 从左侧起,第一个左括号,以及与之配对的右括号中间的模式所匹配到的内容.</p>
<p>\2: ...</p>
<p>向后引用: 使用变量引用前面的分组括号中的模式所匹配到的字符.</p>
<h2 id="扩展的正则表达式"><a class="header-anchor" href="#扩展的正则表达式"></a>扩展的正则表达式</h2>
<h3 id="grep家庭有三个命令"><a class="header-anchor" href="#grep家庭有三个命令"></a>grep家庭有三个命令</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="comment">#基本正则表达式</span></span><br><span class="line">	-E <span class="comment">#扩展正则表达式</span></span><br><span class="line">	-F <span class="comment">#不支持正则表达式</span></span><br><span class="line">egrep <span class="comment">#扩展正则表达式</span></span><br><span class="line">fgrep <span class="comment">#不支持正则表达式</span></span><br></pre></td></tr></table></figure>
<h3 id="字符匹配-v2"><a class="header-anchor" href="#字符匹配-v2"></a>字符匹配</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">. 	<span class="comment"># 任意单个字符</span></span><br><span class="line">[]</span><br><span class="line">[^]</span><br></pre></td></tr></table></figure>
<h3 id="次数匹配-v2"><a class="header-anchor" href="#次数匹配-v2"></a>次数匹配</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">?: 		<span class="comment"># 0次或1次；</span></span><br><span class="line">+: 		<span class="comment"># 1次以上；</span></span><br><span class="line">&#123;m&#125;: 	<span class="comment"># 精确匹配m次；</span></span><br><span class="line">&#123;m,n&#125;:  <span class="comment"># 至少m次，至多n次；</span></span><br></pre></td></tr></table></figure>
<h3 id="位置锚定"><a class="header-anchor" href="#位置锚定"></a>位置锚定</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">^: 		<span class="comment"># 行首锚定；用于模式的最左侧；</span></span><br><span class="line">$: 		<span class="comment"># 行尾锚定；用于模式的最右侧；(用单引号)</span></span><br><span class="line">\&lt;, \b: <span class="comment"># 词首锚定；用于表示单词的模式的左侧；</span></span><br><span class="line">\&gt;, \b：<span class="comment"># 词尾锚定；用于表示单词的模式的右侧；</span></span><br><span class="line">^$: 	<span class="comment"># 空白行</span></span><br></pre></td></tr></table></figure>
<h3 id="或者"><a class="header-anchor" href="#或者"></a>或者</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(a|b)wk <span class="comment"># awk或者bwk</span></span><br></pre></td></tr></table></figure>
<ul>
<li>显示/etc/passwd文件中以bash结尾的行</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep <span class="string">'bash$'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/1.png" alt="command" title="1.png"></p>
<ul>
<li>显示/etc/passwd文件中的两位数或三位数</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep <span class="string">'\&lt;[[:digit:]]&#123;2,3&#125;\&gt;'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/2.png" alt="command" title="2.png"></p>
<ul>
<li>显示<code>netstat -tan</code>命令结果中以'LISTEN'后跟0个、1个或者多个空白字符结尾的行</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nat | egrep <span class="string">'\&lt;LISTEN[[:blank:]]*'</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/3.png" alt="command" title="3.png"></p>
<ul>
<li>添加用户bash、testbash、basher以及nologin用户（nologin用户的shell为/sbin/nologin）；而后找出/etc/                  passwd文件中用户名与其shell名相同的行</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep <span class="string">'^([[:alnum:]]*\&gt;).*\1$'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/4.png" alt="command" title="4.png"></p>
<ul>
<li>显示当前系统上root、centos或者user1用户的默认shell和UID （请事先创建这些用户，若不存在）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep <span class="string">'^(centos|user1|root)'</span> /etc/passwd | cut <span class="operator">-d</span>: <span class="operator">-f</span>3,<span class="number">7</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/5.png" alt="command" title="5.png"></p>
<ul>
<li>找出/etc/rc.d/init.d/functions文件中某单词（单词中间可以存在下划线）后面跟着一组小括号的行</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep <span class="string">'([[:alpha:]]|_)+\(\)'</span> /etc/rc.d/init.d/<span class="built_in">functions</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/6.png" alt="command" title="6.png"></p>
<ul>
<li>使用echo输出一个路径，而后egrep找出其路径基名；进一步的使用egrep取出其目录名</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'/usr/local/bin/'</span> | egrep <span class="string">'\&lt;[[:alnum:]]*([[:alnum:]]|/)$'</span> -o</span><br></pre></td></tr></table></figure>
<ul>
<li>找出ifconfig命令执行结果中1-255之间的数字</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig | egrep <span class="string">'\&lt;(1?[1-9]&#123;1,2&#125;|2[0-5]&#123;2&#125;)\&gt;'</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.molloc.com/linux/imgs/ZY-2015-08-27/8.png" alt="command" title="8.png"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>本文涉及的命令有: chmod, chown, chgrp, umask, grep, egrep</em></p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-08-25]]></title>
    <link href="http://molloc.me/2015/08/25/ZY-2015-08-25/"/>
    <id>http://molloc.me/2015/08/25/ZY-2015-08-25/</id>
    <published>2015-08-25T15:39:11.000Z</published>
    <updated>2015-09-11T15:22:07.723Z</updated>
    <content type="html"><![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>用户和组管理的相关命令,useradd、usermod、passwd、userdel groupadd、groupmod、gpasswd、groupdel chage、chsh、chfn id、su</em></p>
<a id="more"></a>
<h2 id="权限-rwx"><a class="header-anchor" href="#权限-rwx"></a>权限(rwx)</h2>
<h3 id="针对文件"><a class="header-anchor" href="#针对文件"></a>针对文件</h3>
<ul>
<li>r: 可以用查看工具查看其内容</li>
<li>w: 可以编译其内容</li>
<li>x: 可将此文件向内核提请启动为进程</li>
</ul>
<h3 id="针对目录"><a class="header-anchor" href="#针对目录"></a>针对目录</h3>
<ul>
<li>r: 可以使用<code>ls</code>命令列出其内部的所有文件或子目录的相关信息(Note: 不包括<code>ls -l</code>)</li>
<li>w: 可在此目录内创建和删除文件</li>
<li>x: 可以<code>cd</code>进此目录,可以使用<code>ls -l</code>查看其内部的所有文件或子目录的相关详细信息</li>
</ul>
<h2 id="权限匹配机制"><a class="header-anchor" href="#权限匹配机制"></a>权限匹配机制</h2>
<p>用户启动某进程访问某资源文件时,权限匹配规则:</p>
<ol>
<li>首先查看次进程的属主,与被访问的文件的属主是否是同一个用户.
<ul>
<li>如果是,则以被访问文件的属主的权限访问,从而应用的权限为属主的权限.</li>
<li>否则,进入2.</li>
</ul>
</li>
<li>查看此进程的属主,是否属于被访问文件的属组
<ul>
<li>如果是,则以被访问文件的属组的权限访问,从而应用的权限为属组的权限.</li>
<li>否则,应用其他类别的权限.</li>
</ul>
</li>
</ol>
<h2 id="linux用户和组的相关配置文件"><a class="header-anchor" href="#linux用户和组的相关配置文件"></a>Linux用户和组的相关配置文件</h2>
<h3 id="etc-passwd"><a class="header-anchor" href="#etc-passwd"></a>/etc/passwd</h3>
<p>用户名,UID,基本信息等.</p>
<p>name:password:UID:GID:GECOS:directory:shell</p>
<p>登录名:x:UID:GID:comment:主目录:用户默认shell</p>
<h3 id="etc-shadow"><a class="header-anchor" href="#etc-shadow"></a>/etc/shadow</h3>
<p>用户密码及相关属性</p>
<p>login name:encrypted password:date of last password change:minimum password age:maximum password age:password warning period:password inactivity period:account expiration date:reserved field</p>
<ol>
<li>login name: 登录名</li>
<li>encrypted password: 加密后的密码</li>
<li>date of last password change: 最近一次密码修改时间(相对于1970-1-1的天数)</li>
<li>minimum password age: 密码的最小期限,0是不限制,相对于上次修改密码的日期而言的一个相对时长,单位为天.</li>
<li>maximum password age: 密码最大使用期限. 限制用户必须周期性改密码</li>
<li>password warning period: 密码警告周期.相对于密码最大使用期限而言,单位为天.0表示不警告.</li>
<li>password inactivity period: 密码的非活动期限.超出非活动期限后,账号将被锁定.</li>
<li>account expiration date: 账号的过期期限.(相对于1970-1-1的天数)</li>
<li>reserved field: 预留字段</li>
</ol>
<h3 id="密码规则"><a class="header-anchor" href="#密码规则"></a>密码规则</h3>
<p>$6$YNzGOv5VyXxmDU2n$PxariU7Ag0mBlzBoNLWUjubn9OBtoLJauXIfoRqQ1FtZt058FrQKJO6QVJTUXkP4LUKPsiH7ejWo8bg6c4RrC1</p>
<p>$加密算法$8位随机字符$加密后的密码</p>
<h4 id="单向加密"><a class="header-anchor" href="#单向加密"></a>单向加密</h4>
<ul>
<li>雪崩效应：初始条件的微小改变,导致结果的巨大改变.</li>
<li>定长输出：</li>
</ul>
<p>eg: <code>md5(centos5), sha1, sha224, sha256, sha384, sha512(centos6.6,centos7用的加密算法)</code></p>
<h3 id="etc-group"><a class="header-anchor" href="#etc-group"></a>/etc/group</h3>
<p>组名,GID,组内包含的用户.</p>
<p>group_name:password:GID:user_list</p>
<p>组名:组密码:以此组为附加组的用户</p>
<h3 id="etc-gshadow"><a class="header-anchor" href="#etc-gshadow"></a>/etc/gshadow</h3>
<p>组的密码及相关属性</p>
<h2 id="密码的复杂性策略"><a class="header-anchor" href="#密码的复杂性策略"></a>密码的复杂性策略</h2>
<ul>
<li>使用数字、小写字母、大写字母、特殊字符四类中至少三类；</li>
<li>足够长；</li>
<li>使用随机密码；</li>
<li>定期更换；</li>
</ul>
<h2 id="useradd"><a class="header-anchor" href="#useradd"></a>useradd</h2>
<p><strong>useradd - 创建一个新用户或更新默认新用户信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">useradd [options] LOGIN</span><br><span class="line">useradd -D</span><br><span class="line">useradd -D [options]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -r, --system 创建一个系统用户</span></span><br><span class="line">$ useradd -r admin</span><br><span class="line">$ id admin</span><br><span class="line">--&gt; uid=<span class="number">496</span>(admin) gid=<span class="number">493</span>(admin) groups=<span class="number">493</span>(admin)</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u, --uid UID 制定UID</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -g, --gid GROUP 指定用户所属基本组，此组必须事先存在</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c, --comment COMMENT 对创建的用户提供简短的描述</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d, --home HOME_DIR /PATH/TO/SOMEWHERE：指定用户的主目录路径；此位置不能事先存在，</span></span><br><span class="line"><span class="comment">## 否则，其用户相关配置文件将不会被复制；(/etc/skel)</span></span><br><span class="line">$ useradd non <span class="operator">-d</span> /tmp</span><br><span class="line">--&gt; useradd: warning: the home directory already exists.</span><br><span class="line">	Not copying any file from skel directory into it.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s SHELL：设定用户的默认shell；shell的类型请用 cat /etc/shells查看</span></span><br><span class="line">$ useradd non <span class="operator">-d</span> /tmp/non <span class="operator">-s</span> /etc/tcsh</span><br><span class="line">$ finger non</span><br><span class="line">--&gt; Login: non            			Name:</span><br><span class="line">	Directory: /tmp/non             Shell: /etc/tcsh</span><br><span class="line">	Never logged in.</span><br><span class="line">	No mail.</span><br><span class="line">	No Plan.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -G GID,...：指定所属的附加组；可指定多个,用逗号隔开,中间不能留空白</span></span><br><span class="line">$ useradd -G root,admin,centos non</span><br><span class="line">$ id non</span><br><span class="line">--&gt; uid=<span class="number">501</span>(non) gid=<span class="number">501</span>(non) groups=<span class="number">501</span>(non),<span class="number">0</span>(root),<span class="number">500</span>(centos),<span class="number">493</span>(admin)</span><br><span class="line"></span><br><span class="line"><span class="comment">## -M 不给用户创建家目录</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 强制创建主目录</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">##  -k, --skel SKEL_DIR 骨架目录，其中包含的文件和目录进行复制到用户的主目录，在主目录通过useradd的创建时。</span></span><br><span class="line">$ ls <span class="operator">-a</span> /ect/skel</span><br><span class="line">--&gt; .bash_<span class="built_in">logout</span>  .bash_profile  .bashrc  .gnome2  .mozilla</span><br><span class="line"></span><br><span class="line"><span class="comment">## 练习：创建用户Oracle，所属附加组database和sql，ID号为3000, 家目录为/home/database；</span></span><br><span class="line">$ useradd <span class="operator">-d</span> /home/database -G database,sql -u <span class="number">3000</span> Oracle</span><br><span class="line">$ id Oracle</span><br><span class="line">--&gt; uid=<span class="number">3000</span>(Oracle) gid=<span class="number">3000</span>(Oracle) groups=<span class="number">3000</span>(Oracle),<span class="number">502</span>(database),<span class="number">503</span>(sql)</span><br></pre></td></tr></table></figure>
<h2 id="usermod"><a class="header-anchor" href="#usermod"></a>usermod</h2>
<p><strong>usermod - 修改用户信息</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">usermod [options] LOGIN</span><br><span class="line"></span><br><span class="line"><span class="comment">## -a, --append 与-G配合使用</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u, --uid UID 修改用户的uid</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -G GID[,GID,...]：修改用户所属的附加组；同时使用-a选项,追加到已有的附加组.不会覆盖</span></span><br><span class="line">$ usermod <span class="operator">-a</span>G centos non</span><br><span class="line">--&gt; uid=<span class="number">3001</span>(non) gid=<span class="number">3001</span>(non) groups=<span class="number">3001</span>(non),<span class="number">500</span>(centos)</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s SHELL 修改shell</span></span><br><span class="line">$ usermod <span class="operator">-s</span> /bin/tcsh non</span><br><span class="line">$ tail -n <span class="number">1</span> /etc/passwd</span><br><span class="line">--&gt; non:x:<span class="number">3003</span>:<span class="number">3003</span>::/home/non:/bin/tcsh</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 'COMMENT'</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d HOME: 修改用户的家目录为新位置时，用户原来的文件是不会被移动至新家；-m选项可实现同时将其迁至新的家目录；</span></span><br><span class="line">$ usermod -md /home/non_new non</span><br><span class="line">$ tail -n <span class="number">1</span> /etc/passwd</span><br><span class="line">--&gt; non:x:<span class="number">3003</span>:<span class="number">3003</span>::/home/non_new:/bin/tcsh</span><br><span class="line">$ ll <span class="operator">-a</span> /home/non_new/</span><br><span class="line">--&gt; total <span class="number">28</span></span><br><span class="line">	drwx------  <span class="number">4</span> non  non  <span class="number">4096</span> Dec  <span class="number">1</span> <span class="number">14</span>:<span class="number">59</span> .</span><br><span class="line">	drwxr-xr-x. <span class="number">7</span> root root <span class="number">4096</span> Dec  <span class="number">1</span> <span class="number">15</span>:<span class="number">08</span> ..</span><br><span class="line">	-rw-r--r--  <span class="number">1</span> non  non    <span class="number">18</span> Jul <span class="number">24</span>  <span class="number">2015</span> .bash_<span class="built_in">logout</span></span><br><span class="line">	-rw-r--r--  <span class="number">1</span> non  non   <span class="number">176</span> Jul <span class="number">24</span>  <span class="number">2015</span> .bash_profile</span><br><span class="line">	-rw-r--r--  <span class="number">1</span> non  non   <span class="number">124</span> Jul <span class="number">24</span>  <span class="number">2015</span> .bashrc</span><br><span class="line">	drwxr-xr-x  <span class="number">2</span> non  non  <span class="number">4096</span> Nov <span class="number">12</span>  <span class="number">2010</span> .gnome2</span><br><span class="line">	drwxr-xr-x  <span class="number">4</span> non  non  <span class="number">4096</span> Aug <span class="number">20</span>  <span class="number">2015</span> .mozilla</span><br><span class="line"></span><br><span class="line"><span class="comment">## -l LOGIN：修改登录名</span></span><br><span class="line">$ usermod <span class="operator">-l</span> non_new non</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L, --lock 锁定用户</span></span><br><span class="line">$ usermod -L non_new</span><br><span class="line"></span><br><span class="line"><span class="comment">## -U, --unlock 解除用户锁定</span></span><br><span class="line">$ usermod -U non_new</span><br></pre></td></tr></table></figure>
<h2 id="passwd"><a class="header-anchor" href="#passwd"></a>passwd</h2>
<p><strong>passwd - 更新用户的身份验证令牌</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">passwd [-k] [<span class="operator">-l</span>] [-u [<span class="operator">-f</span>]] [<span class="operator">-d</span>] [<span class="operator">-e</span>] [-n mindays] [-x maxdays] [-w warndays] [-i inactivedays] [-S] [--stdin] [username]</span><br><span class="line"></span><br><span class="line"><span class="operator">-l</span>  <span class="comment"># lock user</span></span><br><span class="line">-u  <span class="comment"># unlock user</span></span><br><span class="line">-n  <span class="comment"># mindays: 最短使用期限；</span></span><br><span class="line">-x  <span class="comment"># maxdays：默认为99999天；</span></span><br><span class="line">-w  <span class="comment"># warndays：</span></span><br><span class="line">-i  <span class="comment"># inactivedays：</span></span><br><span class="line"><span class="operator">-e</span>  <span class="comment"># 快速使账号过期的方法</span></span><br><span class="line"><span class="operator">-d</span>  <span class="comment"># 快速删除账号密码</span></span><br><span class="line">-S  <span class="comment"># 显示给定账号关于密码的简短信息</span></span><br><span class="line">--stdin <span class="comment"># 从标准输入接收密码传递给passwd命令(自动化应用)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ passwd -S root</span><br><span class="line">--&gt; root PS <span class="number">2015</span>-<span class="number">08</span>-<span class="number">19</span> <span class="number">0</span> <span class="number">99999</span> <span class="number">7</span> -<span class="number">1</span> (Password <span class="built_in">set</span>, SHA512 crypt.)</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'xxxxxx'</span> | passwd --stdin non_new</span><br><span class="line">--&gt; Changing password <span class="keyword">for</span> user non_new.</span><br><span class="line">	passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure>
<h2 id="userdel"><a class="header-anchor" href="#userdel"></a>userdel</h2>
<p><strong>userdel - 删除用户</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">userdel [options] LOGIN</span><br><span class="line"></span><br><span class="line"><span class="operator">-f</span> <span class="comment">## 强制删除用户,即时用户正处于登陆状态,也会强制删除用户的家目录和邮件spool.还有同名的组.</span></span><br><span class="line">   <span class="comment">## 这个选项是危险的，可能会让你的系统处于不一致的状态。</span></span><br><span class="line">-r --remove <span class="comment">## 将用户的家目录也移除</span></span><br></pre></td></tr></table></figure>
<h2 id="groupmod"><a class="header-anchor" href="#groupmod"></a>groupmod</h2>
<p><strong>groupmod - 组属性修改</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">groupmod [options] GROUP</span><br><span class="line"></span><br><span class="line">-n, --new-name 修改组名</span><br><span class="line">-g, --gid GID</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ groupmod -g <span class="number">3005</span> <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ groupmod -n <span class="built_in">test</span>_new <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<h2 id="gpasswd"><a class="header-anchor" href="#gpasswd"></a>gpasswd</h2>
<p><strong>gpasswd - 设定组密码</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="newgrp"><a class="header-anchor" href="#newgrp"></a>newgrp</h2>
<p><strong>newgrp - 切换基本组为指定的组</strong></p>
<p><em>当用户切换其基本组为此组时,如果其本就是此组的附加组,则直接切换,否则,则需要提供密码</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">newgrp [-] [group]</span><br></pre></td></tr></table></figure>
<h2 id="groupdel"><a class="header-anchor" href="#groupdel"></a>groupdel</h2>
<p><strong>groupdel - 删除组</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">groupdel group</span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="chage"><a class="header-anchor" href="#chage"></a>chage</h2>
<p><strong>chage - 修改用户账密码期限相关的属性</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">chage [options] [LOGIN]</span><br><span class="line"></span><br><span class="line"><span class="operator">-d</span> LAST_DAY <span class="comment">## 设置用户最后一次修改密码的时间,如果设置为0,用户被强制去更改密码在此用户下次登陆的时候.</span></span><br><span class="line">-E, --expiredate EXPIRE_DATE <span class="comment"># 过期时间</span></span><br><span class="line">-I, --inactive INACTIVE <span class="comment"># 非活动时间,密码过期之后,还有非活动时间,超过非活动时间,账号就会被锁定.</span></span><br><span class="line"><span class="operator">-l</span>, --list <span class="comment"># 显示账号密码信息</span></span><br><span class="line">-m, --mindays MIN_DAYS <span class="comment"># 密码使用的最短期限</span></span><br><span class="line">-M, --maxdays MAX_DAYS <span class="comment">#密码使用的最长期限</span></span><br><span class="line">-W, --warndays WARN_DAYS <span class="comment"># 在最长期限前多少天警告用户.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ chage <span class="operator">-d</span> <span class="number">0</span> centos</span><br><span class="line">$ ssh centos@<span class="number">192.168</span>.<span class="number">1.168</span>:<span class="number">22</span></span><br><span class="line">--&gt; Connecting to <span class="number">192.168</span>.<span class="number">1.168</span>:<span class="number">22</span>...</span><br><span class="line">	Connection established.</span><br><span class="line">	To escape to <span class="built_in">local</span> shell, press <span class="string">'Ctrl+Alt+]'</span>.</span><br><span class="line"></span><br><span class="line">	You are required to change your password immediately (root enforced)</span><br><span class="line">	Last login: Mon Dec  <span class="number">1</span> <span class="number">17</span>:<span class="number">01</span>:<span class="number">20</span> <span class="number">2014</span> from <span class="number">192.168</span>.<span class="number">1.105</span></span><br><span class="line">	WARNING: Your password has expired.</span><br><span class="line">	You must change your password now and login again!</span><br><span class="line">	Changing password <span class="keyword">for</span> user centos.</span><br><span class="line">	Changing password <span class="keyword">for</span> centos.</span><br><span class="line">	(current) UNIX password:</span><br><span class="line">	New password:</span><br><span class="line">	Retype new password:</span><br><span class="line">	passwd: all authentication tokens updated successfully.</span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ chage <span class="operator">-l</span> centos</span><br><span class="line">--&gt; Last password change					: Dec <span class="number">01</span>, <span class="number">2014</span></span><br><span class="line">	Password expires					: never</span><br><span class="line">	Password inactive					: never</span><br><span class="line">	Account expires						: never</span><br><span class="line">	Minimum number of days between password change		: <span class="number">0</span></span><br><span class="line">	Maximum number of days between password change		: <span class="number">99999</span></span><br><span class="line">	Number of days of warning before password expires	: <span class="number">7</span></span><br><span class="line"></span><br><span class="line">$ chage -m <span class="number">3</span> centos</span><br><span class="line">$ chage <span class="operator">-l</span> centos</span><br><span class="line">--&gt; Last password change					: Dec <span class="number">01</span>, <span class="number">2014</span></span><br><span class="line">	Password expires					: never</span><br><span class="line">	Password inactive					: never</span><br><span class="line">	Account expires						: never</span><br><span class="line">	Minimum number of days between password change		: <span class="number">3</span></span><br><span class="line">	Maximum number of days between password change		: <span class="number">99999</span></span><br><span class="line">	Number of days of warning before password expires	: <span class="number">7</span></span><br></pre></td></tr></table></figure>
<h2 id="chsh"><a class="header-anchor" href="#chsh"></a>chsh</h2>
<p><strong>chsh - 改变你的登陆shell</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">chsh [<span class="operator">-s</span> shell] [<span class="operator">-l</span>] [-u] [-v] [username]</span><br><span class="line"></span><br><span class="line"><span class="operator">-s</span>, --shell shell <span class="comment">#修改为制定的shell</span></span><br><span class="line"><span class="operator">-l</span>, --list-shells <span class="comment">#留出当前系统的可用shell</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line">--&gt; /bin/bash</span><br><span class="line">$ chsh <span class="operator">-s</span> /bin/sh</span><br><span class="line">--&gt; Changing shell <span class="keyword">for</span> root.</span><br><span class="line">	Shell changed.</span><br><span class="line"><span class="comment"># 重新登陆,查看$SHELL</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line">/bin/csh</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ chsh <span class="operator">-l</span></span><br><span class="line">--&gt; /bin/sh</span><br><span class="line">	/bin/bash</span><br><span class="line">	/sbin/nologin</span><br><span class="line">	/usr/bin/sh</span><br><span class="line">	/usr/bin/bash</span><br><span class="line">	/usr/sbin/nologin</span><br><span class="line">	/bin/tcsh</span><br><span class="line">	/bin/csh</span><br></pre></td></tr></table></figure>
<h2 id="id"><a class="header-anchor" href="#id"></a>id</h2>
<p><strong>id - 打印真正和有效的用户和组 Id</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">id [OPTION]... [USER]</span><br><span class="line"></span><br><span class="line">-u: UID</span><br><span class="line">-g: GID</span><br><span class="line">-G: Groups</span><br><span class="line">-n: NAME <span class="comment"># 参数格式为 -n&lt;u|g|G&gt;</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ id</span><br><span class="line">--&gt; uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ id -un</span><br><span class="line">--&gt; root</span><br></pre></td></tr></table></figure>
<h2 id="su"><a class="header-anchor" href="#su"></a>su</h2>
<p><strong>su - 切换用户或以其它用户的身份执行命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">su [options...] [-] [user [args...]] <span class="comment"># user省略时,默认切换到root</span></span><br><span class="line"></span><br><span class="line">-, <span class="operator">-l</span>, --login <span class="comment">#完全切换；登录式切换,意味着将使用目标用户的环境设定,原用户失效.</span></span><br><span class="line">su centos <span class="comment">#非完全切换；非登录式切换,意味着仍然使用原用户的环境设定.</span></span><br><span class="line">su - USERNAME -c <span class="string">'COMMAND'</span> <span class="comment">#仅以指定用户的身份执行指定的命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意: 返回原来的用户用exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ su - centos</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ su centos</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ su - centos -c <span class="string">'ls -al ~'</span></span><br><span class="line">--&gt; drwx------  <span class="number">3</span> centos centos  <span class="number">74</span> Sep  <span class="number">2</span> <span class="number">00</span>:<span class="number">08</span> .</span><br><span class="line">	drwxr-xr-x. <span class="number">4</span> root   root    <span class="number">31</span> Sep  <span class="number">2</span> <span class="number">00</span>:<span class="number">08</span> ..</span><br><span class="line">	-rw-r--r--  <span class="number">1</span> centos centos  <span class="number">18</span> Mar  <span class="number">6</span> <span class="number">06</span>:<span class="number">06</span> .bash_<span class="built_in">logout</span></span><br><span class="line">	-rw-r--r--  <span class="number">1</span> centos centos <span class="number">193</span> Mar  <span class="number">6</span> <span class="number">06</span>:<span class="number">06</span> .bash_profile</span><br><span class="line">	-rw-r--r--  <span class="number">1</span> centos centos <span class="number">231</span> Mar  <span class="number">6</span> <span class="number">06</span>:<span class="number">06</span> .bashrc</span><br><span class="line">	drwxr-xr-x  <span class="number">4</span> centos centos  <span class="number">37</span> Aug <span class="number">20</span> <span class="number">06</span>:<span class="number">58</span> .mozilla</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>用户和组管理的相关命令,useradd、usermod、passwd、userdel groupadd、groupmod、gpasswd、groupdel chage、chsh、chfn id、su</em></p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015-08-23]]></title>
    <link href="http://molloc.me/2015/08/23/ZY-2015-08-23/"/>
    <id>http://molloc.me/2015/08/23/ZY-2015-08-23/</id>
    <published>2015-08-23T14:33:37.000Z</published>
    <updated>2015-09-11T15:22:07.824Z</updated>
    <content type="html"><![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>涉及到的命令有,cat, tac, file, history, tree, more, less, tail, head, touch, cp, mv, rm, glob(7),tr,tee, wc, cut, sort, uniq</em></p>
<a id="more"></a>
<h2 id="cat"><a class="header-anchor" href="#cat"></a>cat</h2>
<p><strong>cat - 连接文件（S），或标准输入，到标准输出。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">cat [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -A, --show-all 等价于 -vET</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b, --number-nonblank 跟-n类似,只不过对于空白行不编号</span></span><br><span class="line">$ cat -b /etc/passwd</span><br><span class="line">--&gt;  <span class="number">1</span>	this is a test.</span><br><span class="line"></span><br><span class="line">     <span class="number">2</span>	onew</span><br><span class="line">     <span class="number">3</span>	tow.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -e 等价于 -vE</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -E 显示结束符,显示$在每行的结尾</span></span><br><span class="line">$ cat -E /etc/passwd</span><br><span class="line">--&gt; root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash$</span><br><span class="line">	bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin$</span><br><span class="line">	daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin$</span><br><span class="line">	adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin$</span><br><span class="line">	lp:x:<span class="number">4</span>:<span class="number">7</span>:lp:/var/spool/lpd:/sbin/nologin$</span><br><span class="line">	sync:x:<span class="number">5</span>:<span class="number">0</span>:sync:/sbin:/bin/sync$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -n 显示行号</span></span><br><span class="line">$ cat -n</span><br><span class="line">--&gt;  <span class="number">1</span>	This is my new life.</span><br><span class="line">     <span class="number">2</span></span><br><span class="line">     <span class="number">3</span>	one line.</span><br><span class="line">     <span class="number">4</span>	The other line.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --squeeze-blank 压制显现重复的空白行,连续的空白行输出一行</span></span><br><span class="line">$ cat <span class="operator">-s</span> <span class="built_in">test</span></span><br><span class="line">--&gt; This is my new life.</span><br><span class="line"></span><br><span class="line">	one line.</span><br><span class="line">	The other line.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -t 参考 -vT</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -T, --show-tabs TAB显示为^I</span></span><br><span class="line">$ cat -T <span class="built_in">test</span></span><br><span class="line">--&gt;	This is my new life.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	one^I line.</span><br><span class="line">	^Itab line.</span><br><span class="line">	The other line.</span><br><span class="line"></span><br><span class="line"><span class="comment">## -v, --show-nonprinting  显示非打印字符 use ^ and M- notation, except for LFD and TAB</span></span><br><span class="line">$ cat -v <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<h2 id="tac"><a class="header-anchor" href="#tac"></a>tac</h2>
<p><strong>tac - 将每个指定文件按行倒置并写到标准输出。如果不指定文件，或文件为&quot;-&quot;，则从标准输入读取数据,不常用</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">tac [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b, --before 在行前而非行尾添加分隔标志</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -r, --regex 将分隔标志视作正则表达式来解析</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --separator=字符串  使用指定字符串代替换行作为分隔标志</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="file"><a class="header-anchor" href="#file"></a>file</h2>
<p><strong>file - 检查文件的类型</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">file [-bchikLNnprsvz0] [--apple] [--mime-encoding] [--mime-type] [<span class="operator">-e</span> testname] [-F separator] [<span class="operator">-f</span> namefile] [-m magicfiles] file ...</span><br><span class="line">file -C [-m magicfiles]</span><br><span class="line">file [--help]</span><br><span class="line"></span><br><span class="line">@@OPTIONS</span><br><span class="line"><span class="comment">## -b --brief 简短模式, 不输出文件名</span></span><br><span class="line">$ file -b <span class="built_in">test</span></span><br><span class="line">--&gt; ASCII English text</span><br><span class="line"></span><br><span class="line"><span class="comment">## 待续...</span></span><br></pre></td></tr></table></figure>
<h2 id="history"><a class="header-anchor" href="#history"></a>history</h2>
<p><strong>history - 显示或操纵历史列表。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line"><span class="built_in">history</span> [-c] [<span class="operator">-d</span> offset] [n]</span><br><span class="line"><span class="built_in">history</span> -anrw [filename]</span><br><span class="line"><span class="built_in">history</span> -ps arg [arg...]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 清空历史记录</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -a: 当缓冲区中的历史手动追加文件；</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## n 数字,要列出最近的 n 笔命令列表</span></span><br><span class="line">$ <span class="built_in">history</span> <span class="number">4</span></span><br><span class="line">--&gt; <span class="number">849</span>  <span class="built_in">history</span> -n</span><br><span class="line">    <span class="number">850</span>  <span class="built_in">history</span></span><br><span class="line">    <span class="number">851</span>  <span class="built_in">history</span> -n</span><br><span class="line">    <span class="number">852</span>  <span class="built_in">history</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -r 将 histfiles 的内容读到目前这个 shell 的 history 记忆中</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -w 将目前的 history 记忆内容写入 histfiles</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d #: 删除历史中指定的命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 执行history列表中命令的方法</span></span><br><span class="line"><span class="comment">## 调用过去执行过的命令：</span></span><br><span class="line"><span class="comment">## 		!#：调用历史中的第#条命令；</span></span><br><span class="line"><span class="comment">## 		!!: 重复执行上一条命令</span></span><br><span class="line"><span class="comment">## 		!string：调用历史中最近一个以string开头的命令；</span></span><br><span class="line"><span class="comment">## 调用过去执行过的命令的最后一个参数：</span></span><br><span class="line"><span class="comment">## 		!$:</span></span><br><span class="line"><span class="comment">## 		ESC, .</span></span><br><span class="line"><span class="comment">## 		Alt+.</span></span><br></pre></td></tr></table></figure>
<h2 id="tree"><a class="header-anchor" href="#tree"></a>tree</h2>
<p><strong>tree - 命令以树形结构显示文件目录结构</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">tree  [-adfghilnopqrstuvxACDFNS]  [-L  level  [-R]]  [-H  baseHREF]  [-T  title]  [-o  filename]</span><br><span class="line">	  [--nolinks] [-P pattern] [-I pattern]</span><br><span class="line">      [--inodes] [--device] [--noreport] [--dirsfirst] [--version] [--help] [--filelimit <span class="comment">#] [directory ...]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -a 列出所有文件,默认情况下,不显示隐藏文件,还有当前目录(.)和上级目录(..)</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d 仅列出文件夹</span></span><br><span class="line">$ tree <span class="operator">-d</span> /tmp</span><br><span class="line">--&gt; ├── Desktop</span><br><span class="line">	├── Documents</span><br><span class="line">	├── Downloads</span><br><span class="line">	├── Music</span><br><span class="line">	├── Pictures</span><br><span class="line">	├── Public</span><br><span class="line">	├── Templates</span><br><span class="line">	└── Videos</span><br><span class="line"></span><br><span class="line"><span class="comment">## -f 在每个文件或目录之前，显示完整的相对路径名称。</span></span><br><span class="line">$ tree <span class="operator">-f</span></span><br><span class="line">--&gt; .</span><br><span class="line">	├── ./a123b</span><br><span class="line">	├── ./a3b</span><br><span class="line">	├── ./aab</span><br><span class="line">	├── ./ab</span><br><span class="line">	├── ./aMb</span><br><span class="line">	├── ./x</span><br><span class="line">	│   ├── ./x/m</span><br><span class="line">	│   └── ./x/n</span><br><span class="line">	└── ./y</span><br><span class="line">	    ├── ./y/m</span><br><span class="line">	    └── ./y/n</span><br><span class="line"></span><br><span class="line"><span class="comment">## -i   不以阶梯状列出文件或目录名称。</span></span><br><span class="line">$ tree -fi</span><br><span class="line">--&gt; .</span><br><span class="line">	./a123b</span><br><span class="line">	./a3b</span><br><span class="line">	./aab</span><br><span class="line">	./ab</span><br><span class="line">	./aMb</span><br><span class="line">	./x</span><br><span class="line">	./x/m</span><br><span class="line">	./x/n</span><br><span class="line">	./y</span><br><span class="line">	./y/m</span><br><span class="line">	./y/n</span><br><span class="line"></span><br><span class="line"><span class="comment">## -l 如遇到性质为符号连接的目录，直接列出该连接所指向的原始目录。</span></span><br><span class="line">$ ls <span class="operator">-l</span></span><br><span class="line">--&gt; -rw-r--r-- <span class="number">1</span> root root    <span class="number">0</span> Nov <span class="number">23</span> <span class="number">15</span>:<span class="number">18</span> a123b</span><br><span class="line">	-rw-r--r-- <span class="number">1</span> root root    <span class="number">0</span> Nov <span class="number">23</span> <span class="number">15</span>:<span class="number">18</span> a3b</span><br><span class="line">	-rw-r--r-- <span class="number">1</span> root root    <span class="number">0</span> Nov <span class="number">23</span> <span class="number">15</span>:<span class="number">18</span> aab</span><br><span class="line">	-rw-r--r-- <span class="number">1</span> root root    <span class="number">0</span> Nov <span class="number">23</span> <span class="number">15</span>:<span class="number">18</span> ab</span><br><span class="line">	-rw-r--r-- <span class="number">1</span> root root    <span class="number">0</span> Nov <span class="number">23</span> <span class="number">15</span>:<span class="number">18</span> aMb</span><br><span class="line">	lrwxrwxrwx <span class="number">1</span> root root    <span class="number">7</span> Nov <span class="number">24</span> <span class="number">13</span>:<span class="number">42</span> ls -&gt; /bin/ls</span><br><span class="line">	lrwxrwxrwx <span class="number">1</span> root root    <span class="number">3</span> Nov <span class="number">24</span> <span class="number">13</span>:<span class="number">43</span> lx -&gt; ./x</span><br><span class="line">	drwxr-xr-x <span class="number">4</span> root root <span class="number">4096</span> Nov <span class="number">24</span> <span class="number">13</span>:<span class="number">44</span> x</span><br><span class="line">	drwxr-xr-x <span class="number">4</span> root root <span class="number">4096</span> Nov <span class="number">23</span> <span class="number">14</span>:<span class="number">40</span> y</span><br><span class="line"></span><br><span class="line">$ tree <span class="operator">-l</span></span><br><span class="line">--&gt; .</span><br><span class="line">	├── a123b</span><br><span class="line">	├── a3b</span><br><span class="line">	├── aab</span><br><span class="line">	├── ab</span><br><span class="line">	├── aMb</span><br><span class="line">	├── ls -&gt; /bin/ls</span><br><span class="line">	├── lx -&gt; ./x</span><br><span class="line">	│   ├── m</span><br><span class="line">	│   └── n</span><br><span class="line">	├── x</span><br><span class="line">	│   ├── m</span><br><span class="line">	│   └── n</span><br><span class="line">	└── y</span><br><span class="line">	    ├── m</span><br><span class="line">	    └── n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## -P pattern 支持正则表达式过滤</span></span><br><span class="line">$ tree -p ?</span><br><span class="line">--&gt; x</span><br><span class="line">	├── [drwxr-xr-x]  m</span><br><span class="line">	└── [drwxr-xr-x]  n</span><br><span class="line">	y</span><br><span class="line">	├── [drwxr-xr-x]  m</span><br><span class="line">	└── [drwxr-xr-x]  n</span><br><span class="line"></span><br><span class="line"><span class="comment">## -I 不列出匹配到的.</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s 打印出每个文件的大小(byte)</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -h 打印出每个文件的大小,可读的(K,M,G,T,P,E)</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u 打印每一个文件的属主</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -g 打印每一个文件的属组</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -D 打印每一个文件的最后一次修改时间</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L 1显示几层目录</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## --dirsfirst 文件夹显示在前面</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="more"><a class="header-anchor" href="#more"></a>more</h2>
<p><strong>more - 类似 cat ，不过会以一页一页的显示方便使用者逐页阅读</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">more [-dlfpcsu] [-num] [+/pattern] [+linenum] [file ...]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d 有退出提示</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## Space: 向后一屏；</span></span><br><span class="line"><span class="comment">## Enter: 向后一行；</span></span><br><span class="line"><span class="comment">## b: 向前一屏；</span></span><br></pre></td></tr></table></figure>
<h2 id="less"><a class="header-anchor" href="#less"></a>less</h2>
<p><strong>less - 支持前后翻屏</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    /字符串：向下搜索“字符串”的功能</span></span><br><span class="line"><span class="comment">#    ?字符串：向上搜索“字符串”的功能</span></span><br><span class="line"><span class="comment">#    n：重复前一个搜索（与 / 或 ? 有关）</span></span><br><span class="line"><span class="comment">#    N：反向重复前一个搜索（与 / 或 ? 有关）</span></span><br><span class="line"><span class="comment">#    b  向后翻一页</span></span><br><span class="line"><span class="comment">#    d  向后翻半页</span></span><br><span class="line"><span class="comment">#    h  显示帮助界面</span></span><br><span class="line"><span class="comment">#    Q  退出less 命令</span></span><br><span class="line"><span class="comment">#    u  向前滚动半页</span></span><br><span class="line"><span class="comment">#    y,k  向前滚动一行</span></span><br><span class="line"><span class="comment">#    空格键 滚动一页</span></span><br><span class="line"><span class="comment">#    回车键,j 滚动一行</span></span><br><span class="line"><span class="comment">#    [pagedown]： 向下翻动一页</span></span><br><span class="line"><span class="comment">#    [pageup]：   向上翻动一页</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="tail"><a class="header-anchor" href="#tail"></a>tail</h2>
<p><strong>tail - 输出文件的最后一部分到标准输出.使用tail命令的-f选项可以方便的查阅正在改变的日志文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">tail [OPTION]... FILE</span><br><span class="line"></span><br><span class="line"><span class="comment">## -n # 显示#行,默认是10行</span></span><br><span class="line">$ tail -n <span class="number">4</span> /etc/passwd</span><br><span class="line">--&gt; pulse:x:<span class="number">497</span>:<span class="number">496</span>:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin</span><br><span class="line">	sshd:x:<span class="number">74</span>:<span class="number">74</span>:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">	tcpdump:x:<span class="number">72</span>:<span class="number">72</span>::/:/sbin/nologin</span><br><span class="line">	centos:x:<span class="number">500</span>:<span class="number">500</span>::/home/centos:/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment">## -f follow 可用来监控日志</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="head"><a class="header-anchor" href="#head"></a>head</h2>
<p><strong>head - 输出文件的前一部分</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">head [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -n 显示文件的前多少行,默认是10行</span></span><br><span class="line">$ head -n <span class="number">4</span> /etc/passwd</span><br><span class="line">--&gt; root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash</span><br><span class="line">	bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin</span><br><span class="line">	daemon:x:<span class="number">2</span>:<span class="number">2</span>:daemon:/sbin:/sbin/nologin</span><br><span class="line">	adm:x:<span class="number">3</span>:<span class="number">4</span>:adm:/var/adm:/sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment">## 其他选项不常用,略过.</span></span><br></pre></td></tr></table></figure>
<h2 id="touch"><a class="header-anchor" href="#touch"></a>touch</h2>
<p><strong>touch - 改变文件时间戳的工具</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">touch [OPTION]... FILE...</span><br><span class="line"></span><br><span class="line"><span class="comment">## 什么参数也不加,更新atime,mtime,ctime</span></span><br><span class="line"><span class="comment">##			-m: 只更新mtime</span></span><br><span class="line"><span class="comment">## 			-a: 只更新atime</span></span><br><span class="line"><span class="comment">## 			-t STAMP: [[CC]YY]MMDDhhmm[.ss] 此处只会更改atime,mtime,(ctime更新为当前时间,而不是指定的时间).</span></span><br><span class="line"><span class="comment">##			-c: 不创建空文件</span></span><br><span class="line"></span><br><span class="line">$ touch -t <span class="number">201403031122.33</span> <span class="built_in">test</span></span><br><span class="line">--&gt; File: <span class="string">'test'</span></span><br><span class="line">	  Size: <span class="number">61</span>        	Blocks: <span class="number">8</span>          IO Block: <span class="number">4096</span>   regular file</span><br><span class="line">	Device: fd00h/<span class="number">64768</span>d	Inode: <span class="number">262146</span>      Links: <span class="number">1</span></span><br><span class="line">	Access: (<span class="number">0644</span>/-rw-r--r--)  Uid: (    <span class="number">0</span>/    root)   Gid: (    <span class="number">0</span>/    root)</span><br><span class="line">	Access: <span class="number">2014</span>-<span class="number">03</span>-<span class="number">03</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">33.000000000</span> +<span class="number">0800</span></span><br><span class="line">	Modify: <span class="number">2014</span>-<span class="number">03</span>-<span class="number">03</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">33.000000000</span> +<span class="number">0800</span></span><br><span class="line">	Change: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">24</span> <span class="number">21</span>:<span class="number">22</span>:<span class="number">51.350499033</span> +<span class="number">0800</span>(此处为系统当前的时间)</span><br></pre></td></tr></table></figure>
<h2 id="cp"><a class="header-anchor" href="#cp"></a>cp</h2>
<p><strong>cp - 复制文件或文件夹</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">cp [OPTION]... [-T] SOURCE DEST</span><br><span class="line">cp [OPTION]... SOURCE... DIRECTORY</span><br><span class="line">cp [OPTION]... -t DIRECTORY SOURCE...</span><br><span class="line"></span><br><span class="line">cp SRC DEST:</span><br><span class="line">	SRC是文件：</span><br><span class="line">		如果DEST不存在：新建目标文件，并将SRC复制到目标文件；</span><br><span class="line">		如果DEST存在：</span><br><span class="line">			如果DEST是文件：用SRC的内容覆盖至DEST文件中；</span><br><span class="line">			如果DEST是目录：在DEST目录中新一个与原文件同名的文件，将将SRC内容复制到新建的同名的目标文件中；</span><br><span class="line"></span><br><span class="line">cp SRC... DEST:</span><br><span class="line">	如果DEST不存在：</span><br><span class="line">		是错误的；</span><br><span class="line">	如果DEST存在：</span><br><span class="line">		如果DEST是文件：错误；</span><br><span class="line">		如果DEST是目录：</span><br><span class="line"></span><br><span class="line">常用选项：</span><br><span class="line">	-r, -R: 递归复制；</span><br><span class="line">	<span class="operator">-d</span>: 不跟踪符号链接；</span><br><span class="line">	--preserve[=ATTR_LIST]：</span><br><span class="line">		mode, ownership, timestamps</span><br><span class="line">		context, links, xattr, all</span><br><span class="line">	<span class="operator">-a</span>: <span class="operator">-d</span>R --preseve=all</span><br><span class="line">	-i: interactive</span><br><span class="line">	<span class="operator">-f</span>: force</span><br><span class="line">	-v: 显示过程</span><br><span class="line"></span><br><span class="line"><span class="comment">## 下面演示加 -d 与不加的区别, 加-d会把符号链接复制过来,不加-d直接拷贝实际路径</span></span><br><span class="line">$ ll ls</span><br><span class="line">--&gt;　lrwxrwxrwx <span class="number">1</span> root root <span class="number">7</span> Aug <span class="number">24</span> <span class="number">21</span>:<span class="number">42</span> ls -&gt; /bin/ls</span><br><span class="line"></span><br><span class="line">$ cp ls&#123;,_bak&#125;</span><br><span class="line">--&gt; lrwxrwxrwx <span class="number">1</span> root root      <span class="number">7</span> Aug <span class="number">24</span> <span class="number">21</span>:<span class="number">42</span> ls -&gt; /bin/ls</span><br><span class="line">	-rwxr-xr-x <span class="number">1</span> root root <span class="number">117024</span> Aug <span class="number">24</span> <span class="number">22</span>:<span class="number">33</span> ls_bak</span><br><span class="line"></span><br><span class="line">$ cp <span class="operator">-d</span> ls&#123;,_bak_a&#125;</span><br><span class="line">--&gt; lrwxrwxrwx <span class="number">1</span> root root      <span class="number">7</span> Aug <span class="number">24</span> <span class="number">21</span>:<span class="number">42</span> ls -&gt; /bin/ls</span><br><span class="line">	-rwxr-xr-x <span class="number">1</span> root root <span class="number">117024</span> Aug <span class="number">24</span> <span class="number">22</span>:<span class="number">33</span> ls_bak</span><br><span class="line">	lrwxrwxrwx <span class="number">1</span> root root      <span class="number">7</span> Aug <span class="number">24</span> <span class="number">22</span>:<span class="number">35</span> ls_bak_a -&gt; /bin/ls</span><br></pre></td></tr></table></figure>
<h2 id="mv"><a class="header-anchor" href="#mv"></a>mv</h2>
<p><strong>mv - 移动或重命名文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">mv [OPTION]... [-T] SOURCE DEST</span><br><span class="line">mv [OPTION]... SOURCE... DIRECTORY</span><br><span class="line">mv [OPTION]... -t DIRECTORY SOURCE...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -i 交互的方式</span></span><br><span class="line"><span class="comment">## -f 强制移动</span></span><br></pre></td></tr></table></figure>
<h2 id="rm"><a class="header-anchor" href="#rm"></a>rm</h2>
<p><strong>rm - 删除文件和目录,默认情况下,它是不会删除目录的.</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">rm [OPTION]... FILE...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -r -R 递归删除</span></span><br><span class="line"><span class="comment">## -f 强制删除</span></span><br><span class="line"><span class="comment">## -i 交互式删除</span></span><br></pre></td></tr></table></figure>
<h2 id="tr"><a class="header-anchor" href="#tr"></a>tr</h2>
<p><strong>tr - 转换,压缩,删除字符从标准输入,并输出到标准输出.</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">tr [OPTION]... SET1 [SET2]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 用字符串1中字符集的补集替换此字符集，要求字符集为ASCII. 没明白?</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d, --delete 删除字符串1中所有输入字符。</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"aaaabbccvc"</span> | tr <span class="operator">-d</span> <span class="string">"a"</span></span><br><span class="line">--&gt; bbccvc</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --squeeze-repeats 删除所有连续重复出现字符序列，只保留第一个；即将重复出现字符串压缩为一个字符串。</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"aaaabbccvc"</span> | tr <span class="operator">-s</span> <span class="string">'[a-z]'</span></span><br><span class="line">--&gt; abcvc</span><br><span class="line"></span><br><span class="line"><span class="comment">## -t, --truncate-set1 将set1的字符依次替换成set2中的字符,如果set1的长度超过了set2的长度,则超出的部分不做转换.</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'This is your new life.'</span> | tr -t <span class="string">'your'</span> <span class="string">'my'</span></span><br><span class="line">--&gt; This is myur new life.</span><br><span class="line"></span><br><span class="line"><span class="comment">## 区别-t</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'This is your new life.'</span> | tr <span class="string">'your'</span> <span class="string">'my'</span></span><br><span class="line">--&gt; This is myyy new life.</span><br></pre></td></tr></table></figure>
<h2 id="tee"><a class="header-anchor" href="#tee"></a>tee</h2>
<p><strong>tee - 读取标准输入的数据，并将其内容输x到标准输出或文件。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">tee [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## 不加任何参数是覆盖</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -a, --append 追加到给定文件的末尾,并非覆盖</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'new line'</span> | tee <span class="operator">-a</span> a b <span class="comment">#把newline追加到a文件,b文件.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -i, --ignore-interrupts 忽略中断信号。</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="wc"><a class="header-anchor" href="#wc"></a>wc</h2>
<p><strong>wc - 统计指定文件中的字节数、字数、行数，并将统计结果显示输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">wc [OPTION]... [FILE]...</span><br><span class="line">wc [OPTION]... --files0-from=F</span><br><span class="line"></span><br><span class="line"><span class="comment">## -w 统计字数。一个字被定义为由空白、跳格或换行字符分隔的字符串。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -l 统计行数</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 统计字节数。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 统计字符数。这个标志不能与 -c 标志一起使用。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L 打印最长行的长度。</span></span><br></pre></td></tr></table></figure>
<h2 id="cut"><a class="header-anchor" href="#cut"></a>cut</h2>
<p><strong>cut - 命令从文件的每一行剪切字节、字符和字段并将这些字节、字符和字段写至标准输出。如果不指定 File 参数，cut 命令将读取标准输入。必须指定 -b、-c 或 -f 标志之一.</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">cut OPTION... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b ：以字节为单位进行分割。这些字节位置将忽略多字节字符边界，除非也指定了 -n 标志。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -c ：以字符为单位进行分割。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -d ：自定义分隔符，默认为制表符。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -f ：与-d一起使用，指定显示哪个区域。</span></span><br><span class="line">	<span class="comment">#:</span></span><br><span class="line">	<span class="comment">#-#：1-3</span></span><br><span class="line">	<span class="comment">#,#: 1,3,7</span></span><br></pre></td></tr></table></figure>
<h2 id="sort"><a class="header-anchor" href="#sort"></a>sort</h2>
<p><strong>sort - 排序指定文件中的行.</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">sort [OPTION]... [FILE]...</span><br><span class="line">sort [OPTION]... --files0-from=F</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b: 忽略每行前面开始出的空格字符。</span></span><br><span class="line"><span class="comment">## -c: 检查文件是否已经按照顺序排序。</span></span><br><span class="line"><span class="comment">## -r: 逆序</span></span><br><span class="line"><span class="comment">## -f: 忽略字符大小写</span></span><br><span class="line"><span class="comment">## -u: 排序后去重</span></span><br><span class="line"><span class="comment">## -t CHAR: 指明分隔符</span></span><br><span class="line"><span class="comment">## -k #: 字段,选择那个区间进行排序</span></span><br><span class="line"><span class="comment">## -n: 表示以数值大小排序</span></span><br><span class="line"><span class="comment">## -o &lt;输出文件&gt; 将排序后的结果存入指定的文件。</span></span><br></pre></td></tr></table></figure>
<h2 id="uniq"><a class="header-anchor" href="#uniq"></a>uniq</h2>
<p><strong>uniq - 报告或删除文件中重复的行。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">uniq [OPTION]... [INPUT [OUTPUT]]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c: 显示每行重复的次数；</span></span><br><span class="line"><span class="comment">## -d: 只显示重复过的行；</span></span><br><span class="line"><span class="comment">## -u: 只显示不曾重复的行；</span></span><br><span class="line"><span class="comment">## -i: 忽略大小写;</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>涉及到的命令有,cat, tac, file, history, tree, more, less, tail, head, touch, cp, mv, rm, glob(7),tr,tee, wc, cut, sort, uniq</em></p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ZY-2015.08.20]]></title>
    <link href="http://molloc.me/2015/08/20/ZY-2015-08-20/"/>
    <id>http://molloc.me/2015/08/20/ZY-2015-08-20/</id>
    <published>2015-08-20T14:32:07.000Z</published>
    <updated>2015-09-11T15:22:07.901Z</updated>
    <content type="html"><![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>涉及到的命令有,date,clock,hwclock,cal,ls,cd,pwd,tty,whereis,which,stat,echo,shutdown,halt,reboot,poweroff,who,w,whoami</em></p>
<a id="more"></a>
<h2 id="date"><a class="header-anchor" href="#date"></a>date</h2>
<p><strong>date - print or set the system date and time</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SYNOPSIS</span></span><br><span class="line">date [OPTION]... [+FORMAT]</span><br><span class="line">date [-u|--utc|--universal] [MMDDhhmm[[CC]YY][.ss]]</span><br><span class="line"></span><br><span class="line"><span class="comment">#OPTION</span></span><br><span class="line"><span class="comment">#-d DATESTR, --date=DATESTR 显示时间描述的字符串,而不是“现在”</span></span><br><span class="line"> $ date <span class="operator">-d</span> <span class="string">"2015-05-04"</span></span><br><span class="line"> --&gt; Mon May  <span class="number">4</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> CST <span class="number">2015</span></span><br><span class="line"> $ date --date=<span class="string">"2015-05-04"</span></span><br><span class="line"> --&gt; Mon May  <span class="number">4</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> CST <span class="number">2015</span></span><br><span class="line"> $ date <span class="operator">-d</span> <span class="string">"2 days ago"</span></span><br><span class="line"> --&gt; Wed Aug <span class="number">19</span> <span class="number">21</span>:<span class="number">09</span>:<span class="number">18</span> CST <span class="number">2015</span></span><br><span class="line"><span class="comment">#-s DATESTR, --set=DATESTR 设置时间描述的字符串</span></span><br><span class="line"> $ date <span class="operator">-s</span> <span class="string">"2015-05-04"</span></span><br><span class="line"> $ date --set=<span class="string">"2015-05-04"</span></span><br><span class="line"> $ date <span class="operator">-s</span> <span class="string">"2 days ago"</span></span><br><span class="line"><span class="comment">#-u, --utc, --universal 输出或者设置协调的通用时间</span></span><br><span class="line"> $ date -u</span><br><span class="line"> --&gt; Fri Aug <span class="number">21</span> <span class="number">13</span>:<span class="number">09</span>:<span class="number">38</span> UTC <span class="number">2015</span></span><br><span class="line"> $ date --utc</span><br><span class="line"> $ date --universal</span><br><span class="line"><span class="comment">#FORMAT</span></span><br><span class="line"><span class="comment"># '%a' //简短的星期名</span></span><br><span class="line">$ date <span class="string">'+%a'</span> // Sun</span><br><span class="line"><span class="comment"># '%A' 星期的全称</span></span><br><span class="line">$ date <span class="string">'+%A'</span> // Sunday</span><br><span class="line"><span class="comment"># '%b' 月份的简称</span></span><br><span class="line">$ date <span class="string">'+%b'</span> // Jan</span><br><span class="line"><span class="comment"># '%B' 月份的全称</span></span><br><span class="line">$ date <span class="string">'+%B'</span> // January</span><br><span class="line"><span class="comment"># '%c' 显示时间和日期</span></span><br><span class="line">$ date <span class="string">'+%c'</span> // Thu <span class="number">20</span> Aug <span class="number">2015</span> <span class="number">11</span>:<span class="number">43</span>:<span class="number">39</span> PM CST</span><br><span class="line"><span class="comment"># '%C' 显示世纪,像%Y省略了后两位数字</span></span><br><span class="line">$ date <span class="string">'+%C'</span> // <span class="number">20</span></span><br><span class="line"><span class="comment"># '%d' 每月的第几天(</span></span><br><span class="line">$ date <span class="string">'+%d'</span> // <span class="number">20</span></span><br><span class="line"><span class="comment"># '%D' 显示日期,想'%m/%d/%y'</span></span><br><span class="line">$ date <span class="string">'+%d'</span> // <span class="number">08</span>/<span class="number">20</span>/<span class="number">15</span></span><br><span class="line"><span class="comment"># '%e' 月份中的天数,用空格填充</span></span><br><span class="line">$ date <span class="string">'+%e'</span> // <span class="string">' 5'</span></span><br><span class="line"><span class="comment"># '%F' 年月日,像%Y-%m-%d</span></span><br><span class="line">$ date <span class="string">'+%F'</span> // <span class="number">2015</span>-<span class="number">08</span>-<span class="number">20</span></span><br><span class="line"><span class="comment"># '%g' 年份的后两位</span></span><br><span class="line">$ date <span class="string">'+%g'</span> // <span class="number">15</span></span><br><span class="line"><span class="comment"># '%G' 使用基于周的年</span></span><br><span class="line">$ date <span class="string">'+%G'</span> // <span class="number">2015</span></span><br><span class="line"><span class="comment"># '%h' 参考 %b</span></span><br><span class="line"><span class="comment"># '%H' 24小时制(0..23)</span></span><br><span class="line">$ date <span class="string">'+%G'</span> // <span class="number">23</span></span><br><span class="line"><span class="comment"># '%I' 12小时制(1..12)</span></span><br><span class="line">$ date <span class="string">'+%I'</span> // <span class="number">12</span></span><br><span class="line"><span class="comment"># '%j' 一年中的天数(001..366)</span></span><br><span class="line">$ date <span class="string">'+%j'</span> // <span class="number">233</span></span><br><span class="line"><span class="comment"># '%k' 参考%H</span></span><br><span class="line"><span class="comment"># '%l' 参考%I</span></span><br><span class="line"><span class="comment"># '%m' 显示月份(01..12)</span></span><br><span class="line">$ date <span class="string">'+%m'</span> // <span class="number">08</span></span><br><span class="line"><span class="comment"># '%M' 显示分钟数(00-59)</span></span><br><span class="line">$ date <span class="string">'+%M'</span> // <span class="number">04</span></span><br><span class="line"><span class="comment"># '%n' 换行</span></span><br><span class="line"><span class="comment"># '%N' 纳秒(000000000..999999999)</span></span><br><span class="line">$ date <span class="string">'+%N'</span> // <span class="number">236423051</span></span><br><span class="line"><span class="comment"># '%p' AM或PM</span></span><br><span class="line">$ date <span class="string">'+p'</span> // PM</span><br><span class="line"><span class="comment"># '%P' am或pm(小写)</span></span><br><span class="line">$ date <span class="string">'+p'</span> // pm</span><br><span class="line"><span class="comment"># '%r' 时间(含时分秒，小时以12小时AM/PM来表示)</span></span><br><span class="line">$ date <span class="string">'+r'</span> // <span class="number">09</span>:<span class="number">21</span>:<span class="number">53</span> PM</span><br><span class="line"><span class="comment"># '%R' 24小时加上分解,想%H:%M</span></span><br><span class="line">$ date <span class="string">'+R'</span> // <span class="number">21</span>:<span class="number">23</span></span><br><span class="line"><span class="comment"># '%s' 从1970-01-01 00:00:00 UTC开始的秒数</span></span><br><span class="line">$ date <span class="string">'+s'</span> // <span class="number">1440163456</span></span><br><span class="line"><span class="comment"># '%S' 显示秒数(0-60)</span></span><br><span class="line">$ date <span class="string">'+S'</span> // <span class="number">31</span></span><br><span class="line"><span class="comment"># '%T' 时间 像 %H:%M:%S</span></span><br><span class="line">$ date <span class="string">'+T'</span> // <span class="number">21</span>:<span class="number">26</span>:<span class="number">28</span></span><br><span class="line"><span class="comment"># '%u' 星期(1-7),1代表星期一</span></span><br><span class="line">$ date <span class="string">'+u'</span> // <span class="number">5</span></span><br><span class="line"><span class="comment"># '%U' 一年中的周数(01-53)</span></span><br><span class="line">$ date <span class="string">'+U'</span> // <span class="number">33</span></span><br><span class="line"><span class="comment"># '%w' 一周的星期几(0-6)0是星期日</span></span><br><span class="line">$ date <span class="string">'+w'</span> // <span class="number">5</span></span><br><span class="line"><span class="comment"># '%x' 按本地日期格式显示</span></span><br><span class="line">$ date <span class="string">'+x'</span> // <span class="number">08</span>/<span class="number">23</span>/<span class="number">2015</span></span><br><span class="line"><span class="comment"># '%X' 按本地时间格式显示</span></span><br><span class="line">$ date <span class="string">'+X'</span> // <span class="number">12</span>:<span class="number">03</span>:<span class="number">05</span> AM</span><br><span class="line"><span class="comment"># '%y' 显示年份的后两位</span></span><br><span class="line">$ date <span class="string">'+y'</span> // <span class="number">15</span></span><br><span class="line"><span class="comment"># '%Y' 四位数的年份</span></span><br><span class="line">$ date <span class="string">'+Y'</span> // <span class="number">2015</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##date [-u|--utc|--universal] [MMDDhhmm[[CC]YY][.ss]]</span></span><br><span class="line"><span class="comment">## -u|--utc|--universal 选项一般不常用</span></span><br><span class="line"><span class="comment">## [MMDDhhmm[[CC]YY][.ss]] 主要设置时间的格式.</span></span><br><span class="line">$ date <span class="number">112311222014.33</span></span><br><span class="line">--&gt; Sun Nov <span class="number">23</span> <span class="number">11</span>:<span class="number">22</span>:<span class="number">33</span> CST <span class="number">2014</span></span><br></pre></td></tr></table></figure>
<h2 id="hwclock-clock"><a class="header-anchor" href="#hwclock-clock"></a>hwclock&amp;clock</h2>
<p><strong>hwclock - query and set the hardware clock (RTC) 查询或设置硬件时间</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">hwclock [<span class="built_in">functions</span>] [options]</span><br><span class="line"></span><br><span class="line"><span class="comment">## functions</span></span><br><span class="line"><span class="comment">## -r,--show 阅读硬件时钟和在标准输出打印时间。显示的时间总是在当地时间.</span></span><br><span class="line">$ hwclock -r</span><br><span class="line">--&gt; Fri <span class="number">21</span> Aug <span class="number">2015</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">06</span> PM CST  -<span class="number">0.378045</span> seconds</span><br><span class="line">$ hwclock --show</span><br><span class="line">--&gt; Fri <span class="number">21</span> Aug <span class="number">2015</span> <span class="number">09</span>:<span class="number">51</span>:<span class="number">55</span> PM CST  -<span class="number">0.329897</span> seconds</span><br><span class="line"></span><br><span class="line"><span class="comment">## --set 用给定的时间(--date 选项)设置硬件时间</span></span><br><span class="line">$ hwclock --set --date=<span class="string">'2015-08-21'</span> // 修改后的时间</span><br><span class="line">--&gt; Fri <span class="number">21</span> Aug <span class="number">2015</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">09</span> AM CST  -<span class="number">1.036660</span> seconds</span><br><span class="line">$ hwclock --set --date=<span class="string">'-4 days'</span> // 修改后的时间</span><br><span class="line">--&gt; Wed <span class="number">19</span> Aug <span class="number">2015</span> <span class="number">12</span>:<span class="number">24</span>:<span class="number">32</span> AM CST  -<span class="number">0.469782</span> seconds</span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --hctosys 将系统时钟调整为与目前的硬件时钟一致, htc override sys</span></span><br><span class="line">$ hwclock <span class="operator">-s</span></span><br><span class="line">--&gt; Wed Aug <span class="number">19</span> <span class="number">00</span>:<span class="number">28</span>:<span class="number">23</span> CST <span class="number">2015</span></span><br><span class="line">$ hwclock --hctosys</span><br><span class="line">--&gt; Wed Aug <span class="number">19</span> <span class="number">00</span>:<span class="number">28</span>:<span class="number">23</span> CST <span class="number">2015</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -w, --systohc 将系统时钟写入硬件时钟 sys to hc</span></span><br><span class="line">$ hwclock -w</span><br><span class="line">--&gt; Thu <span class="number">20</span> Aug <span class="number">2015</span> <span class="number">12</span>:<span class="number">00</span>:<span class="number">19</span> AM CST  -<span class="number">0.298877</span> seconds</span><br><span class="line">$ hwclock --systohc</span><br><span class="line">--&gt; Fri <span class="number">21</span> Aug <span class="number">2015</span> <span class="number">10</span>:<span class="number">03</span>:<span class="number">10</span> PM CST  -<span class="number">1.235380</span> seconds</span><br><span class="line"></span><br><span class="line"><span class="comment">## --adjust hwclock每次更改硬件时钟时，都会记录在/etc/adjtime文件中,</span></span><br><span class="line"><span class="comment">## 可使hwclock根据先前的记录来估算硬件时钟的偏差，并用来校正目前的硬件时钟.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## options</span></span><br><span class="line">//待补充</span><br></pre></td></tr></table></figure>
<h2 id="cal"><a class="header-anchor" href="#cal"></a>cal</h2>
<p><strong>cal - 显示日历</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">cal [-smjy13] [[[day] month] year]</span><br><span class="line"></span><br><span class="line"><span class="comment">## cal 如果没有指定参数,则显示当前月份.</span></span><br><span class="line">$ cal</span><br><span class="line"></span><br><span class="line"><span class="comment">## -l 显示一个月的日历,这是默认的选项.</span></span><br><span class="line">$ cal <span class="operator">-l</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -3 显示上月/当月/下月的日历.</span></span><br><span class="line">$ cal -<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -s 显示星期日为一个星期的第一天.</span></span><br><span class="line">$ cal <span class="operator">-s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 显示星期一为一个星期的第一天.</span></span><br><span class="line">$ cal -m</span><br><span class="line"></span><br><span class="line"><span class="comment">## -j  显示在当年中的第几天（一年日期按天算，从1月1号算起，默认显示当前月在一年中的天数）</span></span><br><span class="line">$ cal -j</span><br><span class="line"></span><br><span class="line"><span class="comment">## -y 显示当年的日历</span></span><br><span class="line">$ cal -y</span><br></pre></td></tr></table></figure>
<h2 id="ls"><a class="header-anchor" href="#ls"></a>ls</h2>
<p><strong>显示目录中的内容,默认显示当前目录,并安装字母顺序排列</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">ls [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -a, --all 列出目录下的所有文件，包括以 . 开头的隐含文件</span></span><br><span class="line">$ ls <span class="operator">-a</span></span><br><span class="line">--&gt; .  ..  .esd-<span class="number">0</span>  .ICE-unix</span><br><span class="line"></span><br><span class="line"><span class="comment">## -A, --almost-all 列出目录下的所有文件，但不包括(.当前目录)(..父目录)</span></span><br><span class="line">$ ls <span class="operator">-a</span></span><br><span class="line">--&gt; .esd<span class="operator">-a</span> .ICE-unix</span><br><span class="line"></span><br><span class="line"><span class="comment">## --author 与-l参数一起使用,显示作者.</span></span><br><span class="line">$ ls <span class="operator">-l</span> --author</span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm  gdm  gdm   <span class="number">4096</span> Aug <span class="number">21</span> <span class="number">21</span>:<span class="number">06</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b, --escape 把文件名中不可输出的字符用反斜杠加字符编号(就象在C语言里一样)的形式列出。</span></span><br><span class="line">$ ls -b</span><br><span class="line"></span><br><span class="line"><span class="comment">## --block-size=SIZE =1K,以 k 字节的形式表示文件的大小。</span></span><br><span class="line">$ ls --block-size=<span class="number">1</span>M</span><br><span class="line">--&gt; dr-xr-xr-x.   <span class="number">2</span> root root <span class="number">36</span>(k) Aug <span class="number">21</span> <span class="number">05</span>:<span class="number">41</span> bin</span><br><span class="line"></span><br><span class="line"><span class="comment">## -B, --ignore-backups 忽略以~结尾的备份目录</span></span><br><span class="line">$ ls</span><br><span class="line">--&gt; bak~  lcyan.root.history-timestamp  orbit-gdm</span><br><span class="line">$ ls -B</span><br><span class="line">--&gt; lcyan.root.history-timestamp  orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 配合 -lt：根据 ctime 排序及显示 ctime (文件状态最后更改的时间)配合</span></span><br><span class="line"><span class="comment">## -c -l：显示 ctime 但根据名称排序否则：根据 ctime 排序</span></span><br><span class="line">$ ls <span class="operator">-lt</span> -c</span><br><span class="line">$ ls <span class="operator">-l</span> -c</span><br><span class="line"></span><br><span class="line"><span class="comment">## –color[=WHEN] 控制是否使用色彩分辨文件。WHEN 可以是'never'、'always'或'auto'其中之一</span></span><br><span class="line">$ ls --color=auto</span><br><span class="line"></span><br><span class="line"><span class="comment">## -d, --directory显示指定的目录,不要解除引用的符号连接.</span></span><br><span class="line">$ ls <span class="operator">-d</span> /tmp</span><br><span class="line">--&gt; /tmp</span><br><span class="line">$ ls --directory /tmp</span><br><span class="line">--&gt; /tmp</span><br><span class="line"></span><br><span class="line"><span class="comment">## -f 对结果不排序, 激活 -aU, 禁止 -ls --color</span></span><br><span class="line">$ ls <span class="operator">-f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -F, --classify 在每个文件后面加上指示符号</span></span><br><span class="line">$ ls -F</span><br><span class="line">--&gt; bak~/  lcyan.root.history-timestamp  orbit-gdm/</span><br><span class="line"></span><br><span class="line"><span class="comment">## --file-type 同-F,除了不添加' *'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## --format=WORD</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## --full-time 参考-l</span></span><br><span class="line">$ ls --full-time</span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> <span class="number">2015</span>-<span class="number">08</span>-<span class="number">21</span> <span class="number">21</span>:<span class="number">06</span>:<span class="number">13.856371827</span> +<span class="number">0800</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -g参考-l, 不常用.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -h, --human-readable 人类可读的.配合-l使用</span></span><br><span class="line">$ ls -lh</span><br><span class="line"></span><br><span class="line"><span class="comment">## --si 用1000作为换算单位,而不是1024</span></span><br><span class="line">$ ls --si</span><br><span class="line">--&gt; drwxr-xr-x. <span class="number">2</span> root root <span class="number">4.1</span>k Aug <span class="number">21</span> <span class="number">23</span>:<span class="number">26</span> bak~</span><br><span class="line"></span><br><span class="line"><span class="comment">## -H, --dereference-command-line 使用命令列中的符号链接指示的真正目的地</span></span><br><span class="line">$ ls -H</span><br><span class="line">--&gt; traceroute6 -&gt; traceroute 显示为 traceroute</span><br><span class="line"></span><br><span class="line"><span class="comment">## --hide=PATTERN 不列出匹配到正则表达式的文件</span></span><br><span class="line">$ ls <span class="operator">-l</span> --hide=*.log</span><br><span class="line">--&gt; 不显示后缀为.log的文件</span><br><span class="line"></span><br><span class="line"><span class="comment">## -i,--inode 显示文件的inode号</span></span><br><span class="line">$ ls -i</span><br><span class="line">--&gt; <span class="number">266215</span> drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line">$ ls --inode</span><br><span class="line">--&gt; <span class="number">266215</span> drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -I, --ignore=PATTERN 参考 --hide</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -k 参考 --block-size=1K</span></span><br><span class="line">$ ls -lk</span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4</span>[此处单位为K] Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -l 显示为长列表格式</span></span><br><span class="line">$ ls <span class="operator">-l</span></span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L, --dereference 符号链接显示为链接的引用,而不是链接本身</span></span><br><span class="line">$ ls <span class="operator">-l</span></span><br><span class="line">--&gt; lrwxrwxrwx. <span class="number">1</span> root root     <span class="number">9</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">11</span> <span class="built_in">echo</span> -&gt; /bin/<span class="built_in">echo</span></span><br><span class="line">$ ls <span class="operator">-l</span>L</span><br><span class="line">--&gt; -rwxr-xr-x. <span class="number">1</span> root root <span class="number">28176</span> Oct <span class="number">15</span>  <span class="number">2014</span> <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 用逗号填充列表的分隔符</span></span><br><span class="line">$ ls -m</span><br><span class="line">--&gt; pulse-vS2MflCGjzHN, virtual-root.GJeaJi, yum.log</span><br><span class="line"></span><br><span class="line"><span class="comment">## -n, --numeric-uid-gid 像-l, 但显示的数字是用户和组的ID.</span></span><br><span class="line">$ ls -n</span><br><span class="line">--&gt; drwx------. <span class="number">2</span> <span class="number">42</span> <span class="number">42</span>  <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm (多了一个组ID)</span><br><span class="line"></span><br><span class="line"><span class="comment">## -N, --literal 显示原生的名字,不会对控制字符做特殊处理</span></span><br><span class="line">$ ls -N</span><br><span class="line">--&gt; pulse-vS2MflCGjzHN  virtual-root.GJeaJi  yum.log</span><br><span class="line"></span><br><span class="line"><span class="comment">## -o 类似于 -l, 但不显示组的信息.</span></span><br><span class="line">$ ls <span class="operator">-l</span></span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line">$ ls -o</span><br><span class="line">--&gt; drwx------. <span class="number">2</span> gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## -p, --indicator-style=slash, 制定分隔符,默认文件夹后面是/</span></span><br><span class="line">$ ls --indicator-style=none</span><br><span class="line"></span><br><span class="line"><span class="comment">## -q, --hide-control-chars 用?代替非图形字符</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -Q, --quote-name 条目名称加上双引号</span></span><br><span class="line">$ ls -Q</span><br><span class="line">--&gt; <span class="string">"bak~"</span>  <span class="string">"echo"</span>  <span class="string">"hackt"</span>  <span class="string">"lcyan.root.history-timestamp"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -r, --reverse 反序,当原列表是排序的情况下</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -R, --recursive 递归显示文件子目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --size 以块大小为单位列出所有文件的大小</span></span><br><span class="line">$ ls -si</span><br><span class="line">--&gt; <span class="number">4</span> drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm (前<span class="number">2</span>位)</span><br><span class="line"></span><br><span class="line"><span class="comment">## -S 按文件大小排序</span></span><br><span class="line">$ ls <span class="operator">-l</span>S</span><br><span class="line">--&gt; 	-rw-r--r--. <span class="number">1</span> root root <span class="number">39384</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">33</span> lcyan.root.history-timestamp</span><br><span class="line">--&gt; 	drwxr-xr-x. <span class="number">2</span> root root  <span class="number">4096</span> Aug <span class="number">21</span> <span class="number">23</span>:<span class="number">26</span> bak~</span><br><span class="line">--&gt; 	drwx------. <span class="number">2</span> gdm  gdm   <span class="number">4096</span> Aug <span class="number">22</span> <span class="number">07</span>:<span class="number">44</span> orbit-gdm</span><br><span class="line"></span><br><span class="line"><span class="comment">## --sort=WORD 用指定的规则排,none -U, extension -X, size -S, time -t, version -v</span></span><br><span class="line"><span class="variable">$ls</span> <span class="operator">-l</span> --sort=extension</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">37</span> b.dmg</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">20</span> <span class="number">07</span>:<span class="number">51</span> yum.log</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> read.md</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> a.tgz</span><br><span class="line"></span><br><span class="line"><span class="variable">$ls</span> <span class="operator">-l</span> --sort=time</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">37</span> b.dmg</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> a.tgz</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> read.md</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">20</span> <span class="number">07</span>:<span class="number">51</span> yum.log</span><br><span class="line"></span><br><span class="line"><span class="comment">## --time=WORD 配合 -l with  -l,  show  time  as WORD instead of modification time:</span></span><br><span class="line"><span class="comment">## atime -u, access -u, use -u, ctime -c, or status -c; use specified</span></span><br><span class="line"><span class="comment">## time as sort key if --sort=time</span></span><br><span class="line">$ ls <span class="operator">-l</span> --sort=time --time=ctime</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">38</span> read.md</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">38</span> yum.log</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">38</span> a.tgz</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">38</span> b.dmg</span><br><span class="line"></span><br><span class="line"><span class="comment">## -t 按修改时间倒序</span></span><br><span class="line">$ ls -tl --full-time</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">37</span>:<span class="number">32.922959000</span> +<span class="number">0800</span> b.dmg</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">36</span>:<span class="number">59.016959045</span> +<span class="number">0800</span> a.tgz</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">36</span>:<span class="number">17.796955491</span> +<span class="number">0800</span> read.md</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> <span class="number">2015</span>-<span class="number">08</span>-<span class="number">20</span> <span class="number">07</span>:<span class="number">51</span>:<span class="number">23.161999794</span> +<span class="number">0800</span> yum.log</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u  配合 -lt:显示访问时间而且依访问时间排序</span></span><br><span class="line"><span class="comment">##     配合 -l:显示访问时间但根据名称排序</span></span><br><span class="line"><span class="comment">##     否则：根据访问时间排序</span></span><br><span class="line">$ ls -ut</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">37</span> b.dmg</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> a.tgz</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> read.md</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">20</span> <span class="number">07</span>:<span class="number">51</span> yum.log</span><br><span class="line"></span><br><span class="line">$ ls -lu</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> a.tgz</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">37</span> b.dmg</span><br><span class="line">--&gt; -rw-r--r--. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">36</span> read.md</span><br><span class="line">--&gt; -rw-------. <span class="number">1</span> root root <span class="number">0</span> Aug <span class="number">20</span> <span class="number">07</span>:<span class="number">51</span> yum.log</span><br><span class="line"></span><br><span class="line"><span class="comment">## -U 不进行排序;依文件系统原有的次序列出项目</span></span><br><span class="line">$ ls <span class="operator">-l</span>U</span><br><span class="line"></span><br><span class="line"><span class="comment">## -v 根据版本进行排序</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -X 根据扩展名排</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## 还有一些关于selinux的选项,不常用</span></span><br></pre></td></tr></table></figure>
<h2 id="cd"><a class="header-anchor" href="#cd"></a>cd</h2>
<p><strong>改变shell的工作目录</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"><span class="built_in">cd</span>: <span class="built_in">cd</span> [-L|-P] [dir]</span><br><span class="line"></span><br><span class="line"><span class="comment">## cd 改变当前工作目录到DIR,如果不指定DIR,则默认的DIR是shell变量$HOME的值</span></span><br><span class="line">$ <span class="built_in">cd</span></span><br><span class="line">--&gt; /root</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$HOME</span></span><br><span class="line">--&gt; /root</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L 强制进去符号链接目录</span></span><br><span class="line">$ ls -ld /proc/self</span><br><span class="line">--&gt; lrwxrwxrwx <span class="number">1</span> root root <span class="number">64</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">57</span> self -&gt; <span class="number">3521</span></span><br><span class="line">$ <span class="built_in">cd</span> -L self</span><br><span class="line">--&gt; /proc/self</span><br><span class="line"></span><br><span class="line"><span class="comment">## -P 使用物理目录结构,而不是符号目录</span></span><br><span class="line">$ ls -ld /proc/self</span><br><span class="line">--&gt; lrwxrwxrwx <span class="number">1</span> root root <span class="number">64</span> Aug <span class="number">22</span> <span class="number">08</span>:<span class="number">57</span> self -&gt; <span class="number">3521</span></span><br><span class="line">$ <span class="built_in">cd</span> -P self</span><br><span class="line">--&gt;  /proc/<span class="number">3521</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## cd的默认行为是 cd -L</span></span><br></pre></td></tr></table></figure>
<h2 id="pwd"><a class="header-anchor" href="#pwd"></a>pwd</h2>
<p><strong>pwd是一个内建命令,打印当前工作目录的名字</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"><span class="built_in">pwd</span> [-LP]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L 打印shell变量$PWD的值,如果它的值是当前工作目录</span></span><br><span class="line">$ <span class="built_in">pwd</span> -L</span><br><span class="line">--&gt; /etc/ssh</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$PWD</span></span><br><span class="line">--&gt; /etc/ssh</span><br><span class="line"></span><br><span class="line"><span class="comment">## -P 参考cd的-P选项</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## pwd的默认行为是 pwd -L</span></span><br></pre></td></tr></table></figure>
<h2 id="tty"><a class="header-anchor" href="#tty"></a>tty</h2>
<p><strong>打印连接到标准输入的终端的文件名</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">tty [OPTION]...</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line">$ tty</span><br><span class="line">--&gt; /dev/pts/<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -s, --silent, --quiet 什么也不返还,值返回一个退出状态</span></span><br><span class="line">$ tty <span class="operator">-s</span></span><br></pre></td></tr></table></figure>
<h2 id="whereis"><a class="header-anchor" href="#whereis"></a>whereis</h2>
<p><strong>定位一个命令的二进制文件,源码,手册的位置</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">whereis [-bmsu] [-BMS directory...  <span class="operator">-f</span>] filename...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -b 仅搜索二进制文件的位置</span></span><br><span class="line">$ whereis -b ls</span><br><span class="line">--&gt; ls: /bin/ls</span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 仅搜索手册章节文件的位置</span></span><br><span class="line">$ whereis -m ls</span><br><span class="line">--&gt; ls: /usr/share/man/man1p/ls.<span class="number">1</span>p.gz /usr/share/man/man1/ls.<span class="number">1</span>.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">## -m 仅搜索源码文件的位置</span></span><br><span class="line">$ whereis <span class="operator">-s</span> ls</span><br><span class="line">--&gt; ls:</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u 索默认路径下除可执行文件、源代码文件、帮助文件以外的其它文件。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -B 指定搜索可执行文件的路径。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -M 指定搜索帮助文件的路径。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -S 指定搜索源代码文件的路径</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## 在使用了-B ， -M ， -S  任意一个参数时，必须加上 -f  参数， 然后指定要搜索的文件名.</span></span><br><span class="line">$ whereis -B /bin <span class="operator">-f</span> ls gcc</span><br></pre></td></tr></table></figure>
<h2 id="which"><a class="header-anchor" href="#which"></a>which</h2>
<p><strong>显示shell命令的全路径,注意只能找到PATH路径下的命令</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"><span class="built_in">which</span> [options] [--] programname [...]</span><br><span class="line"></span><br><span class="line"><span class="comment">## --all, -a 打印所有匹配的可执行文件的路径在PATH，而不是仅仅是第一.</span></span><br><span class="line">$ <span class="built_in">which</span> <span class="operator">-a</span> tty</span><br><span class="line">--&gt; /usr/bin/tty</span><br><span class="line"></span><br><span class="line"><span class="comment">## --read-alias, -i</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## --skip-alias 跳过别名</span></span><br><span class="line">$ <span class="built_in">which</span> --skip-alias ls</span><br><span class="line">--&gt; /bin/ls</span><br></pre></td></tr></table></figure>
<h2 id="stat"><a class="header-anchor" href="#stat"></a>stat</h2>
<p><strong>显示文件或文件系统的状态</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"><span class="built_in">stat</span> [OPTION]... FILE...</span><br><span class="line"></span><br><span class="line"><span class="comment">## -L, --dereference 如果是链接文件，则获取原文件信息</span></span><br><span class="line">$ <span class="built_in">stat</span> <span class="built_in">echo</span> File:</span><br><span class="line">--&gt; `<span class="built_in">echo</span>` -&gt; `/bin/<span class="built_in">echo</span>`</span><br><span class="line">--&gt;   Size: <span class="number">9</span>         	Blocks: <span class="number">0</span>          IO Block: <span class="number">4096</span>   symbolic link</span><br><span class="line">--&gt; Device: fd00h/<span class="number">64768</span>d	Inode: <span class="number">266232</span>      Links: <span class="number">1</span></span><br><span class="line">--&gt; Access: (<span class="number">0777</span>/lrwxrwxrwx)  Uid: (    <span class="number">0</span>/    root)   Gid: (    <span class="number">0</span>/    root)</span><br><span class="line">--&gt; Access: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">11</span>:<span class="number">08.364959865</span> +<span class="number">0800</span></span><br><span class="line">--&gt; Modify: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">11</span>:<span class="number">05.354951390</span> +<span class="number">0800</span></span><br><span class="line">--&gt; Change: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">11</span>:<span class="number">05.354951390</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">stat</span> -L <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">--&gt;   File: `<span class="built_in">echo</span>`</span><br><span class="line">--&gt;   Size: <span class="number">28176</span>     	Blocks: <span class="number">56</span>         IO Block: <span class="number">4096</span>   regular file</span><br><span class="line">--&gt; Device: fd00h/<span class="number">64768</span>d	Inode: <span class="number">393280</span>      Links: <span class="number">1</span></span><br><span class="line">--&gt; Access: (<span class="number">0755</span>/-rwxr-xr-x)  Uid: (    <span class="number">0</span>/    root)   Gid: (    <span class="number">0</span>/    root)</span><br><span class="line">--&gt; Access: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">21</span> <span class="number">05</span>:<span class="number">41</span>:<span class="number">48.000000000</span> +<span class="number">0800</span></span><br><span class="line">--&gt; Modify: <span class="number">2014</span>-<span class="number">10</span>-<span class="number">15</span> <span class="number">12</span>:<span class="number">51</span>:<span class="number">07.000000000</span> +<span class="number">0800</span></span><br><span class="line">--&gt; Change: <span class="number">2015</span>-<span class="number">08</span>-<span class="number">21</span> <span class="number">05</span>:<span class="number">41</span>:<span class="number">48.910998268</span> +<span class="number">0800</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## -Z, --context 打印selinux安全上下文 不常用</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -f, --file-system 显示文件所在的文件系统的状态</span></span><br><span class="line">$ <span class="built_in">stat</span> --file-system <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">			  File: <span class="string">"echo"</span></span><br><span class="line">		    	ID: <span class="number">967</span>e9fcacf39b33a Namelen: <span class="number">255</span>     Type: ext2/ext3</span><br><span class="line">		Block size: <span class="number">4096</span>       Fundamental block size: <span class="number">4096</span></span><br><span class="line">		Blocks: Total: <span class="number">12371645</span>   Free: <span class="number">11518437</span>   Available: <span class="number">10888319</span></span><br><span class="line">		Inodes: Total: <span class="number">3153920</span>    Free: <span class="number">3055295</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -c  --format=FORMAT 自定义输出格式，结尾有换行</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## --printf=FORMAT 自定义输出格式，结尾无换行符，需手动添加</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -t, --terse  以简洁的形式打印输出信息（在没有改变输出格式的情况下）</span></span><br><span class="line">$ <span class="built_in">stat</span> -t <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">--&gt; <span class="built_in">echo</span> <span class="number">9</span> <span class="number">0</span> a1ff <span class="number">0</span> <span class="number">0</span> fd00 <span class="number">266232</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1440202268</span> <span class="number">1440202265</span> <span class="number">1440202265</span> <span class="number">4096</span></span><br><span class="line"></span><br><span class="line">@@ FORMAT</span><br><span class="line"><span class="comment">## %a 八进制格式的文件访问权限</span></span><br><span class="line">$ <span class="built_in">stat</span> -c <span class="string">'%a'</span> <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">--&gt; <span class="number">777</span></span><br><span class="line"><span class="comment">## %A 可读形式访问权限</span></span><br><span class="line">$ <span class="built_in">stat</span> -c <span class="string">'%A'</span> <span class="built_in">echo</span></span><br><span class="line"></span><br><span class="line">--&gt; lrwxrwxrwx</span><br><span class="line"><span class="comment">## ...</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="echo"><a class="header-anchor" href="#echo"></a>echo</h2>
<p><strong>echo是一个内建命令,将参数显示到标准输出</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"><span class="built_in">echo</span>: <span class="built_in">echo</span> [<span class="operator">-ne</span>E] [arg ...]</span><br><span class="line"></span><br><span class="line">@@Options:</span><br><span class="line"><span class="comment">## -n 输出文字后不换行</span></span><br><span class="line">$ <span class="built_in">echo</span> -n <span class="string">'this is my new life.'</span></span><br><span class="line">--&gt; this is my new life.(此处没有换行)[root@lcyan tmp]<span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -e 允许对转义字符的解析</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">'\t this my \n new life.'</span></span><br><span class="line">--&gt;  	 this my</span><br><span class="line">--&gt;  new life.</span><br><span class="line"><span class="comment">## -E 显式地抑制反斜杠转义的解释</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="operator">-e</span> <span class="string">'\t this my \n new life.'</span></span><br><span class="line">--&gt;  \t this my \n new life.</span><br><span class="line"></span><br><span class="line">@@ backslash-escaped characters</span><br><span class="line">\a 发出警告声；</span><br><span class="line">\b 删除前一个字符；</span><br><span class="line">\c 最后不加上换行符号；</span><br><span class="line">\f 换行但光标仍旧停留在原来的位置；</span><br><span class="line">\n 换行且光标移至行首；</span><br><span class="line">\r 光标移至行首，但不换行；</span><br><span class="line">\t 插入tab；</span><br><span class="line">\v 与\f相同；</span><br><span class="line">\\ 插入 \ 字符；</span><br><span class="line">\nnn 插入nnn（八进制）所代表的ASCII字符；</span><br></pre></td></tr></table></figure>
<h2 id="shutdown"><a class="header-anchor" href="#shutdown"></a>shutdown</h2>
<p><strong>shutdown是一个管理员命令,该命令可以安全关闭或者重新启动系统。在最后五分钟时间内，新的登录被阻止。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">shutdown [OPTION]...  TIME [MESSAGE]</span><br><span class="line"></span><br><span class="line">@@ Options</span><br><span class="line"><span class="comment">## -r 关闭系统然后重新启动，类似于Windows平台restart</span></span><br><span class="line">$ shutdown -r</span><br><span class="line"></span><br><span class="line"><span class="comment">## -h 关闭电源</span></span><br><span class="line">$ shutdown -h</span><br><span class="line"></span><br><span class="line"><span class="comment">## -c 中断关机：当执行"shutdown -h 12:00"指令时，只要按+键就可以中断关机的指令</span></span><br><span class="line">$ shutdown -c</span><br><span class="line">--&gt; shutdown: Shutdown cancelled</span><br><span class="line">--&gt; [<span class="number">1</span>]+  Done                    shutdown -h <span class="number">15</span>:<span class="number">33</span></span><br><span class="line"><span class="comment">## -k 只有发出警告信息，并禁止登录，实际上不关闭系统。</span></span><br><span class="line">$  shutdown -k <span class="string">"14:22"</span> <span class="string">'I will be closed.'</span></span><br></pre></td></tr></table></figure>
<h2 id="halt"><a class="header-anchor" href="#halt"></a>halt</h2>
<p><strong>halt是一个管理员命令,其实halt就是调用shutdown -h。halt执行时﹐杀死应用进程﹐执行sync系统调用﹐文件系统写操作完成后就会停止内核</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">reboot [OPTION]...</span><br><span class="line">halt [OPTION]...</span><br><span class="line">poweroff [OPTION]...</span><br><span class="line"></span><br><span class="line">@@OPTIONS</span><br><span class="line"><span class="comment">## -f, --force 没有调用shutdown而强制关机或重启。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -p, --poweroff 该选项为缺省选项。就是关机时调用poweroff。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -w, --wtmp-only 并不是真正的重启或关机﹐只是写wtmp〔/var/log/wtmp〕纪录。</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## --verbose 重新启动系统时输出稍微更详细的消息，对于调试问题停机是有用的。</span></span><br><span class="line">$</span><br></pre></td></tr></table></figure>
<h2 id="reboot"><a class="header-anchor" href="#reboot"></a>reboot</h2>
<p><strong>reboot,重启系统,参数参见halt</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br></pre></td></tr></table></figure>
<h2 id="poweroff"><a class="header-anchor" href="#poweroff"></a>poweroff</h2>
<p><strong>poweroff,重启系统,参数参见halt</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br></pre></td></tr></table></figure>
<h2 id="who"><a class="header-anchor" href="#who"></a>who</h2>
<p><strong>who,显示目前登入系统的用户信息。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">who [OPTION]... [ FILE | ARG1 ARG2 ]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -a, --all same as -b -d --login -p -r -t -T -u</span></span><br><span class="line">$ who a</span><br><span class="line">--&gt;            system boot  <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">57</span></span><br><span class="line">--&gt;            run-level <span class="number">5</span>  <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">57</span></span><br><span class="line">--&gt; LOGIN      tty3         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2160</span> id=<span class="number">3</span></span><br><span class="line">--&gt; LOGIN      tty2         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2158</span> id=<span class="number">2</span></span><br><span class="line">--&gt; LOGIN      tty4         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2166</span> id=<span class="number">4</span></span><br><span class="line">--&gt; LOGIN      tty5         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2168</span> id=<span class="number">5</span></span><br><span class="line">--&gt; LOGIN      tty6         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2170</span> id=<span class="number">6</span></span><br><span class="line">--&gt; root     + pts/<span class="number">0</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">59</span> <span class="number">00</span>:<span class="number">05</span>        <span class="number">2363</span> (<span class="number">192.168</span>.<span class="number">1.104</span>)</span><br><span class="line">--&gt; root     + pts/<span class="number">1</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">59</span>   .          <span class="number">2403</span> (<span class="number">192.168</span>.<span class="number">1.104</span>)</span><br><span class="line">--&gt;            pts/<span class="number">2</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">12</span>:<span class="number">51</span>              <span class="number">6135</span> id=ts/<span class="number">2</span>  term=<span class="number">0</span> <span class="built_in">exit</span>=<span class="number">0</span></span><br><span class="line">--&gt;            pts/<span class="number">3</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">12</span>:<span class="number">51</span>              <span class="number">6175</span> id=ts/<span class="number">3</span>  term=<span class="number">0</span> <span class="built_in">exit</span>=<span class="number">0</span></span><br><span class="line"><span class="comment">## -b, --boot 上次系统启动时间</span></span><br><span class="line">$ who -b</span><br><span class="line">--&gt;           system boot  <span class="number">2015</span>-<span class="number">08</span>-<span class="number">08</span> <span class="number">22</span>:<span class="number">06</span></span><br><span class="line"><span class="comment">## -d --deal 打印死亡进程</span></span><br><span class="line">$ who <span class="operator">-d</span></span><br><span class="line">--&gt;           pts/<span class="number">1</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">21</span> <span class="number">12</span>:<span class="number">57</span>              <span class="number">3545</span> id=ts/<span class="number">1</span>  term=<span class="number">0</span> <span class="built_in">exit</span>=<span class="number">0</span></span><br><span class="line"><span class="comment">## -H, --heading 打印列标题</span></span><br><span class="line">$ who -H</span><br><span class="line">--&gt;  NAME     LINE         TIME             COMMENT</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">59</span> (<span class="number">192.168</span>.<span class="number">1.104</span>)</span><br><span class="line">--&gt;  root     pts/<span class="number">1</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">59</span> (<span class="number">192.168</span>.<span class="number">1.104</span>)</span><br><span class="line">--&gt;  root     pts/<span class="number">2</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">13</span>:<span class="number">19</span> (<span class="number">192.168</span>.<span class="number">1.104</span>)</span><br><span class="line"><span class="comment">## -l --login 打印系统登陆进程</span></span><br><span class="line">$ who <span class="operator">-l</span>H</span><br><span class="line">--&gt;  NAME     LINE         TIME             IDLE          PID COMMENT</span><br><span class="line">--&gt;  LOGIN    tty3         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2160</span> id=<span class="number">3</span></span><br><span class="line">--&gt;  LOGIN    tty2         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2158</span> id=<span class="number">2</span></span><br><span class="line">--&gt;  LOGIN    tty4         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2166</span> id=<span class="number">4</span></span><br><span class="line">--&gt;  LOGIN    tty5         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2168</span> id=<span class="number">5</span></span><br><span class="line">--&gt;  LOGIN    tty6         <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">08</span>:<span class="number">58</span>              <span class="number">2170</span> id=<span class="number">6</span></span><br><span class="line"><span class="comment">## --lookup 试图通过规范化的DNS主机名</span></span><br><span class="line">$ who --lookup</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">07</span>:<span class="number">53</span> (<span class="number">114.241</span>.<span class="number">25.195</span>)</span><br><span class="line"><span class="comment">## -m 只与标准输入相关的主机名和用户</span></span><br><span class="line">$</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">07</span>:<span class="number">53</span> (<span class="number">114.241</span>.<span class="number">25.195</span>)</span><br><span class="line"><span class="comment">## -p, --process 打印由init启动，活动进程</span></span><br><span class="line">$ who -p</span><br><span class="line"></span><br><span class="line"><span class="comment">## -q, --count 统计登陆的个数</span></span><br><span class="line">$ who -q</span><br><span class="line">--&gt;  root root root</span><br><span class="line">--&gt;  <span class="comment"># users=3</span></span><br><span class="line"><span class="comment">## -r, --runlevel 打印当前的运行级别</span></span><br><span class="line">$ who -r</span><br><span class="line">--&gt;  run-level <span class="number">3</span>  <span class="number">2015</span>-<span class="number">08</span>-<span class="number">08</span> <span class="number">22</span>:<span class="number">06</span></span><br><span class="line"><span class="comment">## -s, --short 打印简短的格式(默认的选项)</span></span><br><span class="line">$ who <span class="operator">-s</span></span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>        <span class="number">2015</span>-<span class="number">08</span>-<span class="number">22</span> <span class="number">07</span>:<span class="number">53</span> (<span class="number">114.241</span>.<span class="number">25.195</span>)</span><br><span class="line"><span class="comment">##-t, --time 打印最后一次时间的变化</span></span><br><span class="line">$ who -t</span><br><span class="line"></span><br><span class="line"><span class="comment">## -T, -w, --mesg</span></span><br><span class="line">$</span><br><span class="line"></span><br><span class="line"><span class="comment">## -u, --users</span></span><br><span class="line"><span class="comment">## --message</span></span><br><span class="line"><span class="comment">## --writable</span></span><br></pre></td></tr></table></figure>
<h2 id="w"><a class="header-anchor" href="#w"></a>w</h2>
<p><strong>w,显示目前谁登陆到系统以及它们在做什么。</strong></p>
<p>*** w命令的显示项目按以下顺序排列：当前时间，系统启动到现在的时间，登录用户的数目，系统在最 近1秒、5秒和15分钟的平均负载。然后是每个用户的各项数据，项目显示顺序如下：登录帐号、终端名称、远 程主机名、登录时间、空闲时间、JCPU、PCPU、当前正在运行进程的命令行。***</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line">w - [husfiV] [user]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -h 不显示标题</span></span><br><span class="line">$ w -h</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>    <span class="number">114.241</span>.<span class="number">25.195</span>   <span class="number">13</span>:<span class="number">42</span>    <span class="number">0.00</span>s  <span class="number">0.18</span>s  <span class="number">0.00</span>s w -h</span><br><span class="line"><span class="comment">## -u 当列出当前进程和CPU时间时忽略用户名。这主要是用于执行su命令后的情况</span></span><br><span class="line">$ w -u</span><br><span class="line">--&gt;   <span class="number">13</span>:<span class="number">46</span>:<span class="number">00</span> up <span class="number">52</span> days, <span class="number">49</span> min,  <span class="number">1</span> user,  load average: <span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.00</span></span><br><span class="line">--&gt;  USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>    <span class="number">114.241</span>.<span class="number">25.195</span>   <span class="number">13</span>:<span class="number">42</span>    <span class="number">0.00</span>s  <span class="number">0.19</span>s  <span class="number">0.00</span>s w -u</span><br><span class="line"></span><br><span class="line"><span class="comment">## -f 切换显示FROM项，也就是远程主机名项。默认值是不显示远程主机名，</span></span><br><span class="line"><span class="comment">## 当然系统管理员可以对源文件 ##作一些修改使得显示该项成为默认值。</span></span><br><span class="line">$ w <span class="operator">-f</span></span><br><span class="line">--&gt;   <span class="number">13</span>:<span class="number">47</span>:<span class="number">53</span> up <span class="number">52</span> days, <span class="number">51</span> min,  <span class="number">1</span> user,  load average: <span class="number">0.00</span>, <span class="number">0.00</span>, <span class="number">0.00</span></span><br><span class="line">--&gt;  USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>     <span class="number">13</span>:<span class="number">42</span>    <span class="number">0.00</span>s  <span class="number">0.21</span>s  <span class="number">0.00</span>s w <span class="operator">-f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## -i显示IP地址代替主机名(如果可能)</span></span><br><span class="line">$ w -i</span><br><span class="line">--&gt;   <span class="number">13</span>:<span class="number">51</span>:<span class="number">27</span> up  <span class="number">4</span>:<span class="number">53</span>,  <span class="number">3</span> users,  load average: <span class="number">0.02</span>, <span class="number">0.01</span>, <span class="number">0.00</span></span><br><span class="line">--&gt;  USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">--&gt;  root     pts/<span class="number">0</span>    <span class="number">192.168</span>.<span class="number">1.104</span>    <span class="number">08</span>:<span class="number">59</span>   <span class="number">13</span>:<span class="number">07</span>   <span class="number">0.65</span>s  <span class="number">0.00</span>s man w</span><br><span class="line">--&gt;  root     pts/<span class="number">1</span>    <span class="number">192.168</span>.<span class="number">1.104</span>    <span class="number">08</span>:<span class="number">59</span>    <span class="number">0.00</span>s  <span class="number">1.67</span>s  <span class="number">0.00</span>s w -i</span><br><span class="line">--&gt;  root     pts/<span class="number">2</span>    <span class="number">192.168</span>.<span class="number">1.104</span>    <span class="number">13</span>:<span class="number">19</span>   <span class="number">15</span>:<span class="number">08</span>   <span class="number">0.14</span>s  <span class="number">0.14</span>s -bash</span><br></pre></td></tr></table></figure>
<h2 id="whoami"><a class="header-anchor" href="#whoami"></a>whoami</h2>
<p><strong>whoami,打印与当前的有效用户ID相关联的用户名。</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## SYNOPSIS</span></span><br><span class="line"></span><br><span class="line">$ whoami</span><br><span class="line">--&gt; root</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p><em>文中 <code>--&gt;</code> 为开头的为命令行的输出.</em></p>
<p><em>涉及到的命令有,date,clock,hwclock,cal,ls,cd,pwd,tty,whereis,which,stat,echo,shutdown,halt,reboot,poweroff,who,w,whoami</em></p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="Task" scheme="http://molloc.me/categories/Task/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello Hexo]]></title>
    <link href="http://molloc.me/2015/06/29/hello-hexo/"/>
    <id>http://molloc.me/2015/06/29/hello-hexo/</id>
    <published>2015-06-29T10:14:22.403Z</published>
    <updated>2015-06-28T07:42:34.000Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="quick-start"><a class="header-anchor" href="#quick-start"></a>Quick Start</h2>
<h3 id="create-a-new-post"><a class="header-anchor" href="#create-a-new-post"></a>Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<a id="more"></a>
### Run server
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="generate-static-files"><a class="header-anchor" href="#generate-static-files"></a>Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="deploy-to-remote-sites"><a class="header-anchor" href="#deploy-to-remote-sites"></a>Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="quick-start"><a class="header-anchor" href="#quick-start"></a>Quick Start</h2>
<h3 id="create-a-new-post"><a class="header-anchor" href="#create-a-new-post"></a>Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html">Writing</a></p>]]>
    
    </summary>
    
      <category term="探索发现" scheme="http://molloc.me/categories/%E6%8E%A2%E7%B4%A2%E5%8F%91%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Cars]]></title>
    <link href="http://molloc.me/2015/06/29/Cars/"/>
    <id>http://molloc.me/2015/06/29/Cars/</id>
    <published>2015-06-29T10:14:22.049Z</published>
    <updated>2015-06-28T07:42:34.000Z</updated>
    <content type="html"><![CDATA[<p>Founded in 1963, Automobili Lamborghini is headquartered in Sant’Agata Bolognese, in Northeastern Italy. There it manufactures some of the world’s most sought-after super sports cars. With the presentation of the Huracán LP 610-4, Lamborghini offers a new dimension in luxury super sports cars.
With 122 dealerships worldwide, Automobili Lamborghini is building on a succession of dynamic and elegant super sports cars including the 350GT, Miura, Espada, Countach, Diablo, Murciélago, Reventón Coupe, Reventón Roadster, Aventador and Gallardo.</p>
<p><img src="http://static.molloc.com/cars/1363048919SWhAHn.jpg" alt="Wallbase - dgnfly (wallbase.cc/wallpaper/1384450)" title="Car002"></p>
<a id="more"></a>
<p>At the  Beijing Motorshow 2014 Automobili Lamborghini is also going to present the Aventador in a highly exclusive and appealing configuration called Nazionale, realized  by Lamborghini Ad Personam, the personalization program that allows clients to create their own made-to-order Lamborghini.</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Founded in 1963, Automobili Lamborghini is headquartered in Sant’Agata Bolognese, in Northeastern Italy. There it manufactures some of the world’s most sought-after super sports cars. With the presentation of the Huracán LP 610-4, Lamborghini offers a new dimension in luxury super sports cars.
With 122 dealerships worldwide, Automobili Lamborghini is building on a succession of dynamic and elegant super sports cars including the 350GT, Miura, Espada, Countach, Diablo, Murciélago, Reventón Coupe, Reventón Roadster, Aventador and Gallardo.</p>
<p><img src="http://static.molloc.com/cars/1363048919SWhAHn.jpg" alt="Wallbase - dgnfly (wallbase.cc/wallpaper/1384450)" title="Car002"></p>]]>
    
    </summary>
    
      <category term="Cars" scheme="http://molloc.me/tags/Cars/"/>
    
      <category term="美图世界" scheme="http://molloc.me/categories/%E7%BE%8E%E5%9B%BE%E4%B8%96%E7%95%8C/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[awk基础]]></title>
    <link href="http://molloc.me/2015/06/29/awk%E5%9F%BA%E7%A1%80/"/>
    <id>http://molloc.me/2015/06/29/awk基础/</id>
    <published>2015-06-29T10:14:14.000Z</published>
    <updated>2015-06-29T13:52:34.500Z</updated>
    <content type="html"><![CDATA[<h2 id="awk简介"><a class="header-anchor" href="#awk简介"></a>awk简介</h2>
<p><code>awk</code> : 中文意思是报告生成器 能够根据我们输入的信息，将信息格式化以后显示，将定义好的信息以比较美观（直观）的方式显示出来出现比较早，继而出现了new awk（nawk）在windows上实现，gawk, awk实现在linux上。awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk的处理文本和数据的方式是这样的，它逐行扫描文件，从第一行到最后一行，寻找匹配的特定模式的行，并在这些行上进行你想要的操作。如果没有指定处理动作，则把匹配的行显示到标准输出(屏幕)，如果没有指定模式，则所有被操作所指定的行都被处理。awk分别代表其作者姓氏的第一个字母，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。下面就对awk进行介绍。</p>
<a id="more"></a>
<h2 id="awk使用的基本格式"><a class="header-anchor" href="#awk使用的基本格式"></a>awk使用的基本格式</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">awk [options] <span class="string">'script'</span> file1 file2, …</span><br><span class="line"></span><br><span class="line">awk [options] <span class="string">'PATTERN &#123; action &#125;'</span> file1 file2, <span class="comment"># 细化了上面的组合</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="comment">#输出</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span> <span class="comment">#打印</span></span><br></pre></td></tr></table></figure>
<h2 id="awk工作过程"><a class="header-anchor" href="#awk工作过程"></a>awk工作过程</h2>
<p>根据我们所定义的模式，一次从文件中读取一行文本，awk会对取出的文本做相应的切片，将每一行按照分隔符进行切割，假如我们有一行文本:this is a test.它会使用空白字符当做分隔符，将它们各个分开，切割成了四个片，分别为： this is a test.这四个片，可以使用变量，分别对应为$1,$2,$3,$4代表四个切割片，下面就做一个演示，看如何实现awk的强大功能</p>
<h2 id="awk的输出-print"><a class="header-anchor" href="#awk的输出-print"></a>awk的输出: print</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> item1, item2, …	<span class="comment">#print的使用格式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出要点：</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#1、各项目之间使用逗号隔开，而输出时则以空白字符分隔；</span></span><br><span class="line"><span class="comment">#2、输出的item可以为字符串或数值、当前记录的字段(如$1)、变量或awk的表达式；数值会先转换为字符串，而后再输出；</span></span><br><span class="line"><span class="comment">#3、print命令后面的item可以省略，此时其功能相当于print $0, 因此，如果想输出空白行，则需要使用print ""；</span></span><br></pre></td></tr></table></figure>
<h3 id="实例分析："><a class="header-anchor" href="#实例分析："></a>实例分析：</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -&gt; 符号后面的是命令</span></span><br><span class="line"><span class="comment"># 显示整个文本（注意，这里只是测试，所以只有一行）</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $N&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this is a test.</span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $0&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this is a test.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的一行中的第一个参数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $1&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的一行中的第二个参数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">is</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的一行中的第四个参数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $4&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">test.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的一行中的第一与第二个个参数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $1,$2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this is</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的一行中的第一个与第二个参数，中间可以加#号</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'BEGIN&#123;OFS="#"&#125;&#123;print $1,$2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this<span class="comment">#is</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本中的各个参数，还可以加修饰符</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'BEGIN&#123;OFS=":"&#125;&#123;print $1,$2,$3,$4&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this:is:a:test.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本中的参数，还可以加修饰符，还可以加字符串</span></span><br><span class="line"></span><br><span class="line">-&gt;  awk <span class="string">'BEGIN&#123;OFS=":"&#125;&#123;print $1,"hello",$2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this:hello:is</span><br><span class="line"></span><br><span class="line">输出三行，注意换行需要加\n</span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'BEGIN &#123; print "line one\nline two\nline three" &#125;'</span></span><br><span class="line"></span><br><span class="line">line one</span><br><span class="line">line two</span><br><span class="line">line three</span><br></pre></td></tr></table></figure>
<h2 id="awk变量"><a class="header-anchor" href="#awk变量"></a>awk变量</h2>
<h3 id="awk内置变量之记录变量"><a class="header-anchor" href="#awk内置变量之记录变量"></a>awk内置变量之记录变量</h3>
<ul>
<li>FS: field separator，读取文本时所使用的字段分隔符</li>
<li>RS: Record separator，读取文本信息所使用的换行符</li>
<li>OFS: Output Filed Separator: 输出文本时使用的字段分隔符</li>
<li>ORS：Output Row Separator：输出文本时使用的行分隔符</li>
</ul>
<h3 id="awk内置变量之数据变量"><a class="header-anchor" href="#awk内置变量之数据变量"></a>awk内置变量之数据变量</h3>
<ul>
<li>NR: The number of input records，awk命令所处理的记录数；如果有多个文件，这个数目会把处理的多个文件中行统一计数；</li>
<li>NF：Number of Field，当前记录的field个数；</li>
<li>FNR: 与NR不同的是，FNR用于记录正处理的行是当前这一文件中被总共处理的行数；</li>
<li>ARGV: 数组，保存命令行本身这个字符串，如awk '{print $0}' a.txt b.txt这个命令中，ARGV[0]保存awk，ARGV[1]保存a.txt；</li>
<li>ARGC: awk命令的参数的个数；</li>
<li>FILENAME: awk命令所处理的文件的名称;</li>
<li>ENVIRON：当前shell环境变量及其值的关联数组；</li>
</ul>
<h3 id="实例分析"><a class="header-anchor" href="#实例分析"></a>实例分析</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示文本的行数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;print NR&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示一行总共有几个参数</span></span><br><span class="line">-&gt; awk <span class="string">'&#123;print NF&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示文本的最后一个参数</span></span><br><span class="line">-&gt; awk <span class="string">'&#123;print $NF&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">test.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同时查看多个文本</span></span><br><span class="line">-&gt; awk <span class="string">'&#123;print FNR&#125;'</span> test.txt /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>  显示的是第一个文本的行数</span><br><span class="line"><span class="number">1</span>  显示的是第二个文本的第一行数，以此类推</span><br><span class="line"><span class="number">2</span>  显示的是第二个文本的第二行数</span><br><span class="line"><span class="number">3</span>  显示的是第二个文本的第三行数</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看环境变量</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'BEGIN&#123;print ENVIRON["PATH"]&#125;'</span></span><br><span class="line"></span><br><span class="line">/usr/kerberos/sbin:/usr/kerberos/bin:/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/sbin:/ \</span><br><span class="line">bin:/usr/sbin:/usr/bin:/usr/<span class="built_in">local</span>/apache/bin:/usr/<span class="built_in">local</span>/mysql/bin:/root/bin</span><br></pre></td></tr></table></figure>
<h2 id="用户自定义变量"><a class="header-anchor" href="#用户自定义变量"></a>用户自定义变量</h2>
<p>gawk允许用户自定义自己的变量以便在程序代码中使用，变量名命名规则与大多数编程语言相同，只能使用字母、数字和下划线，且不能以数字开头。gawk变量名称区分字符大小写。</p>
<h3 id="在脚本中赋值变量"><a class="header-anchor" href="#在脚本中赋值变量"></a>在脚本中赋值变量</h3>
<p>在gawk中给变量赋值使用赋值语句进行</p>
<h3 id="在命令行中使用赋值变量"><a class="header-anchor" href="#在命令行中使用赋值变量"></a>在命令行中使用赋值变量</h3>
<p>gawk命令也可以在“脚本”外为变量赋值，并在脚本中进行引用。</p>
<h3 id="实例分析-v2"><a class="header-anchor" href="#实例分析-v2"></a>实例分析</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输出一个变量，并赋值</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'BEGIN&#123;var="variable testing";print var&#125;'</span></span><br><span class="line"></span><br><span class="line">variable testing</span><br><span class="line"></span><br><span class="line">-&gt; awk -v var=<span class="string">"variable testing"</span> <span class="string">'BEGIN&#123;print var&#125;'</span></span><br><span class="line"></span><br><span class="line">variable testing</span><br></pre></td></tr></table></figure>
<h2 id="awk打印工具：printf"><a class="header-anchor" href="#awk打印工具：printf"></a>awk打印工具：printf</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> format, item1, item2, …</span><br></pre></td></tr></table></figure>
<h3 id="printf要点："><a class="header-anchor" href="#printf要点："></a>printf要点：</h3>
<ol>
<li>其与print命令的最大不同是，printf需要指定format；</li>
<li>format用于指定后面的每个item的输出格式；</li>
<li>printf语句不会自动打印换行符；需要添加\n</li>
</ol>
<p>format格式的指示符都以%开头，后跟一个字符；如下：</p>
<ul>
<li>%c: 显示第一个参数的第一个字符</li>
<li>%d, %i：十进制整数；</li>
<li>%e, %E：科学计数法显示数值；</li>
<li>%f: 显示浮点数；</li>
<li>%g, %G: 以科学计数法的格式或浮点数的格式显示数值；</li>
<li>%s: 显示字符串；</li>
<li>%u: 无符号整数；</li>
<li>%%: 显示%自身；</li>
</ul>
<p>修饰符：</p>
<ul>
<li>N: 显示宽度；</li>
<li>-: 左对齐；</li>
<li>+：显示数值符号；</li>
</ul>
<p>示例:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">-&gt; awk <span class="string">'&#123;printf "%c\n”,$1&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">t <span class="comment"># 显示第一个参数的第一个字母</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;printf "%s\n",$1&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this  <span class="comment"># 显示第一个参数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;printf "%10s\n",$1&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this <span class="comment"># 显示时用了10个字符串，默认是右对齐</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;printf "%-10s\n",$1&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this  <span class="comment"># 显示时左对齐，后面有6个空字符串</span></span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;printf "%-10s,%-10s\n",$1,$2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this      ,is</span><br><span class="line"></span><br><span class="line">-&gt; awk <span class="string">'&#123;printf "%-10s%-10s\n",$1,$2&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this      is</span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;printf "%5d",$3&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">    <span class="number">0</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span>    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span>   <span class="number">10</span>   <span class="number">11</span>   <span class="number">12</span>   <span class="number">13</span>   <span class="number">14</span>   <span class="number">99</span>   <span class="number">81</span>   <span class="number">28</span>  <span class="number">69</span> \</span><br><span class="line">    <span class="number">77</span>   <span class="number">38</span>   <span class="number">70</span>   <span class="number">32</span>   <span class="number">47</span>   <span class="number">51</span>   <span class="number">74</span>   <span class="number">16</span>   <span class="number">68</span>  <span class="number">100</span>   <span class="number">2965534</span>   <span class="number">43</span>   <span class="number">42</span>  <span class="number">500</span>  <span class="number">501</span>  <span class="number">502</span>  <span class="number">5032002</span> \</span><br><span class="line">    <span class="number">2003</span> <span class="number">2004</span> <span class="number">4004</span> <span class="number">2033</span> <span class="number">2034</span> <span class="number">4005</span> <span class="number">4006</span> <span class="number">4007</span> <span class="number">4011</span> <span class="number">4017</span> <span class="number">4018</span> <span class="number">4019</span> <span class="number">4026</span> <span class="number">4027</span> <span class="number">4028</span>   <span class="number">48</span>   <span class="number">25</span>  <span class="number">101</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;printf "%-5d\n",$3&#125;'</span> /etc/passwd   <span class="comment"># 左对齐</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;printf "%+5d\n",$3&#125;'</span> /etc/passwd   <span class="comment"># 右对齐</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;printf "%-15s %i\n",$1,$3&#125;'</span> test.txt</span><br><span class="line"></span><br><span class="line">this is a test. <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="输出重定向"><a class="header-anchor" href="#输出重定向"></a>输出重定向</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> items &gt; output-file</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> items &gt;&gt; output-file</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> items | <span class="built_in">command</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 特殊文件描述符：</span></span><br><span class="line"></span><br><span class="line">/dev/stdin: <span class="comment">#标准输入</span></span><br><span class="line"></span><br><span class="line">/dev/sdtout: <span class="comment">#标准输出</span></span><br><span class="line"></span><br><span class="line">/dev/stderr: <span class="comment">#错误输出</span></span><br><span class="line"></span><br><span class="line">/dev/fd/N: <span class="comment"># 某特定文件描述符，如/dev/stdin就相当于/dev/fd/0；</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#例子：</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;printf "%-15s %i\n",$1,$3 &gt; "/dev/stderr" &#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root            <span class="number">0</span></span><br><span class="line">bin             <span class="number">1</span></span><br><span class="line">daemon          <span class="number">2</span></span><br><span class="line">adm             <span class="number">3</span></span><br><span class="line">lp              <span class="number">4</span></span><br><span class="line">sync            <span class="number">5</span></span><br><span class="line">shutdown        <span class="number">6</span></span><br><span class="line">halt            <span class="number">7</span></span><br></pre></td></tr></table></figure>
<h2 id="awk的操作符"><a class="header-anchor" href="#awk的操作符"></a>awk的操作符</h2>
<h3 id="算术操作符"><a class="header-anchor" href="#算术操作符"></a>算术操作符</h3>
<ul>
<li>-x: 负值</li>
<li>+x: 转换为数值；</li>
<li>x^y:</li>
<li>x**y: 次方</li>
<li>x*y: 乘法</li>
<li>x/y：除法</li>
<li>x+y: 加法</li>
<li>x-y: 减法</li>
<li>x%y: 取模</li>
</ul>
<h3 id="字符串操作符"><a class="header-anchor" href="#字符串操作符"></a>字符串操作符</h3>
<p>只有一个，而且不用写出来，用于实现字符串连接；</p>
<h3 id="赋值操作符"><a class="header-anchor" href="#赋值操作符"></a>赋值操作符</h3>
<p><code>=、+=、-=、*=、/=、%=、^=、**=、++、–</code></p>
<p>需要注意的是，如果某模式为=号，此时使用/=/可能会有语法错误，应以/[=]/替代；</p>
<h3 id="布尔值"><a class="header-anchor" href="#布尔值"></a>布尔值</h3>
<p>awk中，任何非0值或非空字符串都为真，反之就为假；</p>
<h3 id="比较操作符"><a class="header-anchor" href="#比较操作符"></a>比较操作符</h3>
<ul>
<li>x &lt; y      x小于y为真，反之为假</li>
<li>x &lt;= y     x小于等于y为真，反之为假</li>
<li>x &gt; y      x大于y为真，反之为假</li>
<li>x &gt;= y     x大于等于y为真，反之为假</li>
<li>x == y    x恒等于y为真，反之为假</li>
<li>x != y    x不等于y为真，反之为假</li>
<li>x ~ y   True if the string x matches the regexp denoted by y.</li>
<li>x !~ y  True if the string x does not match the regexp denoted by y.</li>
<li>subscript in array    True if the array array has an element with the subscript subscript.</li>
</ul>
<h3 id="表达式间的逻辑关系符"><a class="header-anchor" href="#表达式间的逻辑关系符"></a>表达式间的逻辑关系符</h3>
<ul>
<li>&amp;&amp;： 逻辑与</li>
<li>||：逻辑或</li>
</ul>
<h3 id="条件表达式"><a class="header-anchor" href="#条件表达式"></a>条件表达式</h3>
<p><code>a&gt;b?a is max:b is max</code></p>
<h2 id="函数调用function-name-para1-para2"><a class="header-anchor" href="#函数调用function-name-para1-para2"></a>函数调用<code>function_name (para1,para2)</code></h2>
<h2 id="awk的模式"><a class="header-anchor" href="#awk的模式"></a>awk的模式</h2>
<p><code>awk ‘program’ input-file1 input-file2 …</code></p>
<p>其中的program为<code>pattern { action }</code></p>
<h3 id="常见的模式类型"><a class="header-anchor" href="#常见的模式类型"></a>常见的模式类型</h3>
<h4 id="regexp"><a class="header-anchor" href="#regexp"></a>Regexp</h4>
<p>正则表达式，格式为/regular expression/</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如：显示以r开头的行</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'/^r/&#123;print $1&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root</span><br><span class="line">rpc</span><br><span class="line">rtkit</span><br><span class="line">rpcuser</span><br></pre></td></tr></table></figure>
<h4 id="expresssion"><a class="header-anchor" href="#expresssion"></a>expresssion</h4>
<p>表达式，其值非0或为非空字符时满足条件，</p>
<p>如：\$1 ~ /foo/ 或 \$1 == &quot;magedu&quot;，用运算符~(匹配)和~!(不匹配)。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示id号小于等于2的用户和id号</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'$3-1&lt;5&#123;print $1,$3&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root /bin/bash</span><br><span class="line">nexus /bin/bash</span><br><span class="line">user1 /bin/bash</span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'$3&lt;=5&#123;print $1,$3&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root <span class="number">0</span></span><br><span class="line">bin <span class="number">1</span></span><br><span class="line">daemon <span class="number">2</span></span><br><span class="line">adm <span class="number">3</span></span><br><span class="line">lp <span class="number">4</span></span><br><span class="line">sync <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出默认shell为bash的用户</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'$7~"bash$"&#123;print $1,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root /bin/bash</span><br><span class="line">nexus /bin/bash</span><br><span class="line">user1 /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示默认shell不是bash的用户</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'$7!~"bash"&#123;print $1,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">haldaemon /sbin/nologin</span><br><span class="line">gdm /sbin/nologin</span><br><span class="line">ntp /sbin/nologin</span><br><span class="line">apache /sbin/nologin</span><br><span class="line">saslauth /sbin/nologin</span><br><span class="line">postfix /sbin/nologin</span><br><span class="line">pulse /sbin/nologin</span><br><span class="line">sshd /sbin/nologin</span><br></pre></td></tr></table></figure>
<h4 id="ranges"><a class="header-anchor" href="#ranges"></a>Ranges</h4>
<p>指定的匹配范围，格式为pat1,pat2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示id号为0或者shell为/sbin/nologin的用户</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'$3==0,$7~"nologin"&#123;print $1,$3,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root <span class="number">0</span> /bin/bash</span><br><span class="line">bin <span class="number">1</span> /sbin/nologin</span><br></pre></td></tr></table></figure>
<h4 id="begin-end"><a class="header-anchor" href="#begin-end"></a>BEGIN/END</h4>
<p>特殊模式，仅在awk命令执行前运行一次或结束前运行一次</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">-&gt; awk -F: <span class="string">'$3==0,$7~"nologin"&#123;printf "%-10s%-20s\n",$1,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root      /bin/bash</span><br><span class="line">bin       /sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以在显示时显示表头</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'BEGIN&#123;printf "%-20s%-20s\n","Username","shell"&#125;&#123;printf "%-20s%-20s\n",$1,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">Username            shell</span><br><span class="line">root                /bin/bash</span><br><span class="line">bin                 /sbin/nologin</span><br><span class="line">daemon              /sbin/nologin</span><br><span class="line">adm                 /sbin/nologin</span><br><span class="line">lp                  /sbin/nologin</span><br><span class="line">sync                /bin/sync</span><br><span class="line">shutdown            /sbin/shutdown</span><br><span class="line">halt                /sbin/halt</span><br><span class="line">mail                /sbin/nologin</span><br><span class="line">uucp                /sbin/nologin</span><br><span class="line">operator            /sbin/nologin</span><br><span class="line">games               /sbin/nologin</span><br><span class="line">gopher              /sbin/nologin</span><br><span class="line">ftp                 /sbin/nologin</span><br><span class="line">nobody              /sbin/nologin</span><br><span class="line">dbus                /sbin/nologin</span><br><span class="line">usbmuxd             /sbin/nologin</span><br><span class="line">vcsa                /sbin/nologin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示表头和表尾</span></span><br><span class="line"></span><br><span class="line">-&gt;  awk -F: <span class="string">'BEGIN&#123;print "Username  shell"&#125; &#123;printf "%-10s%-20s\n",$1,$7&#125;END &#123;print "END OF report"&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">Username  shell</span><br><span class="line">root      /bin/bash</span><br><span class="line">bin       /sbin/nologin</span><br><span class="line">END OF report</span><br></pre></td></tr></table></figure>
<h4 id="empty-空模式"><a class="header-anchor" href="#empty-空模式"></a>Empty(空模式)</h4>
<p>匹配任意输入行，对文件中的每一行做匹配</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-&gt; awk -F:  <span class="string">'&#123;printf "%-10s%-20s\n",$1,$7&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root      /bin/bash</span><br><span class="line">bin       /sbin/nologin</span><br><span class="line">daemon    /sbin/nologin</span><br><span class="line">adm       /sbin/nologin</span><br></pre></td></tr></table></figure>
<h2 id="常见的action-动作"><a class="header-anchor" href="#常见的action-动作"></a>常见的Action（动作）</h2>
<h3 id="expressions-表达式"><a class="header-anchor" href="#expressions-表达式"></a>Expressions:表达式</h3>
<h3 id="control-statements"><a class="header-anchor" href="#control-statements"></a>Control statements</h3>
<p>控制语句（if、while…do、for….)</p>
<h4 id="if-else"><a class="header-anchor" href="#if-else"></a>if-else</h4>
<p>语法: <code>if (condition) {then-body} else {[ else-body ]}</code></p>
<p>示例:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 若用户是root则显示"admin"否则显示为"Common user"</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;if ($1=="root") print $1,"admin"; else print $1, "Common user"&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root admin</span><br><span class="line">bin Common user</span><br><span class="line">daemon Common user</span><br><span class="line">adm Common user</span><br><span class="line">lp Common user</span><br><span class="line">sync Common user</span><br><span class="line">shutdown Common user</span><br><span class="line">halt Common user</span><br><span class="line">mail Common user</span><br><span class="line">uucp Common user</span><br><span class="line">operator Common user</span><br><span class="line">games Common user</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这是对上面的语法格式化了，看起来更美观</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;if ($1=="root") printf "%-15s: %s\n", $1,"Admin"; else printf "%-15s: %s\n", $1, "Common User"&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">root           : admin</span><br><span class="line">bin            : Common User</span><br><span class="line">daemon         : Common User</span><br><span class="line">adm            : Common User</span><br><span class="line">lp             : Common User</span><br><span class="line">sync           : Common User</span><br><span class="line">shutdown       : Common User</span><br><span class="line">halt           : Common User</span><br><span class="line">mail           : Common User</span><br><span class="line">uucp           : Common User</span><br><span class="line">operator       : Common User</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计id号大于等于500的用户个数</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: -v sum=<span class="number">0</span> <span class="string">'&#123;if ($3&gt;=500) sum++&#125;END&#123;print sum&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<h4 id="while"><a class="header-anchor" href="#while"></a>while</h4>
<p>语法： while (condition){statement1; statment2; …}</p>
<p>示例:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示字符串大于等于8的（每一个字符串都要做一下判断）</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;i=1;while (i&lt;=NF) &#123;if (length($i)&gt;=8) &#123;print $i&#125;; i++ &#125;&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">/sbin/nologin</span><br><span class="line">/var/adm</span><br><span class="line">/sbin/nologin</span><br><span class="line">/var/spool/lpd</span><br><span class="line">/sbin/nologin</span><br><span class="line">/bin/sync</span><br><span class="line">shutdown</span><br><span class="line">shutdown</span><br><span class="line">/sbin/shutdown</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示字符串大于等于4的</span></span><br><span class="line"></span><br><span class="line">-&gt; awk -F: <span class="string">'&#123;i=1;while (i&lt;=NF)&#123;if (length($i)&gt;=4) &#123;print $i&#125;; i++&#125;&#125;'</span> /etc/passwd</span><br><span class="line"></span><br><span class="line">bin/sh</span><br><span class="line">mailnull</span><br><span class="line">/var/spool/mqueue</span><br><span class="line">/sbin/nologin</span><br><span class="line">smmsp</span><br><span class="line">/var/spool/mqueue</span><br><span class="line">/sbin/nologin</span><br><span class="line">mysql</span><br><span class="line">/home/mysql</span><br><span class="line">/sbin/nologin</span><br><span class="line">/home/www</span><br><span class="line">/sbin/nologin</span><br></pre></td></tr></table></figure>
<h3 id="compound-statements-复合语句"><a class="header-anchor" href="#compound-statements-复合语句"></a>Compound statements:复合语句</h3>
<h3 id="input-statements：输入语句"><a class="header-anchor" href="#input-statements：输入语句"></a>Input statements：输入语句</h3>
<h3 id="output-statements：输出语句"><a class="header-anchor" href="#output-statements：输出语句"></a>Output statements：输出语句</h3>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="awk简介"><a class="header-anchor" href="#awk简介"></a>awk简介</h2>
<p><code>awk</code> : 中文意思是报告生成器 能够根据我们输入的信息，将信息格式化以后显示，将定义好的信息以比较美观（直观）的方式显示出来出现比较早，继而出现了new awk（nawk）在windows上实现，gawk, awk实现在linux上。awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk的处理文本和数据的方式是这样的，它逐行扫描文件，从第一行到最后一行，寻找匹配的特定模式的行，并在这些行上进行你想要的操作。如果没有指定处理动作，则把匹配的行显示到标准输出(屏幕)，如果没有指定模式，则所有被操作所指定的行都被处理。awk分别代表其作者姓氏的第一个字母，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。下面就对awk进行介绍。</p>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="学习笔记" scheme="http://molloc.me/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Redis使用入门]]></title>
    <link href="http://molloc.me/2015/06/28/Redis%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/"/>
    <id>http://molloc.me/2015/06/28/Redis使用入门/</id>
    <published>2015-06-28T07:31:23.000Z</published>
    <updated>2015-06-28T08:04:30.905Z</updated>
    <content type="html"><![CDATA[<h2 id="redis-introduction"><a class="header-anchor" href="#redis-introduction"></a>Redis Introduction</h2>
<p>Redis是一个用C语言实现的key-value store. 除了最基础的基于字符串的键值对，Redis可以是更加复杂的数据结构，所以redis也常被称为是一个data structure server(数据结构服务器)</p>
<a id="more"></a>
<h2 id="redis支持的数据结构列表"><a class="header-anchor" href="#redis支持的数据结构列表"></a>Redis支持的数据结构列表:</h2>
<ul>
<li>String(字符串)</li>
<li>List(列表, 基本的链表)</li>
<li>Set(元素唯一的, 无序的集合)</li>
<li>Sorted Set(类似于Set, 但是每个字符串元素关联一个浮点数score, 用于排序)</li>
<li>Hash(哈希)</li>
<li>Bitmap</li>
<li>HyperLogLogs</li>
</ul>
<blockquote>
<p>本篇没有涵盖Bitmap和HyperLogLogs的使用</p>
</blockquote>
<h2 id="redis-install"><a class="header-anchor" href="#redis-install"></a>Redis Install</h2>
<p>在Redis下载页面下载需要版本的redis</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压源文件</span></span><br><span class="line">$ tar xzf redis-<span class="number">3.0</span>.<span class="number">2</span>.tar.gz</span><br><span class="line"><span class="comment"># 进入redis文件夹</span></span><br><span class="line">$ <span class="built_in">cd</span> redis-<span class="number">3.0</span>.<span class="number">2</span></span><br><span class="line"><span class="comment"># 编译源文件</span></span><br><span class="line">$ make</span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">$ make <span class="built_in">test</span></span><br><span class="line"><span class="comment"># 提示以下信息表示安装成功</span></span><br><span class="line">\o/ All tests passed without errors!</span><br><span class="line">Cleanup: may take some time... OK</span><br></pre></td></tr></table></figure>
<h3 id="运行redis的服务器端"><a class="header-anchor" href="#运行redis的服务器端"></a>运行Redis的服务器端</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /src/redis-server</span><br></pre></td></tr></table></figure>
<h3 id="运行redis的交互式客户端"><a class="header-anchor" href="#运行redis的交互式客户端"></a>运行Redis的交互式客户端</h3>
<p>用过python应该都理解交互式的意义吧</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /src/redis-cli</span><br></pre></td></tr></table></figure>
<p>在.zshrc设置快捷启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc</span><br><span class="line"><span class="comment"># 在最后一行添加</span></span><br><span class="line"><span class="comment"># Redis shortcur</span></span><br><span class="line"><span class="built_in">alias</span> reds=<span class="string">"/Users/andrew_liu/Development/redis-3.0.2/src/redis-server"</span></span><br><span class="line"><span class="built_in">alias</span> redc=<span class="string">"/Users/andrew_liu/Development/redis-3.0.2/src/redis-cli"</span></span><br><span class="line"><span class="comment"># 保存后, 运行(Esc, :wq把保存并退出)</span></span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br><span class="line"><span class="comment"># 启动Redis服务器</span></span><br><span class="line">$ reds</span><br><span class="line"><span class="comment"># 启动Redis交互式客户端</span></span><br><span class="line">$ redic</span><br></pre></td></tr></table></figure>
<h2 id="redis-keys"><a class="header-anchor" href="#redis-keys"></a>Redis keys</h2>
<p>Redis keys是二进制安全的, 可以使用任何二进制序列作为key, 空的字符串也是有效地key</p>
<h2 id="redis-strings"><a class="header-anchor" href="#redis-strings"></a>Redis Strings</h2>
<p>使用字符串作为value时, 我们在string key和string value之间建立了映射关系</p>
<ul>
<li>value不能大小不能操作512MB</li>
<li>SET命令设置键值对, 重复设置key的value, 会覆盖原来的value</li>
<li>GET命令通过key检索value</li>
<li>INRC命令将给定key的value看做整型, 实现加一操作, 这个命令是原子性的(原子性中是事务ACID特性之一)</li>
<li>GETSET命令通过新的value设置key, 并返回旧的value</li>
<li>MSET和MGET命令分别用于同时设置或检索多个key</li>
<li>EXISTS命令, 如果给定的key存在返回1, 否则返回0</li>
<li>DEL命令删除key-value对</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> mykey hello</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; get mykey</span><br><span class="line"><span class="string">"hello"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; get mykey</span><br><span class="line"><span class="string">"1"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; incr mykey</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; getset mykey how</span><br><span class="line"><span class="string">"2"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; get mykey</span><br><span class="line"><span class="string">"how"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; mset a <span class="number">10</span> b <span class="number">20</span> c <span class="number">30</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; mget a b c</span><br><span class="line"><span class="number">1</span>) <span class="string">"10"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"20"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"30"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; exists a</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; del a</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; exists a</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="redis-定时器"><a class="header-anchor" href="#redis-定时器"></a>Redis 定时器</h2>
<ul>
<li>EXPIRE命令提供定时器功能, 设置key只能存在固定时间, 时间到key会被删除(以秒为单位)</li>
<li>TTL用于查询key还有多长时间被删除.</li>
</ul>
<p>TTL返回-2表示key已经被删除, TTL返回-1表示key不会expire</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; <span class="built_in">set</span> key value</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; get key</span><br><span class="line"><span class="string">"value"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; expire key <span class="number">1000</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; ttl key</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">995</span></span><br><span class="line"><span class="comment"># 1000秒后, 被删除</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; get key</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>
<h2 id="redis-lists"><a class="header-anchor" href="#redis-lists"></a>Redis Lists</h2>
<blockquote>
<p>Redis通过链表来实现List</p>
</blockquote>
<ul>
<li>链表的实现优点是快速的插入和删除, 缺点是检索相对数组实现List慢</li>
<li>LPUSH命令从List的头部插入一个或多个value, 返回插入后的list长度</li>
<li>RPUSH命令从List的尾部插入一个或多个value, 返回插入后的list长度</li>
<li>LLEN命令返回List的长度</li>
<li>LRANGE命令从List取出固定一段子List(类似于python中的切片操作), 有两个索引参数, 都可以为负数</li>
<li>LPOP命令从尾部删除value</li>
<li>RPOP命令从头部删除value, 没有value可删时返回nil</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; rpush list A</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; rpush list B</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; lpush list C</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; llen list</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; lrange list <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"C"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"A"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"B"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; rpush list a b c</span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">6</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; rpop list</span><br><span class="line"><span class="string">"c"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; lpop list</span><br><span class="line"><span class="string">"C"</span></span><br></pre></td></tr></table></figure>
<h2 id="redis-sets"><a class="header-anchor" href="#redis-sets"></a>Redis Sets</h2>
<blockquote>
<p>value为Set, 表示无需的字符串集合</p>
</blockquote>
<ul>
<li>SADD命令向set中增加元素, 如果元素已存在则返回0, 否则返回1</li>
<li>SMEMERS命令返回set集合, 返回的集合与插入时的顺序无关</li>
<li>SISMEMBER命令测试元素是否在set中, 在返回1, 不在返回0</li>
<li>SREM移除set中的元素</li>
<li>SUNION命令链接多个set集合</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; sadd mset <span class="number">1</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; sadd mset <span class="number">1</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; sadd mset <span class="number">2</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; smembers mset</span><br><span class="line"><span class="number">1</span>) <span class="string">"1"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"2"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; sismember mset <span class="number">1</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; sismember mset <span class="number">3</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="redis-sorted-sets"><a class="header-anchor" href="#redis-sorted-sets"></a>Redis Sorted Sets</h2>
<blockquote>
<p>Sorted Set类似于Set和Hash的混合, Sorted Set中的元素也是唯一不重复的字符窜元素, Set中的元素无需, Sorted Set中通过浮点数score排序, Sorted Set通过跳表和哈希表实现, 增加一个元素的复杂度O(log(N))</p>
</blockquote>
<p>排序原则:</p>
<ul>
<li>score不同时, A.score &gt; B.score =&gt; A &gt; B</li>
<li>score相同时, A.score = B.score =&gt; A和B通过比较字符串的字典序进行排序</li>
<li>ZADD命令增加带score的元素, 可以传入多个score-value对</li>
<li>ZRANGE命令类似于LRANGE操作,</li>
<li>ZREVRANGE命令反序输出Sorted set元素片段</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zadd sset <span class="number">1991</span> <span class="string">"liu"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zadd sset <span class="number">1991</span> <span class="string">"andrew"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zadd sset <span class="number">1992</span> <span class="string">"dinosaur"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zadd sset <span class="number">1993</span> <span class="string">"bingo"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zadd sset <span class="number">1994</span> <span class="string">"hello"</span> <span class="number">1995</span> <span class="string">"world"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zrange sset <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"andrew"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"liu"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"dinosaur"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"bingo"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"hello"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"world"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; zrevrange sset <span class="number">0</span> -<span class="number">1</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"world"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"hello"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"bingo"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"dinosaur"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"liu"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"andrew"</span></span><br></pre></td></tr></table></figure>
<h2 id="redis-hashes"><a class="header-anchor" href="#redis-hashes"></a>Redis Hashes</h2>
<ul>
<li>HSET命令设置key中field和field应对的value</li>
<li>HMSET命令用于设置哈希中的多个field</li>
<li>HGET命令用于检索单个field</li>
<li>HMGET命令用于检索多个filed</li>
<li>HGETALL命令获得key的所有的field和field对应的value</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hset user:<span class="number">1001</span> name <span class="string">"jane"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hset user:<span class="number">1001</span> email <span class="string">"jane@gamil.com"</span></span><br><span class="line">(<span class="built_in">integer</span>) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hgetall user:<span class="number">1001</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"name"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"jane"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"email"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"jane@gamil.com"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hmset user:<span class="number">1000</span> username andrewliu birthday <span class="number">2015</span> verfield <span class="number">1</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hget user:<span class="number">1000</span> username</span><br><span class="line"><span class="string">"andrewliu"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hgetall user:<span class="number">1000</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"username"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"andrewliu"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"birthday"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"2015"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"verfield"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"1"</span></span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">6379</span>&gt; hmget user:<span class="number">1000</span> username birthday</span><br><span class="line"><span class="number">1</span>) <span class="string">"andrewliu"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"2015"</span></span><br></pre></td></tr></table></figure>
<h2 id="reference"><a class="header-anchor" href="#reference"></a>Reference</h2>
<ul>
<li><a href="http://redisbook.com/" target="_blank" rel="external">Redis 设计与实现</a></li>
<li><a href="http://redis.io/topics/data-types-intro" target="_blank" rel="external">An introduction to Redis data types and abstractions</a></li>
</ul>
<p><a href="http://andrewliu.tk/2015/06/27/Redis%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/" target="_blank" rel="external">原文地址</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="redis-introduction"><a class="header-anchor" href="#redis-introduction"></a>Redis Introduction</h2>
<p>Redis是一个用C语言实现的key-value store. 除了最基础的基于字符串的键值对，Redis可以是更加复杂的数据结构，所以redis也常被称为是一个data structure server(数据结构服务器)</p>]]>
    
    </summary>
    
      <category term="Redis" scheme="http://molloc.me/tags/Redis/"/>
    
      <category term="学习笔记" scheme="http://molloc.me/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[mysql按照某一字段去重，并显示其他字段信息]]></title>
    <link href="http://molloc.me/2015/06/26/mysql%E6%8C%89%E7%85%A7%E6%9F%90%E4%B8%80%E5%AD%97%E6%AE%B5%E5%8E%BB%E9%87%8D%EF%BC%8C%E5%B9%B6%E6%98%BE%E7%A4%BA%E5%85%B6%E4%BB%96%E5%AD%97%E6%AE%B5%E4%BF%A1%E6%81%AF/"/>
    <id>http://molloc.me/2015/06/26/mysql按照某一字段去重，并显示其他字段信息/</id>
    <published>2015-06-26T03:04:38.000Z</published>
    <updated>2015-06-28T07:42:35.000Z</updated>
    <content type="html"><![CDATA[<h2 id="问题概述"><a class="header-anchor" href="#问题概述"></a>问题概述</h2>
<p>按照sql中的某一列值去重，还要显示其他字段的信息。</p>
<a id="more"></a>
<h2 id="解决思路"><a class="header-anchor" href="#解决思路"></a>解决思路</h2>
<p>使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> <span class="keyword">distinct</span> name, sorce <span class="keyword">from</span> <span class="keyword">table</span></span></span><br></pre></td></tr></table></figure>
<p>结果发现去重不起作用，因为MYSQL认为要sorce和name同时重复才会去除。</p>
<p>Google一番，反复试验最终解决办法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">group</span> <span class="keyword">by</span> name</span></span><br></pre></td></tr></table></figure>
<p>这样就会去重，默认会取出来每个分组的第一行数据。</p>
<p>如果SQL语句还有limit,order by等条件，必须放在group by后面。这样就达到了既去重，又能够输出更多字段信息的目的.</p>
<p>记录之，以备忘，给大家提供帮助。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="问题概述"><a class="header-anchor" href="#问题概述"></a>问题概述</h2>
<p>按照sql中的某一列值去重，还要显示其他字段的信息。</p>]]>
    
    </summary>
    
      <category term="mysql" scheme="http://molloc.me/tags/mysql/"/>
    
      <category term="学习笔记" scheme="http://molloc.me/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CentOS 6 搭建 FTP 服务记录]]></title>
    <link href="http://molloc.me/2015/06/25/CentOS-6-%E6%90%AD%E5%BB%BA-FTP-%E6%9C%8D%E5%8A%A1%E8%AE%B0%E5%BD%95/"/>
    <id>http://molloc.me/2015/06/25/CentOS-6-搭建-FTP-服务记录/</id>
    <published>2015-06-25T01:09:32.000Z</published>
    <updated>2015-06-28T07:42:34.000Z</updated>
    <content type="html"><![CDATA[<h2 id="关于-vsftp"><a class="header-anchor" href="#关于-vsftp"></a>关于 VSFTP</h2>
<p>在 Linux 下搭建 FTP 服务器一般会使用 vsftpd。vsftpd 的前两个字母代表 &quot;very secure&quot; 。</p>
<p><a href="https://security.appspot.com/vsftpd.html" target="_blank" rel="external">项目官网</a></p>
<h2 id="安装-vsftp"><a class="header-anchor" href="#安装-vsftp"></a>安装 VSFTP</h2>
<p>使用 yum 安装 vsftpd：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install vsftpd</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>如果需要连接其他 FTP 服务器，则可以安装 FTP 客户端。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install ftp</span><br></pre></td></tr></table></figure>
<h2 id="添加用户"><a class="header-anchor" href="#添加用户"></a>添加用户</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adduser userftp</span><br><span class="line">passwd userftp</span><br></pre></td></tr></table></figure>
<p>禁止用户的 ssh 登录权限，只允许 FTP 访问:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod <span class="operator">-s</span> /sbin/nologin userftp</span><br></pre></td></tr></table></figure>
<h2 id="配置-vsftp"><a class="header-anchor" href="#配置-vsftp"></a>配置 VSFTP</h2>
<p>打开配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/vsftpd/vsftpd.conf</span><br></pre></td></tr></table></figure>
<p>关闭匿名访问：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anonymous_<span class="built_in">enable</span>=NO</span><br></pre></td></tr></table></figure>
<p>去掉 local_enable 的注释，修改为开启：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">local</span>_<span class="built_in">enable</span>=YES</span><br></pre></td></tr></table></figure>
<p>限制用户仅能访问自己的主目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chroot_<span class="built_in">local</span>_user=YES</span><br></pre></td></tr></table></figure>
<p>设置用户的主目录：(不设置时，默认为用户的家目录/home/userftp)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">local</span>_root=/data/<span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>重启服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service vsftpd restart</span><br></pre></td></tr></table></figure>
<p>设置开机自启动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig vsftpd on</span><br></pre></td></tr></table></figure>
<h2 id="连接测试"><a class="header-anchor" href="#连接测试"></a>连接测试</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ftp userftp@<span class="number">112.126</span>.<span class="number">74.124</span></span><br><span class="line"></span><br><span class="line">ftp&gt; <span class="built_in">pwd</span></span><br><span class="line">Remote directory: /home/userftp</span><br><span class="line"></span><br><span class="line">ftp&gt; quit</span><br><span class="line"><span class="number">221</span> Goodbye.</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a class="header-anchor" href="#参考"></a>参考</h2>
<ol>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-vsftpd-on-centos-6--2" target="_blank" rel="external">how-to-set-up-vsftpd-on-centos-6--2</a></li>
<li><a href="http://koulitsu.blog.51cto.com/7355117/1221441" target="_blank" rel="external">koulitsu</a></li>
</ol>
<p><a href="http://segmentfault.com/a/1190000002926477" target="_blank" rel="external">原文地址</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="关于-vsftp"><a class="header-anchor" href="#关于-vsftp"></a>关于 VSFTP</h2>
<p>在 Linux 下搭建 FTP 服务器一般会使用 vsftpd。vsftpd 的前两个字母代表 &quot;very secure&quot; 。</p>
<p><a href="https://security.appspot.com/vsftpd.html">项目官网</a></p>
<h2 id="安装-vsftp"><a class="header-anchor" href="#安装-vsftp"></a>安装 VSFTP</h2>
<p>使用 yum 安装 vsftpd：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install vsftpd</span><br></pre></td></tr></table></figure>]]>
    
    </summary>
    
      <category term="linux" scheme="http://molloc.me/tags/linux/"/>
    
      <category term="探索发现" scheme="http://molloc.me/categories/%E6%8E%A2%E7%B4%A2%E5%8F%91%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[PMP-ITTO]]></title>
    <link href="http://molloc.me/2015/06/24/PMP-ITTO/"/>
    <id>http://molloc.me/2015/06/24/PMP-ITTO/</id>
    <published>2015-06-24T01:34:27.000Z</published>
    <updated>2015-06-28T07:42:34.000Z</updated>
    <content type="html"><![CDATA[<h2 id="项目整合管理"><a class="header-anchor" href="#项目整合管理"></a>项目整合管理</h2>
<h3 id="制定项目章程"><a class="header-anchor" href="#制定项目章程"></a>制定项目章程</h3>
<ul>
<li>输入
<ol>
<li>项目工作说明书</li>
<li>商业论证</li>
<li>协议</li>
<li>组织过程资产</li>
<li>事业环境因素</li>
</ol>
</li>
</ul>
<a id="more"></a>
<ul>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>引导技术</li>
</ol>
</li>
<li>输出
<ol>
<li>项目章程</li>
</ol>
</li>
</ul>
<h3 id="制定项目管理计划"><a class="header-anchor" href="#制定项目管理计划"></a>制定项目管理计划</h3>
<ul>
<li>输入
<ol>
<li>项目章程</li>
<li>其他过程的输出</li>
<li>组织过程资产</li>
<li>事业环境因素</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>引导技术</li>
</ol>
</li>
<li>输出
<ol>
<li>项目管理计划</li>
</ol>
</li>
</ul>
<h3 id="指定与管理项目工作"><a class="header-anchor" href="#指定与管理项目工作"></a>指定与管理项目工作</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>批准的变更请求</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>项目管理信息系统</li>
</ol>
</li>
<li>输出
<ol>
<li>可交付成果</li>
<li>变更请求</li>
<li>工作绩效数据</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="监控项目工作"><a class="header-anchor" href="#监控项目工作"></a>监控项目工作</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>进度预测(<em>控制进度的输出</em>)</li>
<li>成本预测(<em>控制成本的输出</em>)</li>
<li>确认的变更(<em>控制质量的输出</em>)</li>
<li>工作绩效信息</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>会议</li>
<li>分析技术</li>
<li>项目管理信息系统</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效报告</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="实施整体变更控制"><a class="header-anchor" href="#实施整体变更控制"></a>实施整体变更控制</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>工作绩效报告</li>
<li>变更请求</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>会议</li>
<li>变更控制工具</li>
</ol>
</li>
<li>输出
<ol>
<li>批准的变更请求</li>
<li>变更日志</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="结束项目或阶段"><a class="header-anchor" href="#结束项目或阶段"></a>结束项目或阶段</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>验收的可交付成果(<em>确认范围的输出</em>)</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>分析技术</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>最终的产品,服务或成果的移交</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目范围管理"><a class="header-anchor" href="#项目范围管理"></a>项目范围管理</h2>
<h3 id="规划范围管理"><a class="header-anchor" href="#规划范围管理"></a>规划范围管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目章程</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>范围管理计划</li>
<li>需求管理计划</li>
</ol>
</li>
</ul>
<h3 id="收集需求"><a class="header-anchor" href="#收集需求"></a>收集需求</h3>
<ul>
<li>输入
<ol>
<li>范围管理计划</li>
<li>需求管理计划</li>
<li>干系人管理计划</li>
<li>项目章程</li>
<li>干系人登记册</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>访谈</li>
<li>焦点小组</li>
<li>引导式研讨会</li>
<li>群体创新技术</li>
<li>群体决策技术</li>
<li>问卷调查</li>
<li>观察</li>
<li>原型法</li>
<li>标杆对象</li>
<li>系统交互图</li>
<li>文件分析</li>
</ol>
</li>
<li>输出
<ol>
<li>需求文件</li>
<li>需求跟踪矩阵</li>
</ol>
</li>
</ul>
<h3 id="定义范围"><a class="header-anchor" href="#定义范围"></a>定义范围</h3>
<ul>
<li>输入
<ol>
<li>范围管理计划</li>
<li>需求文件</li>
<li>项目章程</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>产品分析</li>
<li>备选方案生成</li>
<li>引导式研讨会</li>
</ol>
</li>
<li>输出
<ol>
<li>项目范围说明书</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="创建wbs"><a class="header-anchor" href="#创建wbs"></a>创建WBS</h3>
<ul>
<li>输入
<ol>
<li>范围管理计划</li>
<li>需求文件</li>
<li>项目范围说明书</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>分解</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>范围基准</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="确认范围"><a class="header-anchor" href="#确认范围"></a>确认范围</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>需求文件</li>
<li>需求跟踪矩阵</li>
<li>核实的可交付成果(<em>控制质量的输出</em>)</li>
<li>工作绩效数据</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>检查</li>
<li>群体决策技术</li>
</ol>
</li>
<li>输出
<ol>
<li>验收的可交付成果</li>
<li>变更请求</li>
<li>工作绩效信息</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="控制范围"><a class="header-anchor" href="#控制范围"></a>控制范围</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>工作绩效数据</li>
<li>需求文件</li>
<li>需求跟踪矩阵</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>偏差分析</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目时间管理"><a class="header-anchor" href="#项目时间管理"></a>项目时间管理</h2>
<h3 id="规划进度管理"><a class="header-anchor" href="#规划进度管理"></a>规划进度管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目章程</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>分析技术</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>进度管理计划</li>
</ol>
</li>
</ul>
<h3 id="定义活动"><a class="header-anchor" href="#定义活动"></a>定义活动</h3>
<ul>
<li>输入
<ol>
<li>进度管理计划</li>
<li>范围基准</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>分解</li>
<li>滚动式规划</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>活动清单</li>
<li>活动属性</li>
<li>里程碑清单</li>
</ol>
</li>
</ul>
<h3 id="排列活动顺序"><a class="header-anchor" href="#排列活动顺序"></a>排列活动顺序</h3>
<ul>
<li>输入
<ol>
<li>进度管理计划</li>
<li>活动清单</li>
<li>活动属性</li>
<li>里程碑清单</li>
<li>项目范围说明书</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>紧前关系绘图法(<em>PDM</em>)</li>
<li>确定的依赖关系</li>
<li>提前量与滞后量</li>
</ol>
</li>
<li>输出
<ol>
<li>项目进度网络图</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="估算活动资源"><a class="header-anchor" href="#估算活动资源"></a>估算活动资源</h3>
<ul>
<li>输入
<ol>
<li>进度管理计划</li>
<li>活动清单</li>
<li>活动属性</li>
<li>资源日历</li>
<li>风险登记册</li>
<li>活动成本估算(<em>估算成本的输出</em>)</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>备选方案分析</li>
<li>自上而下估算</li>
<li>发布的估算数据</li>
<li>储备分析</li>
</ol>
</li>
<li>输出
<ol>
<li>活动资源需求</li>
<li>资源分解结果(<em>RBS</em>)</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="估算活动持续时间"><a class="header-anchor" href="#估算活动持续时间"></a>估算活动持续时间</h3>
<ul>
<li>输入
<ol>
<li>进度管理计划</li>
<li>活动清单</li>
<li>活动属性</li>
<li>活动资源需求</li>
<li>资源日历</li>
<li>项目范围说明书</li>
<li>风险登记册</li>
<li>资源分解结构</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>类比估算</li>
<li>参数估算</li>
<li>三点估算</li>
<li>群体决策技术</li>
<li>储备分析</li>
</ol>
</li>
<li>输出
<ol>
<li>活动持续时间估算</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="制定进度计划"><a class="header-anchor" href="#制定进度计划"></a>制定进度计划</h3>
<ul>
<li>输入
<ol>
<li>进度管理计划</li>
<li>活动清单</li>
<li>活动属性</li>
<li>项目进度网络图</li>
<li>活动资源需求</li>
<li>资源日历</li>
<li>活动持续时间估算</li>
<li>项目范围说明书</li>
<li>风险登记册</li>
<li>项目人员分派(<em>组建项目团队输出</em>)</li>
<li>资源分解结构</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>进度网络分析</li>
<li>关键路径法</li>
<li>关键链法</li>
<li>资源优化技术(<em>资源平衡,资源平衡</em>)</li>
<li>建模技术(<em>假设情景分析,模拟(通常使用三点估算)</em>)</li>
<li>提前量与滞后量</li>
<li>进度压缩(<em>快速跟进,赶工</em>)</li>
<li>进度计划编制工具</li>
</ol>
</li>
<li>输出
<ol>
<li>进度基准</li>
<li>项目进度计划</li>
<li>进度数据</li>
<li>项目日历</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="控制进度"><a class="header-anchor" href="#控制进度"></a>控制进度</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目进度计划</li>
<li>工作绩效数据</li>
<li>进度数据</li>
<li>项目日历</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li><strong>绩效审查</strong></li>
<li>项目管理软件</li>
<li>资源优化技术</li>
<li>建模技术</li>
<li>提前量与滞后量</li>
<li>进度压缩</li>
<li>进度计划编制工具</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>进度预测</li>
</ol>
</li>
</ul>
<h2 id="项目成本管理"><a class="header-anchor" href="#项目成本管理"></a>项目成本管理</h2>
<h3 id="规划成本管理"><a class="header-anchor" href="#规划成本管理"></a>规划成本管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目章程</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>分析技术</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>成本管理计划</li>
</ol>
</li>
</ul>
<h3 id="估算成本"><a class="header-anchor" href="#估算成本"></a>估算成本</h3>
<ul>
<li>输入
<ol>
<li>成本管理计划</li>
<li>人力资源管理计划(<em>项目人员配备情况、人工费率和相关奖励/认可方案</em>)</li>
<li>范围基准</li>
<li>项目进度计划</li>
<li>风险登记册</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>类比估算</li>
<li>三点估算</li>
<li>参数估算</li>
<li>自下而上估算</li>
<li>储备分析</li>
<li>质量成本</li>
<li>项目管理软件</li>
<li>卖方投标分析</li>
<li>群体决策技术</li>
</ol>
</li>
<li>输出
<ol>
<li>活动成本估算</li>
<li>估算依据</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="制定预算"><a class="header-anchor" href="#制定预算"></a>制定预算</h3>
<ul>
<li>输入
<ol>
<li>成本管理计划</li>
<li>范围基准</li>
<li>活动成本估算</li>
<li>估算依据</li>
<li>项目进度计划</li>
<li>资源日历</li>
<li>风险登记册</li>
<li>协议</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>成本汇总</li>
<li>储备分析</li>
<li>专家判断</li>
<li>历史数据</li>
<li>资源限制平衡</li>
</ol>
</li>
<li>输出
<ol>
<li>成本基准</li>
<li>项目资金需求</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="控制成本"><a class="header-anchor" href="#控制成本"></a>控制成本</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目资金需求</li>
<li>工作绩效数据</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>挣值管理</li>
<li>预测</li>
<li>完工尚需绩效指数</li>
<li><strong>绩效审查</strong></li>
<li>项目管理软件</li>
<li>储备分析</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>成本预测</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目质量管理"><a class="header-anchor" href="#项目质量管理"></a>项目质量管理</h2>
<h3 id="规划质量管理"><a class="header-anchor" href="#规划质量管理"></a>规划质量管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>干系人登记册(<em>有助于识别对质量有特别兴趣或影响的那些干系人</em>)</li>
<li>风险登记册(<em>包含可能影响质量要求的各种威胁和机会的信息</em>)</li>
<li>需求文件(<em>包括(但不限于)项目(包括产品)需求和质量需求</em>)</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>成本效益分析</li>
<li>质量成本</li>
<li>七种基本质量工具</li>
<li>实验设计(<em>系统地改变所有重要因素,然后对实验数据分析</em>)</li>
<li>标杆对照</li>
<li>统计抽样</li>
<li>其他质量管理工具(<em>头脑风暴,力场分析(显示变更推力和阻力的图形),名义小组技术,质量管理和控制工具</em>)</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>质量管理计划</li>
<li>质量核对单</li>
<li>质量测量指标</li>
<li>过程改进计划</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="实施质量保证"><a class="header-anchor" href="#实施质量保证"></a>实施质量保证</h3>
<ul>
<li>输入
<ol>
<li>质量管理计划</li>
<li>过程改进计划</li>
<li>质量控制测量结果</li>
<li>质量测量指标</li>
<li>项目文件</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>质量管理与控制工具(<em>亲和图,过程决策程序图,关联图,树形图,优先矩阵,活动网络图,矩阵图</em>)</li>
<li>质量审计(<em>用来确定项目活动是否遵循了组织和项目的政策,过程和程序的过程</em>)</li>
<li>过程分析(<em>根本原因分析</em>)</li>
</ol>
</li>
<li>输出
<ol>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h3 id="控制质量"><a class="header-anchor" href="#控制质量"></a>控制质量</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>工作绩效信息</li>
<li>质量测量指标</li>
<li>质量核对单</li>
<li>可交付成功</li>
<li>批准的变更请求</li>
<li>项目文件</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>统计抽样</li>
<li>七种基本质量工具</li>
<li>检查</li>
<li>审查以批准的变更请求</li>
</ol>
</li>
<li>输出
<ol>
<li>质量控制测量结果</li>
<li>工作绩效信息</li>
<li>确认的变更</li>
<li>核实的可交付成果</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目人力资源管理"><a class="header-anchor" href="#项目人力资源管理"></a>项目人力资源管理</h2>
<h3 id="规划人力资源管理"><a class="header-anchor" href="#规划人力资源管理"></a>规划人力资源管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>活动资源需求</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>组织图与职位描述(<em>层级型,矩阵型,文本型</em>)</li>
<li>人际交往</li>
<li>组织理论(<em>阐述个人、团队和组织部门的行为方式</em>)</li>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>人力资源管理计划(<em>角色与职责,项目组织图,人员配备管理计划</em>)</li>
</ol>
</li>
</ul>
<h3 id="组建项目团队"><a class="header-anchor" href="#组建项目团队"></a>组建项目团队</h3>
<ul>
<li>输入
<ol>
<li>人力资源管理计划</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>预分派</li>
<li>谈判(<em>大部分情况下与职能经理谈判</em>)</li>
<li>招募</li>
<li>虚拟办公</li>
<li>多标准决策分析(<em>对团队成员进行打分(可用性,成本,经验,能力,知识,技能,态度,国际因素)</em>)</li>
</ol>
</li>
<li>输出
<ol>
<li>项目人员分派(<em>列出了谁是项目团队成员</em>)</li>
<li>资源日历</li>
<li>项目管理计划更新</li>
</ol>
</li>
</ul>
<h3 id="建设项目团队"><a class="header-anchor" href="#建设项目团队"></a>建设项目团队</h3>
<ul>
<li>输入
<ol>
<li>人力资源管理计划</li>
<li>项目人员分派</li>
<li>资源日历</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>人家关系技能</li>
<li>培训</li>
<li>团队建设活动</li>
<li>基本规则</li>
<li>集中办公</li>
<li>认可与奖励</li>
<li>人事测评工具(<em>能让项目经理和项目团队洞察成员的优势和劣势.</em>)</li>
</ol>
</li>
<li>输出
<ol>
<li>团队绩效评价(<em>指标: 个人能力的改进,团队能力的改进,团队成员离职率降低,凝聚力加强.</em>)</li>
<li>事业环境因素</li>
</ol>
</li>
</ul>
<h3 id="管理项目团队"><a class="header-anchor" href="#管理项目团队"></a>管理项目团队</h3>
<ul>
<li>输入
<ol>
<li>人力资源管理计划</li>
<li>项目人员分派</li>
<li>团队绩效评价</li>
<li>问题日志</li>
<li>工作绩效报告</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li><strong>观察和交谈</strong>(<em>可通过观察和交谈，随时了解项目团队成员的工作和态度。</em>)</li>
<li>项目绩效评估(<em>目的包括澄清角色与职责,向团队成员提供建设性反馈,发现未知或未决问题,制定个人培训计划,以及确立未来目标.</em>)</li>
<li>冲突管理(<em>撤退/回避,缓和/包容,妥协/调解,强迫/命令,合作/解决问题</em>)</li>
<li>人际关系技能(<em>领导力,影响力,有效决策</em>)</li>
</ol>
</li>
<li>输出
<ol>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>事业环境因素更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目沟通管理"><a class="header-anchor" href="#项目沟通管理"></a>项目沟通管理</h2>
<h3 id="规划沟通管理"><a class="header-anchor" href="#规划沟通管理"></a>规划沟通管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>干系人登记册</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>沟通需求分析(<em>确定干系人的信息需求</em>)</li>
<li>会议</li>
<li>沟通技术</li>
<li>沟通模型</li>
<li>沟通方法</li>
</ol>
</li>
<li>输出
<ol>
<li>沟通管理计划</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="管理沟通"><a class="header-anchor" href="#管理沟通"></a>管理沟通</h3>
<ul>
<li>输入
<ol>
<li>沟通管理计划</li>
<li>工作绩效报告</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>沟通技术(<em>信息需求的紧迫性,技术的可用性,易用性,项目环境,信息的敏感性和保密性</em>)</li>
<li>沟通方法(<em>交互式沟通,推式沟通,拉式沟通</em>)</li>
<li>沟通模型(<em>编码,传递信息,解码,告知收悉,反馈/反应</em>)</li>
<li>信息管理系统</li>
<li>报告绩效</li>
</ol>
</li>
<li>输出
<ol>
<li>项目沟通</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h3 id="控制沟通"><a class="header-anchor" href="#控制沟通"></a>控制沟通</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目沟通</li>
<li>工作绩效信息</li>
<li>组织过程资产</li>
<li>问题日志</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>信息管理系统</li>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目风险管理"><a class="header-anchor" href="#项目风险管理"></a>项目风险管理</h2>
<h3 id="规划风险管理"><a class="header-anchor" href="#规划风险管理"></a>规划风险管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>项目章程</li>
<li>干系人登记册</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>分析技术</li>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>风险管理计划</li>
</ol>
</li>
</ul>
<h3 id="识别风险"><a class="header-anchor" href="#识别风险"></a>识别风险</h3>
<ul>
<li>输入
<ol>
<li>风险管理计划</li>
<li>成本管理计划</li>
<li>进度管理计划</li>
<li>质量管理计划</li>
<li>人力资源管理计划</li>
<li>范围基准(<em>WBS是识别风险的关键输入,可以在总体,控制账户,工作包级别上识别风险</em>)</li>
<li>活动成本估算</li>
<li>活动持续时间估算</li>
<li>干系人登记册</li>
<li>项目文件</li>
<li>采购文件</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>文档审查</li>
<li>信息收集技术(<em>头脑风暴,德尔菲技术,访谈,根本原因分析</em>)</li>
<li>图解技术(<em>因果图,系统或过程流程图,影响图</em>)</li>
<li>假设分析(<em>检验假设条件在项目中的有效性</em>)</li>
<li>核对单分析</li>
<li>SWOT分析</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>风险登记册(<em>最初的登记册应该报告:已识别的风险清单,潜在应对措施清单</em>)</li>
</ol>
</li>
</ul>
<h3 id="实施定性风险分析"><a class="header-anchor" href="#实施定性风险分析"></a>实施定性风险分析</h3>
<ul>
<li>输入
<ol>
<li>风险管理计划</li>
<li>风险登记册</li>
<li>范围基准</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>风险概率和影响评估</li>
<li>概率和影响矩阵</li>
<li>风险数据质量评估</li>
<li>风险分类</li>
<li>风险紧迫性评估</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="实施定量风险分析"><a class="header-anchor" href="#实施定量风险分析"></a>实施定量风险分析</h3>
<ul>
<li>输入
<ol>
<li>风险管理计划</li>
<li>进度管理计划</li>
<li>成本管理计划</li>
<li>风险登记册</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>数据收集与展示技术(<em>访谈,概率分布,敏感性分析,预期货币价值分析,建模和模拟(通常采用蒙特卡洛技术)</em>)</li>
<li>定量风险分析与建模技术</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="规划风险应对"><a class="header-anchor" href="#规划风险应对"></a>规划风险应对</h3>
<ul>
<li>输入
<ol>
<li>风险管理计划</li>
<li>风险登记册</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>消极风险与威胁的应对措施</li>
<li>积极风险与机会的应对措施</li>
<li>应急应对策略</li>
<li>专家判断</li>
</ol>
</li>
<li>输出
<ol>
<li>项目文件更新</li>
<li>项目管理计划更新</li>
</ol>
</li>
</ul>
<h3 id="控制风险"><a class="header-anchor" href="#控制风险"></a>控制风险</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>工作绩效信息</li>
<li>工作绩效报告</li>
<li>风险登记册</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>风险再评估</li>
<li>技术绩效策略</li>
<li>风险审计(<em>检查并记录风险应对措施在处理已识别风险及其根源方面的有效性,以及风险管理过程的有效性.</em>)</li>
<li>偏差与趋势分析</li>
<li>储备分析</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="项目采购管理"><a class="header-anchor" href="#项目采购管理"></a>项目采购管理</h2>
<h3 id="规划采购管理"><a class="header-anchor" href="#规划采购管理"></a>规划采购管理</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>需求文件</li>
<li>风险登记册</li>
<li>活动资源需求</li>
<li>项目进度计划</li>
<li>活动成本估算</li>
<li>干系人登记册</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>自制与外购分析</li>
<li>专家判断</li>
<li>市场调研</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>采购管理计划</li>
<li>采购工作说明书(<em>可包括规格、数量、质量、性能参数、履约期限、工作地点和其他需求。</em>)</li>
<li>采购文件(<em>是用于征求潜在卖方的建议书</em>)</li>
<li>供方选择标准</li>
<li>自制与外购决策</li>
<li>变更请求</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="实施采购"><a class="header-anchor" href="#实施采购"></a>实施采购</h3>
<ul>
<li>输入
<ol>
<li>采购管理计划</li>
<li>采购工作说明书</li>
<li>采购文件</li>
<li>供方选择标准</li>
<li>自制与外购决策</li>
<li>卖方建议书</li>
<li>项目文件</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>投标人会议</li>
<li>建议书评价技术</li>
<li>专家判断</li>
<li>独立估算</li>
<li>广告</li>
<li>分析技术</li>
<li>采购谈判</li>
</ol>
</li>
<li>输出
<ol>
<li>选定的卖方</li>
<li>协议</li>
<li>资源日历</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="控制采购"><a class="header-anchor" href="#控制采购"></a>控制采购</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>采购文件</li>
<li>协议</li>
<li>批准的变更请求</li>
<li>工作绩效数据</li>
<li>工作绩效报告</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>合同变更控制系统</li>
<li>支付系统</li>
<li>索赔管理</li>
<li>记录管理系统</li>
<li>报告绩效</li>
<li>采购绩效审查</li>
<li>检查与审计</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h3 id="结束采购"><a class="header-anchor" href="#结束采购"></a>结束采购</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>采购文件</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>采购审计</li>
<li>采购谈判</li>
<li>记录管理系统</li>
</ol>
</li>
<li>输出
<ol>
<li>结束的采购</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
<h2 id="干系人管理"><a class="header-anchor" href="#干系人管理"></a>干系人管理</h2>
<h3 id="识别干系人"><a class="header-anchor" href="#识别干系人"></a>识别干系人</h3>
<ul>
<li>输入
<ol>
<li>采购文件</li>
<li>项目章程</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>干系人分析(<em>识别出干系人的期望,利益和影响</em>)</li>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>干系人登记册</li>
</ol>
</li>
</ul>
<h3 id="规划干系人管理"><a class="header-anchor" href="#规划干系人管理"></a>规划干系人管理</h3>
<ul>
<li>输入
<ol>
<li>干系人登记册</li>
<li>项目管理计划</li>
<li>事业环境因素</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>专家判断</li>
<li>会议</li>
<li>分析技术(<em>干系人的参与程度: 不知晓,抵制,中立,支持,领导</em>)</li>
</ol>
</li>
<li>输出
<ol>
<li>干系人管理计划</li>
<li>项目文件更新</li>
</ol>
</li>
</ul>
<h3 id="管理干系人参与"><a class="header-anchor" href="#管理干系人参与"></a>管理干系人参与</h3>
<ul>
<li>输入
<ol>
<li>干系人管理计划</li>
<li>沟通管理计划</li>
<li>变更日志</li>
<li>组织过程资产</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>沟通方法</li>
<li>人际关系技能</li>
<li>管理技能</li>
</ol>
</li>
<li>输出
<ol>
<li>问题日志</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产</li>
</ol>
</li>
</ul>
<h3 id="控制干系人参与"><a class="header-anchor" href="#控制干系人参与"></a>控制干系人参与</h3>
<ul>
<li>输入
<ol>
<li>项目管理计划</li>
<li>问题日志</li>
<li>工作绩效数据</li>
<li>项目文件</li>
</ol>
</li>
<li>工具与技术
<ol>
<li>信息管理系统</li>
<li>专家判断</li>
<li>会议</li>
</ol>
</li>
<li>输出
<ol>
<li>工作绩效信息</li>
<li>变更请求</li>
<li>项目管理计划更新</li>
<li>项目文件更新</li>
<li>组织过程资产更新</li>
</ol>
</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="项目整合管理"><a class="header-anchor" href="#项目整合管理"></a>项目整合管理</h2>
<h3 id="制定项目章程"><a class="header-anchor" href="#制定项目章程"></a>制定项目章程</h3>
<ul>
<li>输入
<ol>
<li>项目工作说明书</li>
<li>商业论证</li>
<li>协议</li>
<li>组织过程资产</li>
<li>事业环境因素</li>
</ol>
</li>
</ul>]]>
    
    </summary>
    
      <category term="pmp" scheme="http://molloc.me/tags/pmp/"/>
    
      <category term="工作相关" scheme="http://molloc.me/categories/%E5%B7%A5%E4%BD%9C%E7%9B%B8%E5%85%B3/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Guava 是个风火轮之函(3)-表处理]]></title>
    <link href="http://molloc.me/2015/06/18/Guava-%E6%98%AF%E4%B8%AA%E9%A3%8E%E7%81%AB%E8%BD%AE%E4%B9%8B%E5%87%BD-3-%E8%A1%A8%E5%A4%84%E7%90%86/"/>
    <id>http://molloc.me/2015/06/18/Guava-是个风火轮之函-3-表处理/</id>
    <published>2015-06-18T06:56:46.000Z</published>
    <updated>2015-06-28T07:42:34.000Z</updated>
    <content type="html"><![CDATA[<p>早先学习 Scheme 的时候，就已经对 Lisp 那行云流水般的表处理手段一见倾心。后来使用 Python 做数据处理时，语言内置的高阶函数更是得心应手。工作之后开始使用 Java，一开始的时候仿佛回到了石器时代。</p>
<p>直到后来我找到了 Guava，才终于又可以使用熟悉的方式去操纵集合。</p>
<a id="more"></a>
<p>函数式风格的表处理让开发者从底层的迭代处理中解放出来，从更加抽象的层面来思考问题。然而，Guava 仅仅实现了 map、filter 者两个高阶函数，并没有实现 reduce。</p>
<h2 id="映射"><a class="header-anchor" href="#映射"></a>映射</h2>
<p>表处理中有这样一个操作，将某个函数分别应用到集合的每个元素上，将返回值集合以列表返回，这个操作一般命名为 map，实现为一个高阶函数。</p>
<p>在 Guava 中，提供同样操作的方法是一个静态函数，Collections2#transform。按照 map 函数的约定俗成，第一个参数是被操作集合，第二个参数是操作函数，返回值是结果集合。也许是出于避免函数名和变量名冲突的考虑，Guava 没有像其他语言那样使用 map 作为函数名，而是使用了 transform。（想想我们写的生产代码里面有多少个哈希表以 map 命名，回去面壁……）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;Integer, Integer&gt; square = <span class="keyword">new</span> Function&lt;Integer, Integer&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">apply</span><span class="params">(Integer input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> input * input;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Collections2.transform(Lists.newArrayList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), square);<span class="comment">//[1, 4, 9]</span></span><br></pre></td></tr></table></figure>
<h2 id="过滤"><a class="header-anchor" href="#过滤"></a>过滤</h2>
<p>高阶函数 filter 的作用和它的名字一样，就是个过滤器，将一个布尔型函数应用到集合的每个元素上，然后根据函数的返回值决定元素是否留在返回值集合中。</p>
<p>在 Guava 中，Collections2#filter 提供了 filter 的功能。这一次 Guava 使用了约定俗成的名字。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;Integer&gt; isOdd = <span class="keyword">new</span> Predicate&lt;Integer&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">apply</span><span class="params">(Integer input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (input &amp; <span class="number">1</span>) != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Collections2.filter(Lists.newArrayList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), isOdd);<span class="comment">//[1, 3]</span></span><br></pre></td></tr></table></figure>
<h2 id="折叠"><a class="header-anchor" href="#折叠"></a>折叠</h2>
<p>折叠这个操作是把一个列表归并成一个元素，在一些语言中这个操作被称作 fold，另一些称之为 reduce。</p>
<p>在 Python 中，我们假如我们想要实现列表元素的累加，可以写成下面这个样子：</p>
<p>reduce(lambda x, y: x + y, [1,2,3])
在 Clojure 中，我们可以写的更加简单：</p>
<p>(reduce + [1 2 3])
可惜的是，Guava 并没有实现折叠操作。早在 2009 年的时候就有人在 Guava 的 issue[1] 中提出，为 可迭代的集合增加一个 fold 方法，issue 讨论中大家也是贴出了各自的实现。然而，最后在 15 年 4 月 11 日这个 issue 被关闭了，Guava 的维护者决定不再向 Guava 添加函数式编程的特性，因为 Java 8 出来了。</p>
<p>虽然 Guava 的很多特性都在 Java 8 中得到了实现，但是并不是所有的开发者都能用上 Java 8。对于我们这些不得不使用 Java 7 甚至 Java 6 的开发者来说，Guava 就是帮助我们提升开发效率的神器。</p>
<h2 id="源码分析-collections2-transform"><a class="header-anchor" href="#源码分析-collections2-transform"></a>源码分析 Collections2.transform</h2>
<p>使用代理模式来实现延迟求值是 Guava 的惯用技法，transform 函数也不例外。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;F, T&gt; <span class="function">Collection&lt;T&gt; <span class="title">transform</span><span class="params">(Collection&lt;F&gt; fromCollection,</span><br><span class="line">    Function&lt;? <span class="keyword">super</span> F, T&gt; function)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> TransformedCollection&lt;F, T&gt;(fromCollection, function);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TransformedCollection 就是代理类，把传入的被操作集合和操作函数代理了起来，直到必要的时候才调用操作函数获取结果元素。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TransformedCollection</span>&lt;<span class="title">F</span>, <span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractCollection</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> Collection&lt;F&gt; fromCollection;</span><br><span class="line">  <span class="keyword">final</span> Function&lt;? <span class="keyword">super</span> F, ? extends T&gt; function;</span><br><span class="line">  TransformedCollection(Collection&lt;F&gt; fromCollection,</span><br><span class="line">      Function&lt;? <span class="keyword">super</span> F, ? extends T&gt; function) &#123;</span><br><span class="line">    <span class="keyword">this</span>.fromCollection = checkNotNull(fromCollection);</span><br><span class="line">    <span class="keyword">this</span>.function = checkNotNull(function);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fromCollection.clear();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fromCollection.isEmpty();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span> <span class="function"><span class="keyword">public</span> Iterator&lt;T&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Iterators.transform(fromCollection.iterator(), function);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fromCollection.size();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为 Collection 的元素只能通过迭代器去遍历访问，所有我们只需要跟着 iterator 方法走下去，就能搞清楚 transform 的实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;F, T&gt; <span class="function">Iterator&lt;T&gt; <span class="title">transform</span><span class="params">(<span class="keyword">final</span> Iterator&lt;F&gt; fromIterator,</span><br><span class="line">    <span class="keyword">final</span> Function&lt;? <span class="keyword">super</span> F, ? extends T&gt; function)</span> </span>&#123;</span><br><span class="line">  checkNotNull(function);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> TransformedIterator&lt;F, T&gt;(fromIterator) &#123;</span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function">T <span class="title">transform</span><span class="params">(F from)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> function.apply(from);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Iterators.transform 函数返回了一个闭包，继承自抽象类 TransformedIterator。闭包中定义了操作函数的调用时机，那么我们接下来要找的就是 TransformedIterator#transform 的调用者了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TransformedIterator</span>&lt;<span class="title">F</span>, <span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> Iterator&lt;? extends F&gt; backingIterator;</span><br><span class="line">  TransformedIterator(Iterator&lt;? extends F&gt; backingIterator) &#123;</span><br><span class="line">    <span class="keyword">this</span>.backingIterator = checkNotNull(backingIterator);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">abstract</span> T <span class="title">transform</span><span class="params">(F from)</span></span>;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> backingIterator.hasNext();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> T <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> transform(backingIterator.next());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="annotation">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    backingIterator.remove();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TransformedIterator 这个抽象迭代器在 next 方法中完成了对 transform 的调用。也就是说，操作集合元素的时机被推迟到了遍历时，没有买卖就没有杀害！（什么鬼……）</p>
<p>终于集齐全部碎片，把拼图完成了！Guava 为了实现这个代理模式和延迟求值可谓煞费苦心，嵌套了一层又一层的。可见把代码写到及格也许只要几分钟，写到接近满分可就没那么容易了。</p>
<p>原文地址 : http://blog.jamespan.me/2015/06/13/guava-functional-programing-3/</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>早先学习 Scheme 的时候，就已经对 Lisp 那行云流水般的表处理手段一见倾心。后来使用 Python 做数据处理时，语言内置的高阶函数更是得心应手。工作之后开始使用 Java，一开始的时候仿佛回到了石器时代。</p>
<p>直到后来我找到了 Guava，才终于又可以使用熟悉的方式去操纵集合。</p>]]>
    
    </summary>
    
      <category term="java" scheme="http://molloc.me/tags/java/"/>
    
      <category term="工作相关" scheme="http://molloc.me/categories/%E5%B7%A5%E4%BD%9C%E7%9B%B8%E5%85%B3/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[pmp高效笔记]]></title>
    <link href="http://molloc.me/2015/06/15/pmp%E9%AB%98%E6%95%88%E7%AC%94%E8%AE%B0/"/>
    <id>http://molloc.me/2015/06/15/pmp高效笔记/</id>
    <published>2015-06-15T09:10:20.000Z</published>
    <updated>2015-06-28T07:42:35.000Z</updated>
    <content type="html"><![CDATA[<h2 id="组织相关"><a class="header-anchor" href="#组织相关"></a>组织相关</h2>
<p>组织就是将两个或两个以上的个体联系起来,以实现一个或一系列共同目标;组织整体价值需要商业价值去体现,商业价值需要战略计划指导和管理,而战略计划目标本身却通过组织治理来管理,并通过项目(项目治理)和运营实现组织战略目标.</p>
<a id="more"></a>
<h2 id="收尾相关"><a class="header-anchor" href="#收尾相关"></a>收尾相关</h2>
<p>通常把项目或阶段收尾时组织过程资产的总结和更新叫做行政收尾(有时又称管理收尾),包括项目档案,项目或阶段收尾文件,历史信息和经验总结等.而合同收尾是指通过采购审计结束合同工作,将有关资料进行收集归档.区别和联系如下.</p>
<ol>
<li>行政收尾针对的是项目或项目阶段的,不仅整个项目完成需要行政收尾,而且每个阶段也需要行政收尾.合同收尾是针对每一份合同,每份合同只发生一次,合同收尾可在典型项目生命周期中任何一个阶段出现.</li>
<li>合同收尾也包括行政收尾,可理解为合同的行政收尾.</li>
<li>对整个项目,一般合同收尾在前,行政收尾在后,两者可同时进行.</li>
<li>合同收尾使用的是&quot;采购审计&quot;,而行政收尾使用的是&quot;经验教训&quot;.</li>
<li>合同收尾一般由卖方授权的采购管理员(可能是项目经理或其他人)向卖方签发的书面确认;而行政收尾一般是由发起人或高级管理层对项目经理签发的书面确认.</li>
<li>行政收尾是不是在整个项目结束时才进行?不是,在项目结束时,项目提前终止时和项目每个生命周期阶段.</li>
</ol>
<h2 id="成本术语类别解析"><a class="header-anchor" href="#成本术语类别解析"></a>成本术语类别解析</h2>
<ul>
<li>直接成本  可以从项目上直接找出出处    eg: 原材料,技术人员工资,外包</li>
<li>间接成本  无法直接追溯至某个具体项目的成本.    eg: 税金,保安费用,管理费用</li>
<li>固定成本  不会随着产品生成数量而变化.  eg: 设备费,场地租赁</li>
<li>可变成本  随着生产产品的数量增加而变化. eg: 原材料,人员工资</li>
<li>计划成本  因为选择一个机会而放弃的另一个机会可以获得的利益</li>
<li>沉没成本  以前花出去的费用,在确定是否继续做项目时不需要考虑.  eg: 项目开始前的可行性分析</li>
</ul>
<h2 id="挣值管理相关"><a class="header-anchor" href="#挣值管理相关"></a>挣值管理相关</h2>
<ul>
<li>SV和SPI最好把进度偏差与关键路径法(CPM)和风险管理一起使用.</li>
<li>由于SPI测量的是项目总工作量, 所有还需要对关键路径上的绩效进行单独分析,以确认项目是否将比计划完成日期提早或延迟完工.</li>
<li>把SV,CV(绝对值)转化成效率指标(相对值)SPI,CPI,以便吧项目的成本和进度绩效与任何其他项目做比较.</li>
<li>CPI是EVM最重要的指标.</li>
<li>EVM综合考虑项目范围,成本与进度指标.</li>
<li>$EV = BAC$,标识完工.</li>
<li>除非成本基准线发生了变化,BAC在整个项目执行期间保持不变.</li>
<li>关键链法关注缓冲时间偏差,关键路径法CPM关注总浮动时间偏差.</li>
</ul>
<h2 id="质量管理相关"><a class="header-anchor" href="#质量管理相关"></a>质量管理相关</h2>
<ul>
<li>质量成本.是一致性和非一致性工作的总成本.</li>
<li>过程分析的目的就是识别增值活动,过程分析的步骤能从简单情景题判断什么是增值活动,什么是必要的非增值活动,什么是浪费.</li>
<li>实施质量保证在执行过程组.</li>
<li>注意区分持续过程改进与过程分析的区别,过程分析偏重于识别所需的改进,是发现不是消除.</li>
<li>审计中的&quot;质量,风险,采购审计&quot;分别位于执行,监控,收尾过程组,都会形成经验教训.</li>
<li>注意区分鱼骨图找出的根本原因没有应对措施(区别于根本原因分析)</li>
<li>帕累托图-特殊的垂直 条形图,识别造成大多数问题的少数重要原因.</li>
<li>直方图-特殊形状的条形图,描述集中趋势,分散程度和统计分布形状.横轴是缺陷的类型(显示特定情况的发生次数或频率)</li>
</ul>
<h2 id="控制图的延伸理解"><a class="header-anchor" href="#控制图的延伸理解"></a>控制图的延伸理解</h2>
<ul>
<li>两种界限分别是控制线和规格线,中间部分的线可称为均值中心线.控制线的位置有项目管理团队确定,基本是均值±3δ的位置.</li>
<li>过程失控的判断方法
<ul>
<li>如一点落在控制线与规格线之间.</li>
<li>7点原则1: 连续7个点落在均值上方或下方是(当在控制线内)</li>
<li>7点原则2: 连续7个点呈连续上升或下降趋势时(但在上下控制线内)</li>
<li>7点原则3: 连续7个点相等(但在控制线内)</li>
</ul>
</li>
<li>超过规格线: 如此批产品属于量产并需交付给客户时需停线处理.如此批产品内部研发用,不需要停线.</li>
<li>帕累托图20/80原则,相对少量的原因通常是造成大多数的问题或缺陷.</li>
</ul>
<h2 id="项目人力资源管理"><a class="header-anchor" href="#项目人力资源管理"></a>项目人力资源管理</h2>
<ul>
<li>资源日历-资源直方图中柱形超过该水平线,就表明需要采用资源平衡策略.</li>
<li>妥协和包容都有各让一步的特征,区别是包容让步是差异点,寻求交集和共同利益;而妥协让步目的是寻求临时性解决方案.这个方案是寻找双方都在一定程度上满意的方案.</li>
<li>团队绩效评价通过团队有效性指标去衡量是否是高效团队.</li>
<li>项目绩效评估通过团队成员表现和项目绩效的对比,确定是否需要澄清角色与职责,向团队成员提供建设性的反馈,发现未知或未决问题,制订个人培训计划,以及确立未来各时期的具体目标.</li>
<li>冲突的来源: 资源是冲突最大的来源,个性是最次要的来源</li>
</ul>
<h2 id="项目沟通管理"><a class="header-anchor" href="#项目沟通管理"></a>项目沟通管理</h2>
<ul>
<li>绩效报告的内容,尤其注意一条&quot;本期<strong>批准的</strong>的变更的汇总&quot;</li>
</ul>
<h2 id="项目风险管理"><a class="header-anchor" href="#项目风险管理"></a>项目风险管理</h2>
<ul>
<li>起因,条件和事件和对应&quot;无风不起浪&quot;的&quot;水,风和浪&quot;,起因是源头,条件是环境,而事件是后果.</li>
<li>风险四要素
<ul>
<li>风险起因(起因和条件)</li>
<li>风险的事件</li>
<li>风险的概率</li>
<li>风险后果</li>
</ul>
</li>
<li>风险管理计划不会针对具体风险有具体应对措施,具体风险应对信息归属风险登记册管理.</li>
<li>概率影响矩阵是过程定性分析风险非常重要的工具,是提供风险排序的依据和标准.</li>
<li>所有识别的风险需要进行定性风险,但不是所有的风险都需要进行定量风险分析.</li>
<li>反复模拟通常采用蒙特卡洛技术,对于成本风险分析,需要使用成本估算进行模拟.对于进度风险分析,需要使用进度网络图和持续时间估算进行模拟.</li>
<li>次生风险,弹回计划,残余风险都是在采取应对措施后而产生的不同现象.</li>
<li>应急计划,应急储备和应急应对策略都可能需要指定触发条件.</li>
<li>应急计划针对所有已知的未知的风险,而应急应对策略针对某些特定事件.</li>
<li>实施应急计划或权变措施可能导致变更请求.</li>
<li>风险评估属于定性风险分析工具,而风险<strong>再</strong>评估属于监控风险的工具.</li>
<li>风险再评估偏重在风险本身的分析,而风险审计偏重在风险应对措施的有效性.</li>
<li>实施应急计划步骤为: 更新风险登记册(不再是<strong>风险</strong>, 而是<strong>问题</strong>) - 启动变更并通过整体变更控制 - 执行.</li>
<li>权变措施允许立即执行,在归档记录信息.</li>
</ul>
<h2 id="常见的风险术语"><a class="header-anchor" href="#常见的风险术语"></a>常见的风险术语</h2>
<ul>
<li>应对措施
<ul>
<li>概念: 已知风险(已知-已知)是指已经识别并分析过的风险,从而可对这些风险规划应对措施.</li>
<li>备注: 应对<strong>已知-已知</strong>风险.</li>
</ul>
</li>
<li>应急计划
<ul>
<li>概念: 具体的未知风险(已知-未知),无法主动进行管理,项目团队应该为未知风险创建应急计划.可能需要制订应急计划的触发器</li>
<li>备注; 应对<strong>已知-未知</strong>风险.</li>
</ul>
</li>
<li>应急应对策略
<ul>
<li>概念: 可以针对某些特定事件,专门设计一些应对措施.只在某些预定条件发生时才能实施的应对计划,如果确信风险的发生会有充分的预警信号,就应该制定应急应对策略.如未实现阶段性里程碑,或获得供应商更高度的重视.</li>
<li>备注: 针对某些特定事件,充分的预警信号,属应急计划</li>
</ul>
</li>
<li>权变措施
<ul>
<li>概念: 对已经发生的不利风险的应对,与应急计划不同的是,权变措施在风险发生之前并未事先安排.未经事先计划的应对措施.</li>
<li>备注: 应对<strong>未知-未知</strong>风险,消极地接受不利风险的发生.</li>
</ul>
</li>
<li>次生风险
<ul>
<li>概念: 由于实施某风险应对措施而直接产生的风险.</li>
</ul>
</li>
<li>弹回计划
<ul>
<li>概念: 在所选策略无效或发生已接受的风险时加以实施.</li>
</ul>
</li>
<li>残余风险
<ul>
<li>采取预定应对措施之后仍然存在的风险.</li>
</ul>
</li>
</ul>
<h2 id="敏感性分析与实验设计"><a class="header-anchor" href="#敏感性分析与实验设计"></a>敏感性分析与实验设计</h2>
<ul>
<li>敏感性分析
<ul>
<li>过程: 定量风险分析</li>
<li>特性: 每次只改变一个因素</li>
<li>作用: 有助于确定那些风险对项目具有最大的潜在影响</li>
</ul>
</li>
<li>实验设计
<ul>
<li>过程: 质量规划</li>
<li>特性: 系统地改变所有重要因素</li>
<li>作用: 一种统计方法,用来识别那些因素会对正在开发的流程或正在生产的产品的特定变量产生影响.</li>
</ul>
</li>
</ul>
<h2 id="假设分析与假设情景分析"><a class="header-anchor" href="#假设分析与假设情景分析"></a>假设分析与假设情景分析</h2>
<ul>
<li>假设分析
<ul>
<li>假设分析是检验假设条件在项目中的有效性,并识别因其中的错误,变化,矛盾或片面性所致的项目风险.</li>
<li>因(强调的是X)</li>
<li>强调的是本身的这个&quot;假设&quot;质量如何,有效性如何?</li>
<li>识别风险工具与技术</li>
</ul>
</li>
</ul>
<ul>
<li>假设情景分析
<ul>
<li>用于考察各种情况,&quot;如果X出现了,情况Y会怎样?&quot;这样的问题进行分析</li>
<li>果(强调的是Y)</li>
<li>强调的是假设情景模拟下产生的结果</li>
<li>制定进度计划和进度控制的工具与技术</li>
</ul>
</li>
</ul>
<h2 id="项目采购管理"><a class="header-anchor" href="#项目采购管理"></a>项目采购管理</h2>
<ul>
<li>采购文件中应该包括采购工作说明书(SOW)以及所需的合同条款.</li>
<li>工料合同的情景如增加人员,聘请专家以及寻求其他外部支持,使用短平快的项目,在不能很快编写出准确工作说明书的情况下使用.</li>
<li>采购谈判是指在合同签署之前,对合同的结构,要求以及其他条款加以澄清,以取得一致意见.</li>
<li>索赔各情景题中,例如卖方城市罢工属于&quot;可原谅延误中的不可补偿延误&quot;.</li>
<li>采购审计是指对从规划采购管理过程到控制采购过程的所有采购过程进行结构化审查.其目的是找出合同准备或管理方面的成功经验或失败教训,供本项目其他采购合同或执行组织的采购合同借鉴.</li>
</ul>
<h2 id="判断选择那类合同"><a class="header-anchor" href="#判断选择那类合同"></a>判断选择那类合同</h2>
<ul>
<li>范围明确不明确,明确是总价,不明确通常是成本补偿或T&amp;M.</li>
<li>范围不清,风险高,复杂度高,需要最高灵活性就选成本补偿合同.</li>
<li>不能快速编写SOW的情况下,采用T&amp;M.</li>
<li>题干有无时间衡量,如果有时间,基本是T&amp;M,只有T&amp;M考核时间.</li>
<li>需不需要增加人手,聘请专家及寻求外部支持,选T&amp;M.</li>
<li>角色是买方还是卖方,选择风险对角色相对小的,如果是买方,总价合同,如果是卖方成本补偿.</li>
</ul>
<h2 id="干系人分类"><a class="header-anchor" href="#干系人分类"></a>干系人分类</h2>
<ol>
<li>权利/影响方格,根据干系人的职权(权利)大小以及主动参与(影响)项目的程度进行分组.</li>
<li>影响/作用方格,根据干系人的参与(影响)项目的程度以及改变项目计划或执行能力(作用)进行分组.</li>
<li>凸显模型,根据干系人的权利(施加自己意愿的能力),紧急程度(需要立即关注)和合法性(有权参与)对干系人进行分类.</li>
<li>权利/利益方格,根据干系人的职权(权利)大小以及对项目结果的关注程度(利益)进行分组.
<ul>
<li>权力大利益大 - 重点关注</li>
<li>权利大利益小 - 令其满意</li>
<li>权利小利益大 - 随时告知项目信息</li>
<li>权利小利益小 - 监督</li>
</ul>
</li>
</ol>
<h2 id="谈判测量解析"><a class="header-anchor" href="#谈判测量解析"></a>谈判测量解析</h2>
<ul>
<li>黑脸白脸 - eg: 一个充当和事老或好人,通常是管理层,一个充当挑刺或坏人,通常是执行者.</li>
<li>最后期限(Deadline) - eg: 如在2014年10月21日一定要达成共识</li>
<li>惊讶 - eg: 用夸张的姿态语言或语调表达</li>
<li>关键任务缺席 - eg: 此条款需要高层X现场拍板,但昨天临时紧急事件出国.</li>
<li>权利有效(Limited authority) - eg: 不好意思,我的权利只能同意单价2元/件, 超过此单价,我需上报.</li>
<li>拖延(Delay)</li>
<li>过分的要求</li>
<li>撤退(Withdrawal)</li>
<li>既成事实(Fait accompli)</li>
<li>攻击(Attacks)</li>
</ul>
<h2 id="采购绩效审查-检查与审计"><a class="header-anchor" href="#采购绩效审查-检查与审计"></a>采购绩效审查, 检查与审计</h2>
<ul>
<li>采购绩效审查
<ul>
<li>目的: 以便买方能够量化评价卖方在履行工作时所表现出来的能力或无能.</li>
<li>目标:
<ul>
<li>发现履约情况的好坏.</li>
<li>相对于SOW的进展情况.</li>
<li>为遵循合同的情况</li>
</ul>
</li>
<li>对象: 在规定的成本和进度内完成项目范围和达到质量要求的情况</li>
<li>场景:
<ul>
<li>买方开展的检查</li>
<li>对卖方所编相关文件的审查.</li>
<li>在卖方实施工作期间进行的质量审计.</li>
</ul>
</li>
</ul>
</li>
<li>检查与审计
<ul>
<li>目的: 验证卖方的工作过程对合同的遵守程度</li>
<li>目标:
<ul>
<li>以验证卖方的工作过程对合同的遵守程度</li>
<li>以验证卖方所完成的可交付成果对合同的遵守程度</li>
</ul>
</li>
<li>对象: 对合同的遵守程度</li>
<li>场景: 有没有按合同规定的某个<strong>特殊工艺</strong>进行加工.</li>
</ul>
</li>
</ul>
<h2 id="项目经理权利解析"><a class="header-anchor" href="#项目经理权利解析"></a>项目经理权利解析</h2>
<ul>
<li>专家权利 - 由个人技术,管理专业知识和经验带来的影响力,具备此种能力的项目经理会拥有较高的声望.</li>
<li>奖励权利 - 使用激励手段引导团队成员做事情</li>
<li>正式权利 - 基于职位所拥有的权利,项目经理应将此权利与奖励权利和专家权利结合使用,以获得最佳效果.</li>
<li>参考权利 - 由个人魅力,与权威人物关系及潜在影响力带来的权利</li>
<li>惩罚权利 - 使用强迫,威胁手段驱使团队成员做事情,否则予以惩罚,项目经理应尽量避免使用此权利,</li>
</ul>
<h2 id="常见的激励理论"><a class="header-anchor" href="#常见的激励理论"></a>常见的激励理论</h2>
<ul>
<li>马斯洛(Maslow)需求层次理论(五个层级从低到高)
<ol>
<li>生理需求: 吃饭,穿衣,住宅</li>
<li>安全需求: 劳动安全,职业安全,生活稳当,医疗,希望免于灾难</li>
<li>社交需求: 得到家庭,团队,朋友,同事的关怀爱护理解</li>
<li>尊重需要: 自我尊重,自我评价以及尊重比人</li>
<li>自我实现: 充分地,全神贯注地体验生活</li>
</ol>
</li>
<li>弗鲁姆期望理论
<ul>
<li>$E(期望值) = P(期望概率) * V(目标价值)$</li>
</ul>
</li>
<li>麦克利兰成就理论
<ul>
<li>成就需要(Need for achievement): 争取成功希望做的最好的需要</li>
<li>权利需要(Need for power): 影响或控制他人且不受他人控制的需要.</li>
<li>亲和需要(Need for affiliation): 建立友好亲密的人际关系的需要.</li>
</ul>
</li>
</ul>
<h2 id="其他几个理论"><a class="header-anchor" href="#其他几个理论"></a>其他几个理论</h2>
<ul>
<li>光环效应(Halo Effect)
<ul>
<li>个人在社会知觉中将知觉过程对象的某种总体印象不加分析地扩大到其他具体方面去的现象.</li>
</ul>
</li>
<li>号角效应(Horns Effect)
<ul>
<li>员工在某方面表现不好,就认定他在其他方面也表现不佳.</li>
</ul>
</li>
</ul>
<h2 id="项目绩效评估-团队绩效评价"><a class="header-anchor" href="#项目绩效评估-团队绩效评价"></a>项目绩效评估,团队绩效评价</h2>
<ul>
<li>项目绩效评估
<ul>
<li>过程: 管理项目团队的工具与技术</li>
<li>对象: 偏重个人绩效</li>
<li>目的:
<ol>
<li>澄清角色与职责,向团队成员提供建设性反馈</li>
<li>发现未知或未决问题</li>
<li>制订个人培训计划,以及确立未来各时期的具体目标</li>
</ol>
</li>
<li>方法: 通过项目绩效和团队成员的表现比较</li>
<li>评估: 通过阶段末评审,监控过程组持续并有规律地观察和测量项目绩效</li>
</ul>
</li>
<li>团队绩效评价
<ul>
<li>过程:
<ol>
<li>管理项目团队的输入</li>
<li>建设项目团队的输出</li>
</ol>
</li>
<li>对象: 偏重团队绩效</li>
<li>目的: 对项目团队建设的有效性进行正式或非正式评价,打造高效团队.</li>
<li>方法: 通过有效的团队建设策略和活动</li>
<li>评估:
<ol>
<li>项目目标(范围,时间,成本,质量)达成.</li>
<li>评价团队有效性四个指标</li>
</ol>
</li>
</ul>
</li>
</ul>
<h2 id="五大冲突处理策略"><a class="header-anchor" href="#五大冲突处理策略"></a>五大冲突处理策略</h2>
<ol>
<li>合作/解决问题(Collaborating/Problem Solve)
<ul>
<li>概念: 综合考虑不同的观点,引导各方达成共识和承若</li>
<li>案例:
<ol>
<li>面对永久解决问题方案</li>
<li>引导达成一致心服口服</li>
</ol>
</li>
</ul>
</li>
<li>妥协/调节(Compromise/Reconcile)
<ul>
<li>概念: 为了暂时或部分解决,寻找一定程度满意方案</li>
<li>案例:
<ol>
<li>各让一步或交换条件</li>
<li>临时性解决方案</li>
</ol>
</li>
</ul>
</li>
<li>缓和/包容
<ul>
<li>概念: 强调一致,弱化分歧,为维持和谐管理而退让一步.</li>
<li>案例: 各让一步以求同存异</li>
</ul>
</li>
<li>撤退/回避
<ul>
<li>概念: 一方或双方从冲突中退出,将问题推迟到准备充分的时候或推给其他人解决.</li>
<li>案例: 惹不起躲得起</li>
</ul>
</li>
<li>强迫/命令(Force/Direct)
<ul>
<li>牺牲其他人,推行某一方观点</li>
<li>案例: 是输-赢</li>
</ul>
</li>
</ol>
<h2 id="常见的质量术语"><a class="header-anchor" href="#常见的质量术语"></a>常见的质量术语</h2>
<ul>
<li>预防(Prevention)
<ul>
<li>概念: 保证过程中不出现异常.</li>
<li>案例: IPQC(制程控制)检验等.</li>
</ul>
</li>
<li>检查(Inspection)
<ul>
<li>概念: 保证错误不落到客户手里.</li>
<li>案例: OQC(成品出厂检验)的检验等.</li>
</ul>
</li>
<li>属性抽样(Attribute Sampling)
<ul>
<li>概念: 结果合格或不合格</li>
<li>案例: PMP考试</li>
</ul>
</li>
<li>变量抽样(Varables)
<ul>
<li>概念: 在连续的量表上标明结果所处的位置,以此表明分布程度</li>
<li>案例: 一个班级80分以上多少人,没有所谓的合格不合格</li>
</ul>
</li>
<li>公差(Tolerances)
<ul>
<li>概念:
<ol>
<li>结果的可接受范围</li>
<li>规格界限为临界值</li>
</ol>
</li>
<li>案例: 桌子长度[0.95 ~ 1.05]米区间</li>
</ul>
</li>
<li>规格界限(Specification LImits)
<ul>
<li>概念: 客户对产品或服务的要求</li>
<li>案例: 质量问题,通常返工</li>
</ul>
</li>
<li>控制界限(Control limits)
<ul>
<li>概念: 显示过程是否失控的临界值</li>
<li>案例: 比规格界限严格,团队严格要求</li>
</ul>
</li>
</ul>
<h2 id="质量管理大师理念"><a class="header-anchor" href="#质量管理大师理念"></a>质量管理大师理念</h2>
<ul>
<li>戴明(Deming)
<ol>
<li>戴明环(PDCA环-plan,do,check,action)</li>
<li>持续改进,预防胜于检查.</li>
<li>85%的质量问题由管理层负责,15%当事人负责.</li>
</ol>
</li>
<li>石川磬(Koaru Ishikawa)
<ol>
<li>鱼骨图(石川图). #从根本问题找原因,不包括应对措施.注意区别根本原因分析工具.</li>
</ol>
</li>
<li>朱兰(Juran)
<ol>
<li>强调质量是&quot;适合使用&quot;(fitness for use).</li>
<li>质量与等级的区别与联系.</li>
<li>质量三部曲: 质量计划, 质量控制, 质量改进.</li>
<li>最早把&quot;帕累托&quot;引入质量管理.</li>
</ol>
</li>
</ul>
<h2 id="考试相关"><a class="header-anchor" href="#考试相关"></a>考试相关</h2>
<ul>
<li>注意找题干,看清楚问什么</li>
<li>ROI = 年利润 / 投资额</li>
<li>风险 = 概率 * 进度影响度</li>
<li>SIPOC Supplier-供应者,Input-输入,Process-流程,Output-输出,Customer-客户</li>
<li>属性抽样(结果为合格不合适)</li>
<li>变量抽样(在连续的量表上标明结果所处的位置,表明合格的程度)</li>
<li>识别干系人归属于启动过程组</li>
<li>提前量为负,滞后量为正</li>
<li>预测型生命周期(计划驱动),适应型生命周期(变更驱动)</li>
<li>在FPIF(总价加激励费用合同),合同总价 = 实际成本 + 目标利润 + (目标成本 - 实际成本) * 卖方分享比例.</li>
<li>项目经理的重要职责之一就是管理干系人的期望</li>
<li>项目经理的另一项职责就是平衡干系人的不同利益</li>
<li>项目治理是一种符合组织治理模式的项目监管职能,覆盖整个项目生命周期</li>
<li>项目治理由项目组合,项目集或发起组织来定义,并要与之相适应,但要与组织治理分开</li>
<li>SOW需涉及业务需要,产品范围描述,战略计划</li>
<li>商业论证通常要包含业务需求和成本效率分析</li>
<li>在结束和项目阶段获得客户或发起人的最终验收(形式上),对可交付成果的实质性验收是在项目监控过程组中确认范围过程完成.</li>
<li>引导式研讨会有利于形成一致意见,而德尔菲是旨在取得一致意见.</li>
<li>引导式研讨会的几个代表技术(JAD,QFD,用户故事)</li>
<li>产品分析需要重点掌握子技术(价值分析).公式: $V(价值) = F(Function功能)/C(Cost成本)$.</li>
<li>备选方案生成(横向思维:是指通过不合理逻辑方式寻求解决问题方法,摆脱已有知识和旧的经验约束,代表最好和最坏的过程)</li>
<li>用极端革新的方式就属于横向思维.eg: 乔布斯革新性的移除了iPod按键等.</li>
<li>赶工费率 = 每个可赶工关键活动的成本和时间区间的比值.</li>
<li>项目进度计划图形方式常见于(横道图,里程碑,项目进度网络图).</li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="组织相关"><a class="header-anchor" href="#组织相关"></a>组织相关</h2>
<p>组织就是将两个或两个以上的个体联系起来,以实现一个或一系列共同目标;组织整体价值需要商业价值去体现,商业价值需要战略计划指导和管理,而战略计划目标本身却通过组织治理来管理,并通过项目(项目治理)和运营实现组织战略目标.</p>]]>
    
    </summary>
    
      <category term="pmp" scheme="http://molloc.me/tags/pmp/"/>
    
      <category term="学习笔记" scheme="http://molloc.me/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>